<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>plugin | web</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/logo.jpg">
    <meta name="description" content="welcome">
    
    <link rel="preload" href="/assets/css/0.styles.8ee7aa31.css" as="style"><link rel="preload" href="/assets/js/app.723af4b8.js" as="script"><link rel="preload" href="/assets/js/2.1a953b48.js" as="script"><link rel="preload" href="/assets/js/384.b3c735f9.js" as="script"><link rel="preload" href="/assets/js/10.174ca6d2.js" as="script"><link rel="prefetch" href="/assets/js/100.44c5de48.js"><link rel="prefetch" href="/assets/js/101.25b5303b.js"><link rel="prefetch" href="/assets/js/102.ec5c2990.js"><link rel="prefetch" href="/assets/js/103.24c3667f.js"><link rel="prefetch" href="/assets/js/104.534cd464.js"><link rel="prefetch" href="/assets/js/105.f3e28ee5.js"><link rel="prefetch" href="/assets/js/106.a51cc69e.js"><link rel="prefetch" href="/assets/js/107.1f1aecb1.js"><link rel="prefetch" href="/assets/js/108.98f59831.js"><link rel="prefetch" href="/assets/js/109.7dc23bc6.js"><link rel="prefetch" href="/assets/js/11.572c9dff.js"><link rel="prefetch" href="/assets/js/110.c706ab89.js"><link rel="prefetch" href="/assets/js/111.4a1432ba.js"><link rel="prefetch" href="/assets/js/112.939c31ab.js"><link rel="prefetch" href="/assets/js/113.90d44e96.js"><link rel="prefetch" href="/assets/js/114.e5c3521f.js"><link rel="prefetch" href="/assets/js/115.63d299d7.js"><link rel="prefetch" href="/assets/js/116.520954f9.js"><link rel="prefetch" href="/assets/js/117.415aaf2d.js"><link rel="prefetch" href="/assets/js/118.e087cb94.js"><link rel="prefetch" href="/assets/js/119.ce95d5ee.js"><link rel="prefetch" href="/assets/js/12.5d2b7202.js"><link rel="prefetch" href="/assets/js/120.920a298d.js"><link rel="prefetch" href="/assets/js/121.64d85adb.js"><link rel="prefetch" href="/assets/js/122.05baa0ac.js"><link rel="prefetch" href="/assets/js/123.f89f3624.js"><link rel="prefetch" href="/assets/js/124.631d5196.js"><link rel="prefetch" href="/assets/js/125.8d54b41c.js"><link rel="prefetch" href="/assets/js/126.0e3ba958.js"><link rel="prefetch" href="/assets/js/127.975ea276.js"><link rel="prefetch" href="/assets/js/128.618446a2.js"><link rel="prefetch" href="/assets/js/129.ea7fb480.js"><link rel="prefetch" href="/assets/js/13.980612a9.js"><link rel="prefetch" href="/assets/js/130.f6073d4b.js"><link rel="prefetch" href="/assets/js/131.e317c602.js"><link rel="prefetch" href="/assets/js/132.b445e2cc.js"><link rel="prefetch" href="/assets/js/133.6d29499e.js"><link rel="prefetch" href="/assets/js/134.75382d92.js"><link rel="prefetch" href="/assets/js/135.b25c62fc.js"><link rel="prefetch" href="/assets/js/136.60b716a3.js"><link rel="prefetch" href="/assets/js/137.5f96043f.js"><link rel="prefetch" href="/assets/js/138.52aa59f9.js"><link rel="prefetch" href="/assets/js/139.d3282c9a.js"><link rel="prefetch" href="/assets/js/14.c561889f.js"><link rel="prefetch" href="/assets/js/140.d1c21594.js"><link rel="prefetch" href="/assets/js/141.5f35f512.js"><link rel="prefetch" href="/assets/js/142.01fd7eac.js"><link rel="prefetch" href="/assets/js/143.5f73fc7d.js"><link rel="prefetch" href="/assets/js/144.4fabc128.js"><link rel="prefetch" href="/assets/js/145.4c2e5b28.js"><link rel="prefetch" href="/assets/js/146.7ba4367c.js"><link rel="prefetch" href="/assets/js/147.39e2cdce.js"><link rel="prefetch" href="/assets/js/148.a9cbda46.js"><link rel="prefetch" href="/assets/js/149.6a5b3707.js"><link rel="prefetch" href="/assets/js/15.977544a1.js"><link rel="prefetch" href="/assets/js/150.2013929c.js"><link rel="prefetch" href="/assets/js/151.6321f692.js"><link rel="prefetch" href="/assets/js/152.af7ee793.js"><link rel="prefetch" href="/assets/js/153.7e55d908.js"><link rel="prefetch" href="/assets/js/154.5e71a6a8.js"><link rel="prefetch" href="/assets/js/155.789f418c.js"><link rel="prefetch" href="/assets/js/156.04740528.js"><link rel="prefetch" href="/assets/js/157.f655ed66.js"><link rel="prefetch" href="/assets/js/158.24285765.js"><link rel="prefetch" href="/assets/js/159.8983fd5c.js"><link rel="prefetch" href="/assets/js/16.23c8640b.js"><link rel="prefetch" href="/assets/js/160.efcdcb65.js"><link rel="prefetch" href="/assets/js/161.a20916c1.js"><link rel="prefetch" href="/assets/js/162.5abb0685.js"><link rel="prefetch" href="/assets/js/163.b1d92289.js"><link rel="prefetch" href="/assets/js/164.4a530493.js"><link rel="prefetch" href="/assets/js/165.9aafd7bd.js"><link rel="prefetch" href="/assets/js/166.dddf88b5.js"><link rel="prefetch" href="/assets/js/167.7b40496d.js"><link rel="prefetch" href="/assets/js/168.6626efc1.js"><link rel="prefetch" href="/assets/js/169.4e05c213.js"><link rel="prefetch" href="/assets/js/17.ac01d803.js"><link rel="prefetch" href="/assets/js/170.c8b46d13.js"><link rel="prefetch" href="/assets/js/171.bda5dc99.js"><link rel="prefetch" href="/assets/js/172.2d090345.js"><link rel="prefetch" href="/assets/js/173.ab6cafeb.js"><link rel="prefetch" href="/assets/js/174.da5f1ca5.js"><link rel="prefetch" href="/assets/js/175.3dd176f8.js"><link rel="prefetch" href="/assets/js/176.f53f9b9f.js"><link rel="prefetch" href="/assets/js/177.6871f027.js"><link rel="prefetch" href="/assets/js/178.d7bbf39d.js"><link rel="prefetch" href="/assets/js/179.32270ad7.js"><link rel="prefetch" href="/assets/js/18.ee4a73b3.js"><link rel="prefetch" href="/assets/js/180.902d79e5.js"><link rel="prefetch" href="/assets/js/181.57a42318.js"><link rel="prefetch" href="/assets/js/182.4a761b29.js"><link rel="prefetch" href="/assets/js/183.c68690ed.js"><link rel="prefetch" href="/assets/js/184.94b7c2a5.js"><link rel="prefetch" href="/assets/js/185.df1e37ce.js"><link rel="prefetch" href="/assets/js/186.0556feb3.js"><link rel="prefetch" href="/assets/js/187.b6401e8f.js"><link rel="prefetch" href="/assets/js/188.35fea9fe.js"><link rel="prefetch" href="/assets/js/189.e824b299.js"><link rel="prefetch" href="/assets/js/19.349b3d2f.js"><link rel="prefetch" href="/assets/js/190.dc56684a.js"><link rel="prefetch" href="/assets/js/191.c4be8bf5.js"><link rel="prefetch" href="/assets/js/192.de495931.js"><link rel="prefetch" href="/assets/js/193.55e233a0.js"><link rel="prefetch" href="/assets/js/194.dd3501dd.js"><link rel="prefetch" href="/assets/js/195.f869d9d1.js"><link rel="prefetch" href="/assets/js/196.1dec756b.js"><link rel="prefetch" href="/assets/js/197.b7013cec.js"><link rel="prefetch" href="/assets/js/198.f2037dc7.js"><link rel="prefetch" href="/assets/js/199.16f61477.js"><link rel="prefetch" href="/assets/js/20.c56c3f99.js"><link rel="prefetch" href="/assets/js/200.27cb97b6.js"><link rel="prefetch" href="/assets/js/201.5a138732.js"><link rel="prefetch" href="/assets/js/202.57789129.js"><link rel="prefetch" href="/assets/js/203.7cab272d.js"><link rel="prefetch" href="/assets/js/204.3a29cc32.js"><link rel="prefetch" href="/assets/js/205.3bd9b07d.js"><link rel="prefetch" href="/assets/js/206.39f41a4b.js"><link rel="prefetch" href="/assets/js/207.a59bd345.js"><link rel="prefetch" href="/assets/js/208.83426465.js"><link rel="prefetch" href="/assets/js/209.4648bf68.js"><link rel="prefetch" href="/assets/js/21.036f6efb.js"><link rel="prefetch" href="/assets/js/210.b4a18033.js"><link rel="prefetch" href="/assets/js/211.2f59dcf6.js"><link rel="prefetch" href="/assets/js/212.b99f42d8.js"><link rel="prefetch" href="/assets/js/213.60ec2e7b.js"><link rel="prefetch" href="/assets/js/214.338e82ed.js"><link rel="prefetch" href="/assets/js/215.5d4e34c0.js"><link rel="prefetch" href="/assets/js/216.11cb2ae3.js"><link rel="prefetch" href="/assets/js/217.811b797f.js"><link rel="prefetch" href="/assets/js/218.dee266ad.js"><link rel="prefetch" href="/assets/js/219.b5812024.js"><link rel="prefetch" href="/assets/js/22.30ea717c.js"><link rel="prefetch" href="/assets/js/220.a5c50331.js"><link rel="prefetch" href="/assets/js/221.bb9c094c.js"><link rel="prefetch" href="/assets/js/222.663d4833.js"><link rel="prefetch" href="/assets/js/223.f9fbe530.js"><link rel="prefetch" href="/assets/js/224.71c695e7.js"><link rel="prefetch" href="/assets/js/225.43a375d9.js"><link rel="prefetch" href="/assets/js/226.70e48c22.js"><link rel="prefetch" href="/assets/js/227.1e809b39.js"><link rel="prefetch" href="/assets/js/228.04248725.js"><link rel="prefetch" href="/assets/js/229.b34fb624.js"><link rel="prefetch" href="/assets/js/23.215d8d4b.js"><link rel="prefetch" href="/assets/js/230.537209a1.js"><link rel="prefetch" href="/assets/js/231.58928055.js"><link rel="prefetch" href="/assets/js/232.0f44746a.js"><link rel="prefetch" href="/assets/js/233.151f1407.js"><link rel="prefetch" href="/assets/js/234.6168f5f5.js"><link rel="prefetch" href="/assets/js/235.8cdd44b9.js"><link rel="prefetch" href="/assets/js/236.4347a7e3.js"><link rel="prefetch" href="/assets/js/237.64289124.js"><link rel="prefetch" href="/assets/js/238.dfbe3e0d.js"><link rel="prefetch" href="/assets/js/239.978a61ec.js"><link rel="prefetch" href="/assets/js/24.dff159f7.js"><link rel="prefetch" href="/assets/js/240.a9e82117.js"><link rel="prefetch" href="/assets/js/241.4127d88f.js"><link rel="prefetch" href="/assets/js/242.7a3b827a.js"><link rel="prefetch" href="/assets/js/243.7da48c3e.js"><link rel="prefetch" href="/assets/js/244.6af960f7.js"><link rel="prefetch" href="/assets/js/245.703567cb.js"><link rel="prefetch" href="/assets/js/246.6510a3b5.js"><link rel="prefetch" href="/assets/js/247.a19257c4.js"><link rel="prefetch" href="/assets/js/248.8e726c8c.js"><link rel="prefetch" href="/assets/js/249.7e88c5c6.js"><link rel="prefetch" href="/assets/js/25.09e99b33.js"><link rel="prefetch" href="/assets/js/250.247001f4.js"><link rel="prefetch" href="/assets/js/251.1d90b916.js"><link rel="prefetch" href="/assets/js/252.e4b5e40e.js"><link rel="prefetch" href="/assets/js/253.d06e9389.js"><link rel="prefetch" href="/assets/js/254.168491ef.js"><link rel="prefetch" href="/assets/js/255.c69d6454.js"><link rel="prefetch" href="/assets/js/256.934cbcf9.js"><link rel="prefetch" href="/assets/js/257.5970e168.js"><link rel="prefetch" href="/assets/js/258.5251417a.js"><link rel="prefetch" href="/assets/js/259.c8a9cd1b.js"><link rel="prefetch" href="/assets/js/26.f92284da.js"><link rel="prefetch" href="/assets/js/260.b4b87eec.js"><link rel="prefetch" href="/assets/js/261.d0675044.js"><link rel="prefetch" href="/assets/js/262.ae07077e.js"><link rel="prefetch" href="/assets/js/263.f6d945e6.js"><link rel="prefetch" href="/assets/js/264.4af93020.js"><link rel="prefetch" href="/assets/js/265.1b3a868d.js"><link rel="prefetch" href="/assets/js/266.3184b16a.js"><link rel="prefetch" href="/assets/js/267.02496da2.js"><link rel="prefetch" href="/assets/js/268.79544146.js"><link rel="prefetch" href="/assets/js/269.901e3781.js"><link rel="prefetch" href="/assets/js/27.d5f9f9ed.js"><link rel="prefetch" href="/assets/js/270.49323469.js"><link rel="prefetch" href="/assets/js/271.2d28d9d1.js"><link rel="prefetch" href="/assets/js/272.fbdea9a6.js"><link rel="prefetch" href="/assets/js/273.18d924c5.js"><link rel="prefetch" href="/assets/js/274.07a7c6d6.js"><link rel="prefetch" href="/assets/js/275.13cf2d2f.js"><link rel="prefetch" href="/assets/js/276.79bb770e.js"><link rel="prefetch" href="/assets/js/277.37b2b318.js"><link rel="prefetch" href="/assets/js/278.c999f1b2.js"><link rel="prefetch" href="/assets/js/279.d0280f7e.js"><link rel="prefetch" href="/assets/js/28.c4baf426.js"><link rel="prefetch" href="/assets/js/280.f401125e.js"><link rel="prefetch" href="/assets/js/281.b50f215b.js"><link rel="prefetch" href="/assets/js/282.49a56e42.js"><link rel="prefetch" href="/assets/js/283.b81e0800.js"><link rel="prefetch" href="/assets/js/284.f39f0dce.js"><link rel="prefetch" href="/assets/js/285.74aa05a6.js"><link rel="prefetch" href="/assets/js/286.f3e6a83a.js"><link rel="prefetch" href="/assets/js/287.6e9e1868.js"><link rel="prefetch" href="/assets/js/288.333fd2a2.js"><link rel="prefetch" href="/assets/js/289.bfe91319.js"><link rel="prefetch" href="/assets/js/29.f74a6e32.js"><link rel="prefetch" href="/assets/js/290.53f1a8d3.js"><link rel="prefetch" href="/assets/js/291.cddad13d.js"><link rel="prefetch" href="/assets/js/292.2c78986e.js"><link rel="prefetch" href="/assets/js/293.448d48bc.js"><link rel="prefetch" href="/assets/js/294.79b29b77.js"><link rel="prefetch" href="/assets/js/295.383accee.js"><link rel="prefetch" href="/assets/js/296.a8055b81.js"><link rel="prefetch" href="/assets/js/297.21d82960.js"><link rel="prefetch" href="/assets/js/298.32e54f39.js"><link rel="prefetch" href="/assets/js/299.133a7812.js"><link rel="prefetch" href="/assets/js/3.dc6e325d.js"><link rel="prefetch" href="/assets/js/30.43bca04a.js"><link rel="prefetch" href="/assets/js/300.6cb3ab94.js"><link rel="prefetch" href="/assets/js/301.611e60b2.js"><link rel="prefetch" href="/assets/js/302.76fd9507.js"><link rel="prefetch" href="/assets/js/303.f8e1b214.js"><link rel="prefetch" href="/assets/js/304.e24739bb.js"><link rel="prefetch" href="/assets/js/305.9948c317.js"><link rel="prefetch" href="/assets/js/306.a40109a0.js"><link rel="prefetch" href="/assets/js/307.6a0a4d0e.js"><link rel="prefetch" href="/assets/js/308.d764d252.js"><link rel="prefetch" href="/assets/js/309.fd98df26.js"><link rel="prefetch" href="/assets/js/31.878c6154.js"><link rel="prefetch" href="/assets/js/310.349d75c5.js"><link rel="prefetch" href="/assets/js/311.60835540.js"><link rel="prefetch" href="/assets/js/312.b68ba3bb.js"><link rel="prefetch" href="/assets/js/313.4ed6cb4c.js"><link rel="prefetch" href="/assets/js/314.43d2a6f3.js"><link rel="prefetch" href="/assets/js/315.990a49c5.js"><link rel="prefetch" href="/assets/js/316.f05f135c.js"><link rel="prefetch" href="/assets/js/317.f19d1ea4.js"><link rel="prefetch" href="/assets/js/318.f0d72a0c.js"><link rel="prefetch" href="/assets/js/319.d60d3aa7.js"><link rel="prefetch" href="/assets/js/32.e139d46f.js"><link rel="prefetch" href="/assets/js/320.c0ae74ba.js"><link rel="prefetch" href="/assets/js/321.379641a6.js"><link rel="prefetch" href="/assets/js/322.0bc63bd3.js"><link rel="prefetch" href="/assets/js/323.ace44fca.js"><link rel="prefetch" href="/assets/js/324.9cb1aabe.js"><link rel="prefetch" href="/assets/js/325.dd145b77.js"><link rel="prefetch" href="/assets/js/326.913c0b4e.js"><link rel="prefetch" href="/assets/js/327.6889f9ac.js"><link rel="prefetch" href="/assets/js/328.d54d5d3f.js"><link rel="prefetch" href="/assets/js/329.17aa991f.js"><link rel="prefetch" href="/assets/js/33.03cfda3d.js"><link rel="prefetch" href="/assets/js/330.745b7b85.js"><link rel="prefetch" href="/assets/js/331.de1a7233.js"><link rel="prefetch" href="/assets/js/332.5851baf9.js"><link rel="prefetch" href="/assets/js/333.a8943068.js"><link rel="prefetch" href="/assets/js/334.31164f46.js"><link rel="prefetch" href="/assets/js/335.61c54178.js"><link rel="prefetch" href="/assets/js/336.be60dc46.js"><link rel="prefetch" href="/assets/js/337.c05c9540.js"><link rel="prefetch" href="/assets/js/338.51a51596.js"><link rel="prefetch" href="/assets/js/339.02429d1e.js"><link rel="prefetch" href="/assets/js/34.5cd3b4ed.js"><link rel="prefetch" href="/assets/js/340.374669de.js"><link rel="prefetch" href="/assets/js/341.9805690b.js"><link rel="prefetch" href="/assets/js/342.80b79d1a.js"><link rel="prefetch" href="/assets/js/343.edfb327e.js"><link rel="prefetch" href="/assets/js/344.5c6b4fb6.js"><link rel="prefetch" href="/assets/js/345.a3d4c73b.js"><link rel="prefetch" href="/assets/js/346.6ca98d66.js"><link rel="prefetch" href="/assets/js/347.a92c53e5.js"><link rel="prefetch" href="/assets/js/348.bcd1ad56.js"><link rel="prefetch" href="/assets/js/349.1f3ce756.js"><link rel="prefetch" href="/assets/js/35.65f31b57.js"><link rel="prefetch" href="/assets/js/350.6b54869e.js"><link rel="prefetch" href="/assets/js/351.db454056.js"><link rel="prefetch" href="/assets/js/352.38d5d12e.js"><link rel="prefetch" href="/assets/js/353.66504a46.js"><link rel="prefetch" href="/assets/js/354.89145b4f.js"><link rel="prefetch" href="/assets/js/355.f8d337cf.js"><link rel="prefetch" href="/assets/js/356.7f01926f.js"><link rel="prefetch" href="/assets/js/357.bddb9f92.js"><link rel="prefetch" href="/assets/js/358.7d980530.js"><link rel="prefetch" href="/assets/js/359.74ed8d7b.js"><link rel="prefetch" href="/assets/js/36.2bca375f.js"><link rel="prefetch" href="/assets/js/360.31e3fe97.js"><link rel="prefetch" href="/assets/js/361.d4da85cf.js"><link rel="prefetch" href="/assets/js/362.df38f577.js"><link rel="prefetch" href="/assets/js/363.c7aacab0.js"><link rel="prefetch" href="/assets/js/364.357db0ec.js"><link rel="prefetch" href="/assets/js/365.e39dd4d6.js"><link rel="prefetch" href="/assets/js/366.be4d705b.js"><link rel="prefetch" href="/assets/js/367.5027f4e5.js"><link rel="prefetch" href="/assets/js/368.84f650ee.js"><link rel="prefetch" href="/assets/js/369.ca24a683.js"><link rel="prefetch" href="/assets/js/37.b190d4e3.js"><link rel="prefetch" href="/assets/js/370.d9d67062.js"><link rel="prefetch" href="/assets/js/371.e3696511.js"><link rel="prefetch" href="/assets/js/372.e2cc586b.js"><link rel="prefetch" href="/assets/js/373.2cd7aa59.js"><link rel="prefetch" href="/assets/js/374.78a425b9.js"><link rel="prefetch" href="/assets/js/375.4d054647.js"><link rel="prefetch" href="/assets/js/376.4446d436.js"><link rel="prefetch" href="/assets/js/377.0c255d7c.js"><link rel="prefetch" href="/assets/js/378.26bbaf21.js"><link rel="prefetch" href="/assets/js/379.3867e7e1.js"><link rel="prefetch" href="/assets/js/38.1bf99f7f.js"><link rel="prefetch" href="/assets/js/380.e40ca91a.js"><link rel="prefetch" href="/assets/js/381.6a8d77f0.js"><link rel="prefetch" href="/assets/js/382.bffc4238.js"><link rel="prefetch" href="/assets/js/383.4930b603.js"><link rel="prefetch" href="/assets/js/385.d294ce78.js"><link rel="prefetch" href="/assets/js/386.f4b75056.js"><link rel="prefetch" href="/assets/js/387.b14f8032.js"><link rel="prefetch" href="/assets/js/388.cfcdbcd3.js"><link rel="prefetch" href="/assets/js/389.50295d4b.js"><link rel="prefetch" href="/assets/js/39.52e6ed18.js"><link rel="prefetch" href="/assets/js/390.ce1d1860.js"><link rel="prefetch" href="/assets/js/391.24c1ed73.js"><link rel="prefetch" href="/assets/js/392.c03d5650.js"><link rel="prefetch" href="/assets/js/393.02cf475f.js"><link rel="prefetch" href="/assets/js/394.597d5c1c.js"><link rel="prefetch" href="/assets/js/395.e7e286e0.js"><link rel="prefetch" href="/assets/js/396.e9578588.js"><link rel="prefetch" href="/assets/js/397.090e352b.js"><link rel="prefetch" href="/assets/js/398.2190968c.js"><link rel="prefetch" href="/assets/js/399.cdd10b4b.js"><link rel="prefetch" href="/assets/js/4.3616097b.js"><link rel="prefetch" href="/assets/js/40.c9276079.js"><link rel="prefetch" href="/assets/js/400.28d0d6ae.js"><link rel="prefetch" href="/assets/js/401.89b1c615.js"><link rel="prefetch" href="/assets/js/402.9900507a.js"><link rel="prefetch" href="/assets/js/403.608a0f7a.js"><link rel="prefetch" href="/assets/js/404.51da312c.js"><link rel="prefetch" href="/assets/js/405.133fbe44.js"><link rel="prefetch" href="/assets/js/406.91f66fba.js"><link rel="prefetch" href="/assets/js/407.b0a595e8.js"><link rel="prefetch" href="/assets/js/408.dc312127.js"><link rel="prefetch" href="/assets/js/409.715bd867.js"><link rel="prefetch" href="/assets/js/41.43b52e06.js"><link rel="prefetch" href="/assets/js/410.26b6ff8e.js"><link rel="prefetch" href="/assets/js/411.4efba280.js"><link rel="prefetch" href="/assets/js/412.2ca3f092.js"><link rel="prefetch" href="/assets/js/413.1ab0de7c.js"><link rel="prefetch" href="/assets/js/414.63bccae4.js"><link rel="prefetch" href="/assets/js/415.1b4c258a.js"><link rel="prefetch" href="/assets/js/416.9b81a3a5.js"><link rel="prefetch" href="/assets/js/417.c5ce4f8a.js"><link rel="prefetch" href="/assets/js/418.d7f9476b.js"><link rel="prefetch" href="/assets/js/419.950ae404.js"><link rel="prefetch" href="/assets/js/42.a12c2b2c.js"><link rel="prefetch" href="/assets/js/420.7b0de39c.js"><link rel="prefetch" href="/assets/js/421.3952763d.js"><link rel="prefetch" href="/assets/js/422.b6d99ebe.js"><link rel="prefetch" href="/assets/js/423.119a98d7.js"><link rel="prefetch" href="/assets/js/424.e4a155cd.js"><link rel="prefetch" href="/assets/js/425.5dcae149.js"><link rel="prefetch" href="/assets/js/426.d0cffd49.js"><link rel="prefetch" href="/assets/js/427.4dcc2b7c.js"><link rel="prefetch" href="/assets/js/428.bc9e0acd.js"><link rel="prefetch" href="/assets/js/429.9575c577.js"><link rel="prefetch" href="/assets/js/43.8e16ab43.js"><link rel="prefetch" href="/assets/js/430.d0e52076.js"><link rel="prefetch" href="/assets/js/44.fcb64509.js"><link rel="prefetch" href="/assets/js/45.9454995c.js"><link rel="prefetch" href="/assets/js/46.de66483e.js"><link rel="prefetch" href="/assets/js/47.4d5fc0e4.js"><link rel="prefetch" href="/assets/js/48.ce19e589.js"><link rel="prefetch" href="/assets/js/49.1e6bab4e.js"><link rel="prefetch" href="/assets/js/5.9e9f7af7.js"><link rel="prefetch" href="/assets/js/50.cf1dddb3.js"><link rel="prefetch" href="/assets/js/51.b1604e39.js"><link rel="prefetch" href="/assets/js/52.8863a951.js"><link rel="prefetch" href="/assets/js/53.9c98edba.js"><link rel="prefetch" href="/assets/js/54.5ef9c0e1.js"><link rel="prefetch" href="/assets/js/55.cc7f3d4b.js"><link rel="prefetch" href="/assets/js/56.f4694cf3.js"><link rel="prefetch" href="/assets/js/57.45f02d71.js"><link rel="prefetch" href="/assets/js/58.e5707c0d.js"><link rel="prefetch" href="/assets/js/59.4a3101b7.js"><link rel="prefetch" href="/assets/js/6.c827cd18.js"><link rel="prefetch" href="/assets/js/60.fa873844.js"><link rel="prefetch" href="/assets/js/61.8444131d.js"><link rel="prefetch" href="/assets/js/62.1470e003.js"><link rel="prefetch" href="/assets/js/63.0082dece.js"><link rel="prefetch" href="/assets/js/64.87fb13b9.js"><link rel="prefetch" href="/assets/js/65.13eafe5a.js"><link rel="prefetch" href="/assets/js/66.924782a8.js"><link rel="prefetch" href="/assets/js/67.05e6b3db.js"><link rel="prefetch" href="/assets/js/68.1c1fc084.js"><link rel="prefetch" href="/assets/js/69.4c5b4151.js"><link rel="prefetch" href="/assets/js/7.ce088a3f.js"><link rel="prefetch" href="/assets/js/70.971b5146.js"><link rel="prefetch" href="/assets/js/71.5346437a.js"><link rel="prefetch" href="/assets/js/72.def2bf25.js"><link rel="prefetch" href="/assets/js/73.932ebd1f.js"><link rel="prefetch" href="/assets/js/74.17b803ed.js"><link rel="prefetch" href="/assets/js/75.039531fc.js"><link rel="prefetch" href="/assets/js/76.7ddf4f6f.js"><link rel="prefetch" href="/assets/js/77.079b67cb.js"><link rel="prefetch" href="/assets/js/78.3f96455d.js"><link rel="prefetch" href="/assets/js/79.38ce1d68.js"><link rel="prefetch" href="/assets/js/8.6ac852a3.js"><link rel="prefetch" href="/assets/js/80.6a043fef.js"><link rel="prefetch" href="/assets/js/81.4ab4b733.js"><link rel="prefetch" href="/assets/js/82.f7e499b6.js"><link rel="prefetch" href="/assets/js/83.c5f26873.js"><link rel="prefetch" href="/assets/js/84.e2c64743.js"><link rel="prefetch" href="/assets/js/85.058dda12.js"><link rel="prefetch" href="/assets/js/86.393a717e.js"><link rel="prefetch" href="/assets/js/87.fb09cdfb.js"><link rel="prefetch" href="/assets/js/88.a7d1dcfb.js"><link rel="prefetch" href="/assets/js/89.e940d8ff.js"><link rel="prefetch" href="/assets/js/9.22b17ec8.js"><link rel="prefetch" href="/assets/js/90.8f603046.js"><link rel="prefetch" href="/assets/js/91.036bf147.js"><link rel="prefetch" href="/assets/js/92.006eec70.js"><link rel="prefetch" href="/assets/js/93.0c02336b.js"><link rel="prefetch" href="/assets/js/94.7ef923ae.js"><link rel="prefetch" href="/assets/js/95.ef2a1681.js"><link rel="prefetch" href="/assets/js/96.8ea97afe.js"><link rel="prefetch" href="/assets/js/97.006c4ed1.js"><link rel="prefetch" href="/assets/js/98.3ae0af2e.js"><link rel="prefetch" href="/assets/js/99.247b7f94.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8ee7aa31.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">web</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ajax/" class="nav-link">
  ajax
</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">
  basic
</a></li><li class="dropdown-item"><!----> <a href="/canvas/" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/chart/" class="nav-link">
  chart
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/d3/" class="nav-link">
  d3
</a></li><li class="dropdown-item"><!----> <a href="/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/fast/" class="nav-link">
  fast
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/" class="nav-link">
  htmlcss
</a></li><li class="dropdown-item"><!----> <a href="/jsstore/" class="nav-link">
  jsstore
</a></li><li class="dropdown-item"><!----> <a href="/object/" class="nav-link">
  object
</a></li><li class="dropdown-item"><!----> <a href="/plugin/" class="nav-link">
  plugin
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/svg/" class="nav-link">
  svg
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  ssr
</a></li><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  test
</a></li><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/ui/" class="nav-link">
  ui
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/webdb/" class="nav-link">
  webdb
</a></li><li class="dropdown-item"><!----> <a href="/webpack/" class="nav-link router-link-active">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/webrtc/" class="nav-link">
  webrtc
</a></li><li class="dropdown-item"><!----> <a href="/wx/" class="nav-link">
  wx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/koa/" class="nav-link">
  koa
</a></li><li class="dropdown-item"><!----> <a href="/mongo/" class="nav-link">
  mongo
</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/http/" class="nav-link">
  http
</a></li><li class="dropdown-item"><!----> <a href="/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  other
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/mk/" class="nav-link">
  mk
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/reactnative/" class="nav-link">
  reactnative
</a></li><li class="dropdown-item"><!----> <a href="/book/" class="nav-link">
  book
</a></li><li class="dropdown-item"><!----> <a href="/confusing/" class="nav-link">
  confusing
</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">
  tool
</a></li><li class="dropdown-item"><!----> <a href="/increase/" class="nav-link">
  increase
</a></li><li class="dropdown-item"><!----> <a href="/write/" class="nav-link">
  write
</a></li><li class="dropdown-item"><!----> <a href="/interview/" class="nav-link">
  interview
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ajax/" class="nav-link">
  ajax
</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">
  basic
</a></li><li class="dropdown-item"><!----> <a href="/canvas/" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/chart/" class="nav-link">
  chart
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/d3/" class="nav-link">
  d3
</a></li><li class="dropdown-item"><!----> <a href="/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/fast/" class="nav-link">
  fast
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/" class="nav-link">
  htmlcss
</a></li><li class="dropdown-item"><!----> <a href="/jsstore/" class="nav-link">
  jsstore
</a></li><li class="dropdown-item"><!----> <a href="/object/" class="nav-link">
  object
</a></li><li class="dropdown-item"><!----> <a href="/plugin/" class="nav-link">
  plugin
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/svg/" class="nav-link">
  svg
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  ssr
</a></li><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  test
</a></li><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/ui/" class="nav-link">
  ui
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/webdb/" class="nav-link">
  webdb
</a></li><li class="dropdown-item"><!----> <a href="/webpack/" class="nav-link router-link-active">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/webrtc/" class="nav-link">
  webrtc
</a></li><li class="dropdown-item"><!----> <a href="/wx/" class="nav-link">
  wx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/koa/" class="nav-link">
  koa
</a></li><li class="dropdown-item"><!----> <a href="/mongo/" class="nav-link">
  mongo
</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/http/" class="nav-link">
  http
</a></li><li class="dropdown-item"><!----> <a href="/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  other
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/mk/" class="nav-link">
  mk
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/reactnative/" class="nav-link">
  reactnative
</a></li><li class="dropdown-item"><!----> <a href="/book/" class="nav-link">
  book
</a></li><li class="dropdown-item"><!----> <a href="/confusing/" class="nav-link">
  confusing
</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">
  tool
</a></li><li class="dropdown-item"><!----> <a href="/increase/" class="nav-link">
  increase
</a></li><li class="dropdown-item"><!----> <a href="/write/" class="nav-link">
  write
</a></li><li class="dropdown-item"><!----> <a href="/interview/" class="nav-link">
  interview
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/webpack/" aria-current="page" class="sidebar-link"> webpack</a></li><li><a href="/webpack/002loader.html" class="sidebar-link"> loader</a></li><li><a href="/webpack/003plugins.html" aria-current="page" class="active sidebar-link"> plugins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#plugin" class="sidebar-link">plugin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#tapable" class="sidebar-link">Tapable</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#plugin-构建对象" class="sidebar-link">Plugin 构建对象</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#html-webpack-plugin-模板html" class="sidebar-link">html-webpack-plugin 模板html</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#clean-webpack-plugin-清除掉打包文件内容" class="sidebar-link">clean-webpack-plugin 清除掉打包文件内容</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#defineplugin" class="sidebar-link">DefinePlugin</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#copywebpackplugin" class="sidebar-link">CopyWebpackPlugin</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#mini-css-extract-plugin-css抽离" class="sidebar-link">mini-css-extract-plugin CSS抽离</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#css-minimizer-webpack-plugin-css压缩" class="sidebar-link">css-minimizer-webpack-plugin css压缩</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#image-minimizer-webpack-plugin-图片压缩优化" class="sidebar-link">image-minimizer-webpack-plugin 图片压缩优化</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#vue-preload-webpack-plugin-预加载" class="sidebar-link">@vue/preload-webpack-plugin 预加载</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#eslint-webpack-plugin" class="sidebar-link">eslint-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#terser-webpack-plugin" class="sidebar-link">terser-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#workbox-webpack-plugin" class="sidebar-link">workbox-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#wepback插件手写" class="sidebar-link">wepback插件手写</a></li><li class="sidebar-sub-header"><a href="/webpack/003plugins.html#webpack代码调试" class="sidebar-link">webpack代码调试</a></li></ul></li></ul></li><li><a href="/webpack/004entry.html" class="sidebar-link"> Entry&amp;&amp;Output</a></li><li><a href="/webpack/006webpackdevserver.html" class="sidebar-link"> webpackdevserver</a></li><li><a href="/webpack/007hotmodule.html" class="sidebar-link"> 模块热更新</a></li><li><a href="/webpack/008babel.html" class="sidebar-link"> babel转换ES6</a></li><li><a href="/webpack/009treeshaking.html" class="sidebar-link"> treeshaking</a></li><li><a href="/webpack/010mode.html" class="sidebar-link"> development/production</a></li><li><a href="/webpack/011codesplitting.html" class="sidebar-link"> 代码分割</a></li><li><a href="/webpack/012lazyloading.html" class="sidebar-link"> 懒加载和预加载</a></li><li><a href="/webpack/013csssplit.html" class="sidebar-link"> css代码分割</a></li><li><a href="/webpack/014caching.html" class="sidebar-link"> 浏览器缓存</a></li><li><a href="/webpack/015shimming.html" class="sidebar-link"> shimming与环境变量</a></li><li><a href="/webpack/016library.html" class="sidebar-link"> 库打包的相关配置</a></li><li><a href="/webpack/017PWA.html" class="sidebar-link"> PWA</a></li><li><a href="/webpack/018TS.html" class="sidebar-link"> typescript的打包配置</a></li><li><a href="/webpack/019optimization.html" class="sidebar-link">webpack的optimization配置</a></li><li><a href="/webpack/020webpackdisttime.html" class="sidebar-link"> 优化webpack</a></li><li><a href="/webpack/021morepage.html" class="sidebar-link"> 多页面打包配置</a></li><li><a href="/webpack/022webppackjquery.html" class="sidebar-link"> webpack打包jquery项目</a></li><li><a href="/webpack/023bundler.html" class="sidebar-link"> bundler源码编写</a></li><li><a href="/webpack/024webpackfx.html" class="sidebar-link">webpack复习</a></li><li><a href="/webpack/026mode.html" class="sidebar-link">mode</a></li><li><a href="/webpack/027jsj.html" class="sidebar-link">webpack脚手架配置</a></li><li><a href="/webpack/028stats.html" class="sidebar-link">stats</a></li><li><a href="/webpack/050vite.html" class="sidebar-link">vite</a></li><li><a href="/webpack/100parcel.html" class="sidebar-link">parcel</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="plugin"><a href="#plugin" class="header-anchor">#</a> plugin</h2> <blockquote><p>webpack 就像一条生产线，要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的，多个流程之间有存在依赖关系，只有完成当前处理后才能交给下一个流程去处理。 插件就像是一个插入到生产线中的一个功能，<code>在特定的时机对生产线上的资源做处理</code>。webpack 通过 Tapable 来组织这条复杂的生产线。 webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条生产线中，去改变生产线的运作。<code>webpack 的事件流机制保证了插件的有序性</code>，使得整个系统扩展性很好。 ——「深入浅出 Webpack」</p></blockquote> <p>在打包的特定时间做特定的事；Loader是用于特定的模块类型进行转换；Plugin可以用于执行更加广泛的任务，比如打包优化、资源管理、环境变量注入等；</p> <p><code>通常的插件都是一个class，不过也可以是函数。</code></p> <p>webpack 在编译代码过程中，会触发一系列 <code>Tapable</code> 钩子事件，插件所做的，就是找到相应的钩子，往上面挂上自己的任务，也就是注册事件，这样，当 webpack 构建的时候，插件注册的事件就会随着钩子的触发而执行了。</p> <p>钩子的本质就是：事件。为了方便我们直接介入和控制编译过程，webpack 把编译过程中触发的各类关键事件封装成事件接口暴露了出来。这些接口被很形象地称做：hooks（钩子）。开发插件，离不开这些钩子。</p> <h3 id="tapable"><a href="#tapable" class="header-anchor">#</a> Tapable</h3> <p>Tapable 为 webpack 提供了统一的插件接口（钩子）类型定义，它是 webpack 的核心功能库。webpack 中目前有十种 hooks，在 Tapable 源码中可以看到，他们是：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// https://github.com/webpack/tapable/blob/master/lib/index.js</span>
exports<span class="token punctuation">.</span>SyncHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>SyncBailHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncBailHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>SyncWaterfallHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncWaterfallHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>SyncLoopHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./SyncLoopHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncParallelHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncParallelHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncParallelBailHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncParallelBailHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesBailHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesBailHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesLoopHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesLoopHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>AsyncSeriesWaterfallHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./AsyncSeriesWaterfallHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>HookMap <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./HookMap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>MultiHook <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./MultiHook&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Tapable 还统一暴露了三个方法给插件，用于注入不同类型的自定义构建行为：</p> <ul><li>tap：可以注册同步钩子和异步钩子。</li> <li>tapAsync：回调方式注册异步钩子。</li> <li>tapPromise：Promise 方式注册异步钩子。</li></ul> <h3 id="plugin-构建对象"><a href="#plugin-构建对象" class="header-anchor">#</a> Plugin 构建对象</h3> <ol><li><strong>Compiler</strong></li></ol> <p>compiler 对象中保存着完整的 Webpack 环境配置，每次启动 webpack 构建时它都是一个独一无二，仅仅会创建一次的对象。</p> <p>这个对象会在首次启动 Webpack 时创建，我们可以通过 compiler 对象上访问到 Webapck 的主环境配置，比如 loader 、 plugin 等等配置信息。</p> <p>它有以下主要属性：</p> <ul><li>compiler.options 可以访问本次启动 webpack 时候所有的配置文件，包括但不限于 loaders 、 entry 、 output 、 plugin 等等完整配置信息。</li> <li>compiler.inputFileSystem 和 compiler.outputFileSystem 可以进行文件操作，相当于 Nodejs 中 fs。</li> <li>compiler.hooks 可以注册 tapable 的不同种类 Hook，从而可以在 compiler 生命周期中植入不同的逻辑。</li></ul> <ol start="2"><li><strong>Compilation</strong></li></ol> <p>compilation 对象代表一次资源的构建，compilation 实例能够访问所有的模块和它们的依赖。</p> <p>一个 compilation 对象会对构建依赖图中所有模块，进行编译。 在编译阶段，模块会被加载(load)、封存(seal)、优化(optimize)、 分块(chunk)、哈希(hash)和重新创建(restore)。</p> <p>它有以下主要属性：</p> <ul><li>compilation.modules 可以访问所有模块，打包的每一个文件都是一个模块。</li> <li>compilation.chunks chunk 即是多个 modules 组成而来的一个代码块。入口文件引入的资源组成一个 chunk，通过代码分割的模块又是另外的 chunk。</li> <li>compilation.assets 可以访问本次打包生成所有文件的结果。</li> <li>compilation.hooks 可以注册 tapable 的不同种类 Hook，用于在 compilation 编译模块阶段进行逻辑添加以及修改。</li></ul> <img src="/beifen/561.jpg" style="width:450px;"> <h3 id="html-webpack-plugin-模板html"><a href="#html-webpack-plugin-模板html" class="header-anchor">#</a> html-webpack-plugin 模板html</h3> <div class="language- extra-class"><pre class="language-text"><code>cnpm install html-webpack-plugin -D
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">htmlwebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'./index.html'</span><span class="token comment">//output里的js等文件自动注入</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">...</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;./public/index.html&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;哈哈哈哈&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>默认情况下是根据ejs的一个模板来生成的；在html-webpack-plugin的源码中，有一个default_index.ejs模块；</p> <p>如果需要定制index.html</p> <ul><li>template：指定我们要使用的模块所在的路径；</li> <li>title：在进行htmlWebpackPlugin.options.title读取时，就会读到该信息；</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果需要设置BASE_URL，可以使用DefinePlugin插件，DefinePlugin允许在编译时创建配置的全局常量，是一个webpack内置的插件（不需要单独安装）</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;favicon.ico<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span><span class="token operator">...</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		  <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">&quot;'./'&quot;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span>
</code></pre></div><h3 id="clean-webpack-plugin-清除掉打包文件内容"><a href="#clean-webpack-plugin-清除掉打包文件内容" class="header-anchor">#</a> clean-webpack-plugin 清除掉打包文件内容</h3> <p>在webapck5中可以直接使用output中配置clean：true清空对应的打包文件，不需要继续安装</p> <div class="language- extra-class"><pre class="language-text"><code>cnpm install clean-webpack-plugin -D
</code></pre></div><p>这个插件在webpack4中接受的是对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack版本：4.32.2</span>
 <span class="token comment">//error: CleanWebpackPlugin is not  a constructor</span>
<span class="token comment">// 抛错原写法</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;clean-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'dist'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
 
<span class="token comment">// 另一种错误写法</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'dist'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">root</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment">//根目录</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
 
<span class="token comment">// =============================分割线==============================</span>
 
<span class="token comment">// 正确写法</span>
 
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;clean-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
 
<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><blockquote><p>output中的path需要配置，不配置的话可能会导致CleanWebpackPlugin无效</p></blockquote> <h3 id="defineplugin"><a href="#defineplugin" class="header-anchor">#</a> DefinePlugin</h3> <p>给代码定义一些环境变量；</p> <p>html模块中还使用到一个<code>BASE_URL</code>的常量：这是因为在编译template模块时，有一个<code>BASE_URL</code>：</p> <blockquote><p><em><strong>注意BASE_URL: &quot; './' &quot;,自身是被引号包裹</strong></em></p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= BASE_URL %&gt;favicon.ico<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>但是并没有设置过这个常量值，所以会出现没有定义的错误；这个时候可以使用DefinePlugin插件；</p> <p>DefinePlugin允许在编译时创建配置的全局常量，是一个webpack内置的插件（不需要单独安装）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 设置source-map, 建立js映射文件, 方便调试代码和错误</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;source-map&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">&quot;'./'&quot;</span><span class="token punctuation">,</span>
	  <span class="token literal-property property">__VUE_OPTIONS_API__</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//vue3的配置，关闭option api，默认是false</span>
	  <span class="token literal-property property">__VUE_PROD_DEVTOOLS__</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token comment">//关闭devtools</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>这个时候，编译template就可以正确的编译了，会读取到BASE_URL的值；</p> <h3 id="copywebpackplugin"><a href="#copywebpackplugin" class="header-anchor">#</a> CopyWebpackPlugin</h3> <p>在vue的打包过程中，如果我们将一些文件放到public的目录下，那么这个目录会被复制到dist文件夹中。这个复制的功能，我们可以使用CopyWebpackPlugin来完成；</p> <div class="language- extra-class"><pre class="language-text"><code>npm install copy-webpack-plugin -D
</code></pre></div><p>接下来配置CopyWebpackPlugin即可：复制的规则在patterns中设置；</p> <ul><li>from：设置从哪一个源中开始复制；</li> <li>to：复制到的位置，可以省略，会默认复制到打包的目录下； <em><strong>'./'默认值，如果改成'./dist'，就会在打包目录下生成一个dist目录放静态文件</strong></em></li> <li>globOptions：设置一些额外的选项，其中可以编写需要忽略的文件：</li></ul> <ul><li>.DS_Store：mac目录下回自动生成的一个文件；</li> <li>index.html：也不需要复制，因为我们已经通过HtmlWebpackPlugin完成了index.html的生成；</li></ul> <p>应用场景：icon图标从public赋值到dist目录下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		  <span class="token literal-property property">patterns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		    <span class="token punctuation">{</span>
		      <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;public&quot;</span><span class="token punctuation">,</span>
		      <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
		      <span class="token literal-property property">globOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		        <span class="token literal-property property">ignore</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		          <span class="token string">&quot;**/index.html&quot;</span>
		        <span class="token punctuation">]</span>
		      <span class="token punctuation">}</span>
		    <span class="token punctuation">}</span>
		  <span class="token punctuation">]</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mini-css-extract-plugin-css抽离"><a href="#mini-css-extract-plugin-css抽离" class="header-anchor">#</a> mini-css-extract-plugin CSS抽离</h3> <p>Css 文件目前被打包到 js 文件中，当 js 文件加载时，会创建一个 style 标签来生成样式</p> <p>这样对于网站来说，会出现闪屏现象，用户体验不好,应该是单独的 Css 文件，通过 link 标签加载性能才好</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i mini-css-extract-plugin -D
</code></pre></div><p>在loader中配置取代style-loader，也要在plugins中配置，可以配置输出目录等</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 用来匹配 .css 结尾的文件</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// use 数组里面 Loader 执行顺序是从右到左</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.styl$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;stylus-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>

    <span class="token comment">// 提取css成单独文件</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 定义输出文件名和目录</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/css/main.css&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="css-minimizer-webpack-plugin-css压缩"><a href="#css-minimizer-webpack-plugin-css压缩" class="header-anchor">#</a> css-minimizer-webpack-plugin css压缩</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i css-minimizer-webpack-plugin -D
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;css-minimizer-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取处理样式的Loaders</span>
<span class="token keyword">const</span> <span class="token function-variable function">getStyleLoaders</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">preProcessor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
    <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">postcssOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;postcss-preset-env&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 能解决大多数样式兼容性问题</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    preProcessor<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 用来匹配 .css 结尾的文件</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// use 数组里面 Loader 执行顺序是从右到左</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token function">getStyleLoaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.s[ac]ss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token function">getStyleLoaders</span><span class="token punctuation">(</span><span class="token string">&quot;sass-loader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 提取css成单独文件</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 定义输出文件名和目录</span>
      <span class="token comment">// filename: &quot;static/css/main.css&quot;,</span>
      <span class="token comment">// 当多文件时使用name防止冲突</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/css/[name].css&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 如果有code split 动态引入的css也可以chunkFileName处理</span>
      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&quot;static/css/[name].chunk.[contenthash:10].css&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// css压缩</span>
    <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="image-minimizer-webpack-plugin-图片压缩优化"><a href="#image-minimizer-webpack-plugin-图片压缩优化" class="header-anchor">#</a> image-minimizer-webpack-plugin 图片压缩优化</h3> <p>用来压缩图片的插件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i image-minimizer-webpack-plugin imagemin -D
</code></pre></div><p>还有剩下包需要下载，有两种模式：</p> <ul><li>无损压缩</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo -D
</code></pre></div><ul><li>有损压缩</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo -D
</code></pre></div><ul><li>无损压缩配置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;os&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ImageMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;image-minimizer-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// cpu核数</span>
<span class="token keyword">const</span> threads <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 生产模式需要输出</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/js/main.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 将 js 文件输出到 static/js 目录中</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">oneOf</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// 小于10kb的图片会被base64处理</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">generator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/imgs/[hash:8][ext][query]&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 压缩图片</span>
      <span class="token keyword">new</span> <span class="token class-name">ImageMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">implementation</span><span class="token operator">:</span> ImageMinimizerPlugin<span class="token punctuation">.</span>imageminGenerate<span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">[</span><span class="token string">&quot;gifsicle&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">interlaced</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token string">&quot;jpegtran&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">progressive</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token string">&quot;optipng&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">optimizationLevel</span><span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span>
                <span class="token string">&quot;svgo&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token string">&quot;preset-default&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;prefixIds&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;sortAttrs&quot;</span><span class="token punctuation">,</span>
                      <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">xmlnsOrder</span><span class="token operator">:</span> <span class="token string">&quot;alphabetical&quot;</span><span class="token punctuation">,</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>打包报错，npm安装的这两个包由于多种原因可能安装失败，可多安装几次或者镜像安装</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>Error: Error with <span class="token string">'src\images\1.jpeg'</span><span class="token builtin class-name">:</span> <span class="token string">'&quot;C:\Users\86176\Desktop\webpack\webpack_code\node_modules\jpegtran-bin\vendor\jpegtran.exe&quot;'</span>
Error with <span class="token string">'src\images\3.gif'</span><span class="token builtin class-name">:</span> spawn C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span><span class="token number">86176</span><span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>webpack<span class="token punctuation">\</span>webpack_code<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>optipng-bin<span class="token punctuation">\</span>vendor<span class="token punctuation">\</span>optipng.exe ENOENT
</code></pre></div><h3 id="vue-preload-webpack-plugin-预加载"><a href="#vue-preload-webpack-plugin-预加载" class="header-anchor">#</a> @vue/preload-webpack-plugin 预加载</h3> <div class="language-js extra-class"><pre class="language-js"><code>npm i @vue<span class="token operator">/</span>preload<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。</p> <p>我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 Preload 或 Prefetch 技术。</p> <ul><li><p>Preload：告诉浏览器立即加载资源。</p></li> <li><p>Prefetch：告诉浏览器在空闲时才开始加载资源。</p></li> <li><p>它们共同点：</p> <ul><li>都只会加载资源，并不执行。</li> <li>都有缓存。</li></ul></li> <li><p>它们区别：</p> <ul><li>Preload加载优先级高，Prefetch加载优先级低。</li> <li>Preload只能加载当前页面需要使用的资源，Prefetch可以加载当前页面资源，也可以加载下一个页面需要使用的资源。</li></ul></li> <li><p>总结：</p> <ul><li>当前页面优先级高的资源用 Preload 加载。</li> <li>下一个页面需要使用的资源用 Prefetch 加载。</li></ul></li> <li><p>它们的问题：兼容性较差，Preload 相对于 Prefetch 兼容性好一点。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 生产模式需要输出</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/js/[name].js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 入口文件打包输出资源命名方式</span>
    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&quot;static/js/[name].chunk.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 动态导入输出资源命名方式</span>
    <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span> <span class="token string">&quot;static/media/[name].[hash][ext]&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 图片、字体等资源命名方式（注意用hash）</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">PreloadWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">rel</span><span class="token operator">:</span> <span class="token string">&quot;preload&quot;</span><span class="token punctuation">,</span> <span class="token comment">// preload兼容性更好</span>
      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">&quot;script&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// rel: 'prefetch' // prefetch兼容性更差</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="eslint-webpack-plugin"><a href="#eslint-webpack-plugin" class="header-anchor">#</a> eslint-webpack-plugin</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i eslint-webpack-plugin eslint -D
</code></pre></div><p>Webpack 对 js 处理是有限的，只能编译 js 中 ES 模块化语法，不能编译其他语法，导致 js 不能在 IE 等浏览器运行，所以希望做一些兼容性处理。其次开发中，团队对代码格式是有严格要求的，不能由肉眼去检测代码格式，需要使用专业的工具来检测。</p> <ul><li>针对 js 兼容性处理，我们使用 Babel 来完成</li> <li>针对代码格式，我们使用 Eslint 来完成</li></ul> <p>eslint：可组装的 JavaScript 和 JSX 检查工具。</p> <ol><li>配置文件
配置文件由很多种写法：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>//  区别在于配置格式不一样
.eslintrc.*：新建文件，位于项目根目录
.eslintrc
.eslintrc.js
.eslintrc.json
</code></pre></div><p>package.json 中 eslintConfig：不需要创建文件，在原有文件基础上写,ESLint 会查找和自动读取它们，所以以上配置文件只需要存在一个即可</p> <p>以 .eslintrc.js 配置文件为例:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 解析选项</span>
  <span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 具体检查规则</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 继承其他规则</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// 其他规则详见：https://eslint.bootcss.com/docs/user-guide/configuring</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol><li>parserOptions 解析选项</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">ecmaVersion</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token comment">// ES 语法版本</span>
  <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ES 模块化</span>
  <span class="token literal-property property">ecmaFeatures</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// ES 其他特性</span>
    <span class="token literal-property property">jsx</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 如果是 React 项目，就需要开启 jsx 语法</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>rules 具体规则
<ul><li>&quot;off&quot; 或 0 - 关闭规则</li> <li>&quot;warn&quot; 或 1 - 开启规则，使用警告级别的错误：warn (不会导致程序退出)</li> <li>&quot;error&quot; 或 2 - 开启规则，使用错误级别的错误：error (当被触发的时候，程序会退出)</li></ul></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">semi</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 禁止使用分号</span>
  <span class="token string-property property">'array-callback-return'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token comment">// 强制数组方法的回调函数中有 return 语句，否则警告</span>
  <span class="token string-property property">'default-case'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token comment">// 要求 switch 语句中有 default 分支，否则警告</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">commentPattern</span><span class="token operator">:</span> <span class="token string">'^no default$'</span> <span class="token punctuation">}</span> <span class="token comment">// 允许在最后注释 no default, 就不会有警告了</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">eqeqeq</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token comment">// 强制使用 === 和 !==，否则警告</span>
    <span class="token string">'smart'</span> <span class="token comment">// https://eslint.bootcss.com/docs/rules/eqeqeq#smart 除了少数情况下不会有警告</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://eslint.bootcss.com/docs/rules/" target="_blank" rel="noopener noreferrer">配置指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol start="3"><li>extends 继承
开发中一点点写 rules 规则太费劲了，所以有更好的办法，继承现有的规则。</li></ol> <p>现有以下较为有名的规则：</p> <ul><li>Eslint 官方的规则：eslint:recommended</li> <li>Vue Cli 官方的规则：plugin:vue/essential</li> <li>React Cli 官方的规则：react-app</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 例如在React项目中，我们可以这样写配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;react-app&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自己写的规则会覆盖掉react-app的规则</span>
    <span class="token comment">// 所以想要修改规则直接改就是了</span>
    <span class="token literal-property property">eqeqeq</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;warn&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;smart&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h4> <ol><li>创建.eslintrc.js</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 继承 Eslint 规则</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;eslint:recommended&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">&quot;@babel/eslint-parser&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 支持最新的最终 ECMAScript 标准</span>
  <span class="token literal-property property">env</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">node</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 启用node中全局变量</span>
    <span class="token literal-property property">browser</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 启用浏览器中全局变量</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">ecmaVersion</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;no-var&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 不能使用 var 定义变量</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;import&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 解决动态导入语法报错 --&gt; 实际使用eslint-plugin-import的规则解决的</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>webpack中配置</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ESLintWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;eslint-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ESLintWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 指定检查文件的根目录</span>
      <span class="token literal-property property">context</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>VSCode Eslint 插件可以在开发阶段就标出错误，但是此时就会对项目所有文件默认进行 Eslint 检查了，dist 目录下的打包后文件就会报错。所以可以使用 Eslint 忽略文件解决。在项目根目录新建下面文件:</li></ol> <p>.eslintignore</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 忽略dist目录下所有文件</span>
dist
</code></pre></div><h3 id="terser-webpack-plugin"><a href="#terser-webpack-plugin" class="header-anchor">#</a> terser-webpack-plugin</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span>
      <span class="token comment">// 默认值，可以不写~</span>
      <span class="token comment">/* minSize: 30 * 1024, // 分割的chunk最小为30kb
      maxSiza: 0, // 最大没有限制
      minChunks: 1, // 要提取的chunk最少被引用1次
      maxAsyncRequests: 5, // 按需加载时并行加载的文件的最大数量
      maxInitialRequests: 3, // 入口js文件最大并行请求数量
      automaticNameDelimiter: '~', // 名称连接符
      name: true, // 可以使用命名规则
      cacheGroups: {
        // 分割chunk的组
        // node_modules文件会被打包到 vendors 组的chunk中。--&gt; vendors~xxx.js
        // 满足上面的公共规则，如：大小超过30kb，至少被引用一次。
        vendors: {
          test: /[\\/]node_modules[\\/]/,
          // 优先级
          priority: -10
        },
        default: {
          // 要提取的chunk最少被引用2次
          minChunks: 2,
          // 优先级
          priority: -20,
          // 如果当前要打包的模块，和之前已经被提取的模块是同一个，就会复用，而不是重新打包模块
          reuseExistingChunk: true
        } 
      }*/</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 将当前模块的记录其他模块的hash单独打包为一个文件 runtime</span>
    <span class="token comment">// 解决：修改a文件导致b文件的contenthash变化</span>
    <span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token parameter">entrypoint</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">runtime-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entrypoint<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 配置生产环境的压缩方案：js和css</span>

      <span class="token comment">// 当生产模式会默认开启TerserPlugin，但是如果需要进行其他配置，就要重新写了</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 开启缓存</span>
        <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 开启多进程打包</span>
        <span class="token literal-property property">parallel</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// 启动source-map</span>
        <span class="token literal-property property">sourceMap</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="workbox-webpack-plugin"><a href="#workbox-webpack-plugin" class="header-anchor">#</a> workbox-webpack-plugin</h3> <p>wpa优化 <a href="/webpack/017PWA.html#pwa">pwa</a></p> <h3 id="wepback插件手写"><a href="#wepback插件手写" class="header-anchor">#</a> wepback插件手写</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">TestPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin constructor()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 1. webpack读取配置时，new TestPlugin() ，会执行插件 constructor 方法</span>
  <span class="token comment">// 2. webpack创建 compiler 对象</span>
  <span class="token comment">// 3. 遍历所有插件，调用插件的 apply 方法</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin apply()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> TestPlugin<span class="token punctuation">;</span>
</code></pre></div><h4 id="注册-hook"><a href="#注册-hook" class="header-anchor">#</a> 注册 hook</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">TestPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin constructor()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 1. webpack读取配置时，new TestPlugin() ，会执行插件 constructor 方法</span>
  <span class="token comment">// 2. webpack创建 compiler 对象</span>
  <span class="token comment">// 3. 遍历所有插件，调用插件的 apply 方法</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin apply()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 从文档可知, compile hook 是 SyncHook, 也就是同步钩子, 只能用tap注册</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compile<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilationParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.compile()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 从文档可知, make 是 AsyncParallelHook, 也就是异步并行钩子, 特点就是异步任务同时执行(谁输出的结果快谁先输出)</span>
    <span class="token comment">// 可以使用 tap、tapAsync、tapPromise 注册。</span>
    <span class="token comment">// 如果使用tap注册的话，进行异步操作是不会等待异步操作执行完成的。</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>make<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// seal:需要在compilation hooks触发前注册才能使用</span>
      compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>seal<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'TestPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'---'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.make() 111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用tapAsync、tapPromise注册，进行异步操作会等异步操作做完再继续往下执行</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>make<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.make() 222&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 必须调用</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>make<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.make() 333&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 必须返回promise</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 从文档可知, emit 是 AsyncSeriesHook, 也就是异步串行钩子，特点就是异步任务顺序执行(emit三个事件上面的执行完再去执行下面的)</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.emit() 111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.emit() 222&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;TestPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;compiler.emit() 333&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> TestPlugin<span class="token punctuation">;</span>
</code></pre></div><h3 id="webpack代码调试"><a href="#webpack代码调试" class="header-anchor">#</a> webpack代码调试</h3> <ol><li>package.json中配置</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;source&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 作用：1进入node环境，2打开后第一行断点，3调用webpack 4.浏览器中查看信息</span>
    <span class="token property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node --inspect-brk ./node_modules/webpack-cli/bin/cli.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xiongjian&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@babel/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.17.10&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/preset-env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.17.10&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;css-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.7.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;loader-utils&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.72.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.9.2&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此时控制台输出以下内容：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span><span class="token number">86176</span><span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span>source<span class="token operator">&gt;</span> <span class="token function">npm</span> run debug

<span class="token operator">&gt;</span> source@1.0.0 debug
<span class="token operator">&gt;</span> <span class="token function">node</span> --inspect-brk ./node_modules/webpack-cli/bin/cli.js

Debugger listening on ws://127.0.0.1:9229/629ea097-7b52-4011-93a7-02f83c75c797
For help, see: https://nodejs.org/en/docs/inspecto
</code></pre></div><p>打开 Chrome 浏览器，F12 打开浏览器调试控制台。</p> <img src="/beifen/562.png"> <h4 id="bannerwebpackplugin"><a href="#bannerwebpackplugin" class="header-anchor">#</a> BannerWebpackPlugin</h4> <p>给打包输出文件添加注释。</p> <p>在loader中手写的banner-loader可在在生产环境中打包后不好查看或者某些清除无用代码给删除了，所以更适合在插件中设置。</p> <p>开发思路:</p> <ol><li>需要打包输出前添加注释：需要使用 compiler.hooks.emit 钩子, 它是打包输出前触发。</li> <li>如何获取打包输出的资源？compilation.assets(官方新版本不推荐，这里只是演示需要) 可以获取所有即将输出的资源文件。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// plugins/banner-webpack-plugin.js</span>
<span class="token keyword">class</span> <span class="token class-name">BannerWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 需要处理文件</span>
    <span class="token keyword">const</span> extensions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// emit是异步串行钩子</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;BannerWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// compilation.assets包含所有即将输出的资源</span>
      <span class="token comment">// 通过过滤只保留需要处理的文件</span>
      <span class="token keyword">const</span> assetPaths <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> splitted <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> extensions<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>splitted<span class="token punctuation">[</span>splitted<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      assetPaths<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">assetPath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> asset <span class="token operator">=</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>assetPath<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/*
* Author: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>author<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
*/\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>asset<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

        <span class="token comment">// 覆盖资源</span>
        compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>assetPath<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token comment">// 资源内容</span>
          <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> source<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment">// 资源大小</span>
          <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> source<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> BannerWebpackPlugin<span class="token punctuation">;</span>
</code></pre></div><h4 id="cleanwebpackplugin"><a href="#cleanwebpackplugin" class="header-anchor">#</a> CleanWebpackPlugin</h4> <p>在 webpack <code>打包输出前</code>将上次打包内容清空。</p> <p>开发思路：</p> <ul><li>如何在打包输出前执行？需要使用 compiler.hooks.emit 钩子, 它是打包输出前触发。</li> <li>如何清空上次打包内容？
<ul><li>获取打包输出目录：通过 compiler 对象。</li> <li>通过文件操作清空内容：通过 compiler.outputFileSystem 操作文件。</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// plugins/clean-webpack-plugin.js</span>
<span class="token keyword">class</span> <span class="token class-name">CleanWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取操作文件的对象</span>
    <span class="token keyword">const</span> fs <span class="token operator">=</span> compiler<span class="token punctuation">.</span>outputFileSystem<span class="token punctuation">;</span>
    <span class="token comment">// emit是异步串行钩子</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">&quot;CleanWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取输出文件目录</span>
      <span class="token keyword">const</span> outputPath <span class="token operator">=</span> compiler<span class="token punctuation">.</span>options<span class="token punctuation">.</span>output<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
      <span class="token comment">// 删除目录所有文件</span>
      <span class="token keyword">const</span> err <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeFiles</span><span class="token punctuation">(</span>fs<span class="token punctuation">,</span> outputPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 执行成功err为undefined，执行失败err就是错误原因</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">removeFiles</span><span class="token punctuation">(</span><span class="token parameter">fs<span class="token punctuation">,</span> path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// 读取当前目录下所有文件</span>
      <span class="token keyword">const</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 遍历文件，删除</span>
      files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取文件完整路径</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token comment">// 分析文件</span>
        <span class="token keyword">const</span> fileStat <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 判断是否是文件夹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fileStat<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 是文件夹需要递归遍历删除下面所有文件</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeFiles</span><span class="token punctuation">(</span>fs<span class="token punctuation">,</span> filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 不是文件夹就是文件，直接删除</span>
          fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 最后删除当前目录</span>
      fs<span class="token punctuation">.</span><span class="token function">rmdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 将产生的错误返回出去</span>
      <span class="token keyword">return</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CleanWebpackPlugin<span class="token punctuation">;</span>
</code></pre></div><h4 id="analyzewebpackplugin"><a href="#analyzewebpackplugin" class="header-anchor">#</a> AnalyzeWebpackPlugin</h4> <ul><li>作用：分析 webpack 打包资源大小，并输出分析文件。</li> <li>开发思路: compiler.hooks.emit, 它是在打包输出前触发，我们需要分析资源大小同时添加上分析后的 md 文件。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// plugins/analyze-webpack-plugin.js</span>
<span class="token keyword">class</span> <span class="token class-name">AnalyzeWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// emit是异步串行钩子</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;AnalyzeWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Object.entries将对象变成二维数组。二维数组中第一项值是key，第二项值是value</span>
      <span class="token keyword">const</span> assets <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> source <span class="token operator">=</span> <span class="token string">&quot;# 分析打包资源大小 \n| 名称 | 大小 |\n| --- | --- |&quot;</span><span class="token punctuation">;</span>

      assets<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>filename<span class="token punctuation">,</span> file<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        source <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\n| </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>filename<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> |</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 添加资源</span>
      compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span><span class="token string">&quot;analyze.md&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> source<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> source<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> AnalyzeWebpackPlugin<span class="token punctuation">;</span>
</code></pre></div><h4 id="inlineruntimewebpackplugin"><a href="#inlineruntimewebpackplugin" class="header-anchor">#</a> InlineRuntimeWebpackPlugin</h4> <ul><li>作用：webpack 打包生成的 runtime 文件太小了，额外发送请求性能不好，所以需要将其内联到 js 中，从而减少请求数量。</li> <li>开发思路:
<ul><li>需要借助 html-webpack-plugin 来实现</li> <li>在 html-webpack-plugin 输出 index.html 前将内联 runtime 注入进去</li> <li>删除多余的 runtime 文件</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// plugins/inline-chunk-webpack-plugin.js</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;safe-require&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">InlineChunkWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">tests</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>tests <span class="token operator">=</span> tests<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;InlineChunkWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> hooks <span class="token operator">=</span> HtmlWebpackPlugin<span class="token punctuation">.</span><span class="token function">getHooks</span><span class="token punctuation">(</span>compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>

      hooks<span class="token punctuation">.</span>alterAssetTagGroups<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;InlineChunkWebpackPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">assets</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        assets<span class="token punctuation">.</span>headTags <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getInlineTag</span><span class="token punctuation">(</span>assets<span class="token punctuation">.</span>headTags<span class="token punctuation">,</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">;</span>
        assets<span class="token punctuation">.</span>bodyTags <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getInlineTag</span><span class="token punctuation">(</span>assets<span class="token punctuation">.</span>bodyTags<span class="token punctuation">,</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      hooks<span class="token punctuation">.</span>afterEmit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">&quot;InlineChunkHtmlPlugin&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">assetName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tests<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">test</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> assetName<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>assetName<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getInlineTag</span><span class="token punctuation">(</span><span class="token parameter">tags<span class="token punctuation">,</span> assets</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> tags<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>tag<span class="token punctuation">.</span>tagName <span class="token operator">!==</span> <span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> tag<span class="token punctuation">;</span>

      <span class="token keyword">const</span> scriptName <span class="token operator">=</span> tag<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>src<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>tests<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">test</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> scriptName<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> tag<span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">tagName</span><span class="token operator">:</span> <span class="token string">&quot;script&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">innerHTML</span><span class="token operator">:</span> assets<span class="token punctuation">[</span>scriptName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">closeTag</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> InlineChunkWebpackPlugin<span class="token punctuation">;</span>
</code></pre></div><!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">5/1/2023, 9:10:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/webpack/002loader.html" class="prev">
         loader
      </a></span> <span class="next"><a href="/webpack/004entry.html">
         Entry&amp;&amp;Output
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.723af4b8.js" defer></script><script src="/assets/js/2.1a953b48.js" defer></script><script src="/assets/js/384.b3c735f9.js" defer></script><script src="/assets/js/10.174ca6d2.js" defer></script>
  </body>
</html>
