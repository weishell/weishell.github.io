(window.webpackJsonp=window.webpackJsonp||[]).push([[384],{769:function(t,s,a){"use strict";a.r(s);var e=a(16),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"babel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel"}},[t._v("#")]),t._v(" babel")]),t._v(" "),a("p",[t._v("Babel是一个 "),a("em",[a("strong",[t._v("工具链")])]),t._v(" ，主要用于旧浏览器或者环境中将ECMAScript 2015+代码转换为向后兼容版本的JavaScript；包括：语法转换、源代码转换等；")]),t._v(" "),a("img",{attrs:{src:"/beifen/421.png"}}),t._v(" "),a("h3",{attrs:{id:"单独命令行使用babel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单独命令行使用babel"}},[t._v("#")]),t._v(" 单独命令行使用babel")]),t._v(" "),a("p",[t._v("babel本身可以作为一个独立的工具（和postcss一样），不和webpack等构建工具配置来单独使用。")]),t._v(" "),a("p",[t._v("如果我们希望在命令行尝试使用babel，需要安装如下库：")]),t._v(" "),a("ul",[a("li",[t._v("@babel/core：babel的核心代码，必须安装；")]),t._v(" "),a("li",[t._v("@babel/cli：可以让我们在命令行使用babel；如果在webpack中可以不使用")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm install @babel/cli @babel/core -D\n")])])]),a("p",[t._v("使用babel来处理我们的源代码：")]),t._v(" "),a("ul",[a("li",[t._v("src：是源文件的目录；")]),t._v(" "),a("li",[t._v("--out-dir：指定要输出的文件夹dist；")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx babel src --out-dir dist //dist目录\nnpx babel src --out-file dist.js //dist文件\nnpx babel demo.js --out-file dist.js //dist文件\n")])])]),a("h4",{attrs:{id:"babel插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel插件"}},[t._v("#")]),t._v(" babel插件")]),t._v(" "),a("p",[t._v("比如我们需要转换箭头函数，那么我们就可以使用箭头函数转换相关的插件：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cnpm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" @babel/plugin-transform-arrow-functions -D\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx babel src --out-dir dist --plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("@babel/plugin-transform-arrow-functions\n")])])]),a("p",[t._v("再增加一个转化作用域")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" @babel/plugin-transform-block-scoping -D \n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx babel src --out-dir dist --plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("@babel/plugin-transform-block-scoping,@babel/plugin-transform-arrow-functions\n")])])]),a("h3",{attrs:{id:"babel预设"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel预设"}},[t._v("#")]),t._v(" babel预设")]),t._v(" "),a("p",[t._v("但是如果要转换的内容过多，一个个设置是比较麻烦的，我们可以使用预设（preset）")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cnpm i --save-dev babel-loader @babel/core @babel/preset-env\n//也可以类似上面用逗号隔开进行多个预设\n")])])]),a("p",[t._v("在命令行中使用：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("npx babel src --out-dir dist --presets"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("@babel/preset-env\n")])])]),a("p",[t._v("在webpack配置中配置规则：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("exclude")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("node_modules")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("presets")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/preset-env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\t\t\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("ul",[a("li",[t._v("既可以使用options中配置单独的babel解析es6的插件，也可以使用presets预设的方法。如果预设的方法需要额外的操作，可以改成数组的形式。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// plugins: [")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//   "@babel/plugin-transform-arrow-functions",')]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//   "@babel/plugin-transform-block-scoping",')]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ]")]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("presets")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n               "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/preset-env"')]),t._v("\n             "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\t\t\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//也可以是数组形式")]),t._v("\n\t\t\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// presets: [")]),t._v("\n\t\t\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//   ["@babel/preset-env",{')]),t._v("\n\t\t\t\t   \n\t\t\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   }]")]),t._v("\n\t\t\t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ]")]),t._v("\n           "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("这种语法转换有局限性，因为低版本对于某些转换后的js还是不认识，如map,promise等")]),t._v(" "),a("h3",{attrs:{id:"babel的配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel的配置文件"}},[t._v("#")]),t._v(" Babel的配置文件")]),t._v(" "),a("p",[t._v("像之前一样，我们可以将babel的配置信息放到一个独立的文件中，babel给我们提供了两种配置文件的编写：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("babel.config.json（或者.js，.cjs，.mjs）文件；")])]),t._v(" "),a("li",[a("p",[t._v(".babelrc.json（或者.babelrc，.js，.cjs，.mjs）文件；")])]),t._v(" "),a("li",[a("p",[t._v(".babelrc.json：早期使用较多的配置方式，但是对于配置Monorepos项目是比较麻烦的；")])]),t._v(" "),a("li",[a("p",[t._v("babel.config.json（babel7）：可以直接作用于Monorepos项目的子包，更加推荐；")])])]),t._v(" "),a("p",[t._v("抽离出babel，放到单独文件babel.config.js")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//webpack中就不需要继续配置babel的具体操作")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-loader"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("presets")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/preset-env"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"babel支持vue的jsx插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel支持vue的jsx插件"}},[t._v("#")]),t._v(" babel支持Vue的jsx插件")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" @vue/babel-plugin-jsx -D\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("presets")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/preset-env"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vue/babel-plugin-jsx"')]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"polyfill"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#polyfill"}},[t._v("#")]),t._v(" polyfill")]),t._v(" "),a("p",[t._v("Polyfill是一个js库，主要抚平不同浏览器之间对js实现的差异。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cnpm i --save @babel/polyfill\n")])])]),a("p",[t._v("在原先的业务代码前加上"),a("code",[t._v("import '@babel/polyfill';")]),t._v("不过在最新版本的webpack中只要配置了"),a("code",[t._v("useBuiltIns:'usage'")]),t._v(", "),a("code",[t._v("import '@babel/polyfill';")]),t._v("会自动被引入")]),t._v(" "),a("p",[t._v("而且可以采用合适的方法来减少体积")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n\t\t\ttest: /\\.js$/,\n\t\t\texclude:/node_modules/,\n\t\t\tloader:"babel-loader",\n\t\t\toptions:{\n\t\t\t\tpresets:[["@babel/preset-env",\n\t\t\t\t\t{\n\t\t\t\t\t\ttargets: {\n\t\t\t\t\t\tchrome: "67",//目标浏览器版本\n\t\t\t\t\t\t\n\t\t\t\t\t  },\n\t\t\t\t\tuseBuiltIns:\'usage\',//使用了哪些ES6语法然后只转换用到的ES6\n\t\t\t\t\t}\n\t\t\t\t]]\n\t\t\t}\n\t\t},\t\n')])])]),a("h2",{attrs:{id:"另外一种方法-不污染全局"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#另外一种方法-不污染全局"}},[t._v("#")]),t._v(" 另外一种方法 不污染全局")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cnpm install --save-dev @babel/plugin-transform-runtime\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cnpm install --save @babel/runtime\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cnpm install --save @babel/runtime-corejs2\n//如果设置corejs为2时需要安装\n")])])]),a("h2",{attrs:{id:"babelrc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babelrc"}},[t._v("#")]),t._v(" .babelrc")]),t._v(" "),a("p",[t._v("可把options里的配置单独抽出来放在.babelrc 中")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n\t\t\ttest: /\\.js$/,\n\t\t\texclude:/node_modules/,\n\t\t\tloader:"babel-loader",\n\t\t\t\n\t\t},\t\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('{\n\t"plugins": [["@babel/plugin-transform-runtime",{\n\t\t "corejs": 2,\n\t\t"helpers": true,\n\t\t"regenerator": true,\n\t\t"useESModules": false\n\t}]]\n} \n\n')])])])])}),[],!1,null,null,null);s.default=r.exports}}]);