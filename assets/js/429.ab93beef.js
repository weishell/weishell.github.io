(window.webpackJsonp=window.webpackJsonp||[]).push([[429],{831:function(s,t,a){"use strict";a.r(t);var e=a(16),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"vite"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vite"}},[s._v("#")]),s._v(" vite")]),s._v(" "),t("p",[s._v("它主要由两部分组成：")]),s._v(" "),t("ul",[t("li",[s._v("一个开发服务器，它基于原生ES模块提供了丰富的内建功能，HMR的速度非常快速；")]),s._v(" "),t("li",[s._v("一套构建指令，它使用rollup打开我们的代码，并且它是预配置的，可以输出生成环境的优化过的静态资源；")])]),s._v(" "),t("p",[s._v("现代的浏览器是可以识别es module，在script标签上配置一下type即可。\n"),t("img",{attrs:{src:"/beifen/418.png"}})]),s._v(" "),t("p",[s._v("如果我们不借助于其他工具，直接使用ES Module来开发有什么问题呢？")]),s._v(" "),t("ul",[t("li",[s._v("首先，我们会发现在使用loadash时，加载了上百个模块的js代码，对于浏览器发送请求是巨大的消耗；")]),s._v(" "),t("li",[s._v("其次，我们的代码中如果有TypeScript、less、vue等代码时，浏览器并不能直接识别；")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" vite –g "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局安装")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" vite –D "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 局部安装")]),s._v("\n")])])]),t("p",[s._v("通过vite来启动项目：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("npx vite\n")])])]),t("h3",{attrs:{id:"vite对css的支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vite对css的支持"}},[s._v("#")]),s._v(" Vite对css的支持")]),s._v(" "),t("ol",[t("li",[s._v("vite可以直接支持css的处理:直接导入css即可；")]),s._v(" "),t("li",[s._v("vite可以直接支持css预处理器，比如less:\n"),t("ul",[t("li",[s._v("直接导入less；")]),s._v(" "),t("li",[s._v("之后安装less编译器；"),t("code",[s._v("npm install less -D")])])])]),s._v(" "),t("li",[s._v("vite直接支持postcss的转换：只需要安装postcss，并且配置 postcss.config.js 的配置文件即可；"),t("code",[s._v("npm install postcss postcss-preset-env -D")])])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("plugins")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postcss-preset-env"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"vite对typescript的支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vite对typescript的支持"}},[s._v("#")]),s._v(" Vite对TypeScript的支持")]),s._v(" "),t("p",[s._v("vite对TypeScript是原生支持的，它会直接使用ESBuild来完成编译：只需要直接导入即可；")]),s._v(" "),t("ol",[t("li",[s._v("如果我们查看浏览器中的请求，会发现请求的依然是ts的代码：\n"),t("ul",[t("li",[s._v("这是因为vite中的服务器Connect会对我们的请求进行转发；")]),s._v(" "),t("li",[s._v("获取ts编译后的代码，给浏览器返回，浏览器可以直接进行解析；")])])]),s._v(" "),t("li",[s._v("注意：在vite2中，已经不再使用Koa了，而是使用Connect来搭建的服务器")])]),s._v(" "),t("h3",{attrs:{id:"vite对vue提供第一优先级支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vite对vue提供第一优先级支持"}},[s._v("#")]),s._v(" vite对vue提供第一优先级支持：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Vue 3 单文件组件支持：@vitejs/plugin-vue")])]),s._v(" "),t("li",[t("p",[s._v("Vue 3 JSX 支持：@vitejs/plugin-vue-jsx")])]),s._v(" "),t("li",[t("p",[s._v("Vue 2 支持：underfin/vite-plugin-vue2")])]),s._v(" "),t("li",[t("p",[s._v("安装支持vue的插件：")])])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("cnpm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" @vitejs/plugin-vue @vue/compiler-sfc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v("\n")])])]),t("p",[s._v("vite.config.js配置")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" vue "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@vitejs/plugin-vue'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("plugins")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h3",{attrs:{id:"vite打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vite打包"}},[s._v("#")]),s._v(" vite打包")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"serve"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vite"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//本地服务")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"build"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vite build"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//打包")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"preview"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vite preview"')]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//打包预览")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])])]),t("p",[s._v("vite基于ESBuild进行构建打包，速度非常快")]),s._v(" "),t("p",[s._v("为什么这么快 ？")]),s._v(" "),t("ul",[t("li",[s._v("js是单线程串行，esbuild是新开一个进程，然后多线程并行，充分发挥多核优势")]),s._v(" "),t("li",[s._v("esbuild是go开发的，go是纯机器码，肯定要比JIT快")]),s._v(" "),t("li",[s._v("不使用 AST，优化了构建流程。")])]),s._v(" "),t("h3",{attrs:{id:"vite脚手架"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vite脚手架"}},[s._v("#")]),s._v(" vite脚手架")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init @vitejs/app\n")])])]),t("p",[s._v("<===>")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm install @vitejs/create-app -g\ncreate-app\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);