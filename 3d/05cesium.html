<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基于开源项目cesium进行梳理 | web</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/logo.jpg">
    <meta name="description" content="welcome">
    
    <link rel="preload" href="/assets/css/0.styles.0e6b2fb9.css" as="style"><link rel="preload" href="/assets/js/app.50fceeca.js" as="script"><link rel="preload" href="/assets/js/2.f1eac84e.js" as="script"><link rel="preload" href="/assets/js/1.51fb246a.js" as="script"><link rel="preload" href="/assets/js/50.869f41c3.js" as="script"><link rel="preload" href="/assets/js/24.8b250b82.js" as="script"><link rel="prefetch" href="/assets/js/10.91f962c9.js"><link rel="prefetch" href="/assets/js/100.2630a1a8.js"><link rel="prefetch" href="/assets/js/101.69bf1402.js"><link rel="prefetch" href="/assets/js/102.da97a916.js"><link rel="prefetch" href="/assets/js/103.7fc06708.js"><link rel="prefetch" href="/assets/js/104.a49444ad.js"><link rel="prefetch" href="/assets/js/105.7f7acca0.js"><link rel="prefetch" href="/assets/js/106.f4de82ab.js"><link rel="prefetch" href="/assets/js/107.ae9a4e4a.js"><link rel="prefetch" href="/assets/js/108.aecfc7bd.js"><link rel="prefetch" href="/assets/js/109.75ec487a.js"><link rel="prefetch" href="/assets/js/11.1e3ddc53.js"><link rel="prefetch" href="/assets/js/110.13db711c.js"><link rel="prefetch" href="/assets/js/111.c218ff75.js"><link rel="prefetch" href="/assets/js/112.062326e5.js"><link rel="prefetch" href="/assets/js/113.8076797e.js"><link rel="prefetch" href="/assets/js/114.934e11cd.js"><link rel="prefetch" href="/assets/js/115.df0b5b00.js"><link rel="prefetch" href="/assets/js/116.7a3a363a.js"><link rel="prefetch" href="/assets/js/117.d64f57dc.js"><link rel="prefetch" href="/assets/js/118.d8f531f9.js"><link rel="prefetch" href="/assets/js/119.f338d2e0.js"><link rel="prefetch" href="/assets/js/12.e844f844.js"><link rel="prefetch" href="/assets/js/120.47a74714.js"><link rel="prefetch" href="/assets/js/121.8a3a4a52.js"><link rel="prefetch" href="/assets/js/122.e526997b.js"><link rel="prefetch" href="/assets/js/123.71b289bb.js"><link rel="prefetch" href="/assets/js/124.b7ac31d2.js"><link rel="prefetch" href="/assets/js/125.8d3ee534.js"><link rel="prefetch" href="/assets/js/126.9a89bdb8.js"><link rel="prefetch" href="/assets/js/127.74c716e7.js"><link rel="prefetch" href="/assets/js/128.c514d875.js"><link rel="prefetch" href="/assets/js/129.0af5fb5b.js"><link rel="prefetch" href="/assets/js/13.43971db2.js"><link rel="prefetch" href="/assets/js/130.04fc8ac0.js"><link rel="prefetch" href="/assets/js/131.01446d0d.js"><link rel="prefetch" href="/assets/js/132.d6189876.js"><link rel="prefetch" href="/assets/js/133.6477c410.js"><link rel="prefetch" href="/assets/js/134.3006c0e7.js"><link rel="prefetch" href="/assets/js/135.5a0506b0.js"><link rel="prefetch" href="/assets/js/136.eb7a12ec.js"><link rel="prefetch" href="/assets/js/137.06206dc7.js"><link rel="prefetch" href="/assets/js/138.44bd743d.js"><link rel="prefetch" href="/assets/js/139.2725a186.js"><link rel="prefetch" href="/assets/js/14.5fc851b9.js"><link rel="prefetch" href="/assets/js/140.1829cc8b.js"><link rel="prefetch" href="/assets/js/141.897145ac.js"><link rel="prefetch" href="/assets/js/142.c42b3c02.js"><link rel="prefetch" href="/assets/js/143.2c763cff.js"><link rel="prefetch" href="/assets/js/144.53dab8c3.js"><link rel="prefetch" href="/assets/js/145.eb1e874c.js"><link rel="prefetch" href="/assets/js/146.c6f3b54a.js"><link rel="prefetch" href="/assets/js/147.d48de868.js"><link rel="prefetch" href="/assets/js/148.237ee172.js"><link rel="prefetch" href="/assets/js/149.2ae1ac92.js"><link rel="prefetch" href="/assets/js/15.42ceb2eb.js"><link rel="prefetch" href="/assets/js/150.fffd4a36.js"><link rel="prefetch" href="/assets/js/151.8f13777a.js"><link rel="prefetch" href="/assets/js/152.59f4edfb.js"><link rel="prefetch" href="/assets/js/153.7e289da0.js"><link rel="prefetch" href="/assets/js/154.8b9052db.js"><link rel="prefetch" href="/assets/js/155.5dc03f0e.js"><link rel="prefetch" href="/assets/js/156.d89696e4.js"><link rel="prefetch" href="/assets/js/157.c8e66fd9.js"><link rel="prefetch" href="/assets/js/158.a7cd3bf6.js"><link rel="prefetch" href="/assets/js/159.6c292989.js"><link rel="prefetch" href="/assets/js/16.fa4a9a28.js"><link rel="prefetch" href="/assets/js/160.beb94709.js"><link rel="prefetch" href="/assets/js/161.49158b03.js"><link rel="prefetch" href="/assets/js/162.10ceca64.js"><link rel="prefetch" href="/assets/js/163.797d3f34.js"><link rel="prefetch" href="/assets/js/164.72fd07f8.js"><link rel="prefetch" href="/assets/js/165.50911328.js"><link rel="prefetch" href="/assets/js/166.68c7d557.js"><link rel="prefetch" href="/assets/js/167.b09a3d3e.js"><link rel="prefetch" href="/assets/js/168.00b08c12.js"><link rel="prefetch" href="/assets/js/169.f2468059.js"><link rel="prefetch" href="/assets/js/17.bbbe20c1.js"><link rel="prefetch" href="/assets/js/170.76d44a0d.js"><link rel="prefetch" href="/assets/js/171.37611a12.js"><link rel="prefetch" href="/assets/js/172.b91fe422.js"><link rel="prefetch" href="/assets/js/173.16b17aef.js"><link rel="prefetch" href="/assets/js/174.aaea6c55.js"><link rel="prefetch" href="/assets/js/175.f18a8823.js"><link rel="prefetch" href="/assets/js/176.109caf8d.js"><link rel="prefetch" href="/assets/js/177.c2778edf.js"><link rel="prefetch" href="/assets/js/178.47eb8fe9.js"><link rel="prefetch" href="/assets/js/179.27e63163.js"><link rel="prefetch" href="/assets/js/18.f63ba919.js"><link rel="prefetch" href="/assets/js/180.6dc4e9d6.js"><link rel="prefetch" href="/assets/js/181.2cf00de0.js"><link rel="prefetch" href="/assets/js/182.a43c93aa.js"><link rel="prefetch" href="/assets/js/183.6e8c8529.js"><link rel="prefetch" href="/assets/js/184.4181fe79.js"><link rel="prefetch" href="/assets/js/185.db268c11.js"><link rel="prefetch" href="/assets/js/186.050b4f1c.js"><link rel="prefetch" href="/assets/js/187.86d7b399.js"><link rel="prefetch" href="/assets/js/188.362f96e8.js"><link rel="prefetch" href="/assets/js/189.534a2632.js"><link rel="prefetch" href="/assets/js/19.4d1ed0cc.js"><link rel="prefetch" href="/assets/js/190.7562aefa.js"><link rel="prefetch" href="/assets/js/191.6b62f78d.js"><link rel="prefetch" href="/assets/js/192.6b17b00c.js"><link rel="prefetch" href="/assets/js/193.3373c66b.js"><link rel="prefetch" href="/assets/js/194.8f086961.js"><link rel="prefetch" href="/assets/js/195.5198a157.js"><link rel="prefetch" href="/assets/js/196.e8415e07.js"><link rel="prefetch" href="/assets/js/197.121c467f.js"><link rel="prefetch" href="/assets/js/198.b1f89d18.js"><link rel="prefetch" href="/assets/js/199.4c5ca763.js"><link rel="prefetch" href="/assets/js/20.ba2395ea.js"><link rel="prefetch" href="/assets/js/200.43ed1d26.js"><link rel="prefetch" href="/assets/js/201.da17a820.js"><link rel="prefetch" href="/assets/js/202.798fa633.js"><link rel="prefetch" href="/assets/js/203.dc4bd102.js"><link rel="prefetch" href="/assets/js/204.a3065440.js"><link rel="prefetch" href="/assets/js/205.546dd4dd.js"><link rel="prefetch" href="/assets/js/206.cc5b0139.js"><link rel="prefetch" href="/assets/js/207.0a815930.js"><link rel="prefetch" href="/assets/js/208.01d39781.js"><link rel="prefetch" href="/assets/js/209.b5d4f70b.js"><link rel="prefetch" href="/assets/js/21.57d0347e.js"><link rel="prefetch" href="/assets/js/210.0b9efba5.js"><link rel="prefetch" href="/assets/js/211.3e3ae63d.js"><link rel="prefetch" href="/assets/js/212.8d4a6f05.js"><link rel="prefetch" href="/assets/js/213.50a57265.js"><link rel="prefetch" href="/assets/js/214.b81bb38d.js"><link rel="prefetch" href="/assets/js/215.0633a2a5.js"><link rel="prefetch" href="/assets/js/216.186333c1.js"><link rel="prefetch" href="/assets/js/217.aab59aab.js"><link rel="prefetch" href="/assets/js/218.7ba8bb4d.js"><link rel="prefetch" href="/assets/js/219.a893ce9f.js"><link rel="prefetch" href="/assets/js/22.6efb638c.js"><link rel="prefetch" href="/assets/js/220.6e9ae1bf.js"><link rel="prefetch" href="/assets/js/221.89901690.js"><link rel="prefetch" href="/assets/js/222.db5ab1b0.js"><link rel="prefetch" href="/assets/js/223.f4c4523d.js"><link rel="prefetch" href="/assets/js/224.918a95e7.js"><link rel="prefetch" href="/assets/js/225.3878f243.js"><link rel="prefetch" href="/assets/js/226.18a4dd50.js"><link rel="prefetch" href="/assets/js/227.6dd6ade3.js"><link rel="prefetch" href="/assets/js/228.9f0a9515.js"><link rel="prefetch" href="/assets/js/229.ce8d0658.js"><link rel="prefetch" href="/assets/js/23.136d09c5.js"><link rel="prefetch" href="/assets/js/230.63d7e3a4.js"><link rel="prefetch" href="/assets/js/231.82403deb.js"><link rel="prefetch" href="/assets/js/232.c6e81867.js"><link rel="prefetch" href="/assets/js/233.abcb2f2e.js"><link rel="prefetch" href="/assets/js/234.ff4615b0.js"><link rel="prefetch" href="/assets/js/235.6692d224.js"><link rel="prefetch" href="/assets/js/236.8f89e483.js"><link rel="prefetch" href="/assets/js/237.be0f60f7.js"><link rel="prefetch" href="/assets/js/238.7f48e696.js"><link rel="prefetch" href="/assets/js/239.c2d8d7c7.js"><link rel="prefetch" href="/assets/js/240.a4aa5c3f.js"><link rel="prefetch" href="/assets/js/241.4124804c.js"><link rel="prefetch" href="/assets/js/242.108276cd.js"><link rel="prefetch" href="/assets/js/243.5e3b188e.js"><link rel="prefetch" href="/assets/js/244.fbfb3266.js"><link rel="prefetch" href="/assets/js/245.dd49ed44.js"><link rel="prefetch" href="/assets/js/246.2ed90c28.js"><link rel="prefetch" href="/assets/js/247.e0772aeb.js"><link rel="prefetch" href="/assets/js/248.68e4d5b7.js"><link rel="prefetch" href="/assets/js/249.6b58061a.js"><link rel="prefetch" href="/assets/js/25.bd17373c.js"><link rel="prefetch" href="/assets/js/250.3eaeb629.js"><link rel="prefetch" href="/assets/js/251.b9a70d84.js"><link rel="prefetch" href="/assets/js/252.99039099.js"><link rel="prefetch" href="/assets/js/253.cfec13d7.js"><link rel="prefetch" href="/assets/js/254.b29d69c8.js"><link rel="prefetch" href="/assets/js/255.16d5bcbf.js"><link rel="prefetch" href="/assets/js/256.59405188.js"><link rel="prefetch" href="/assets/js/257.22ce508d.js"><link rel="prefetch" href="/assets/js/258.3c68719b.js"><link rel="prefetch" href="/assets/js/259.c562130f.js"><link rel="prefetch" href="/assets/js/26.055a3567.js"><link rel="prefetch" href="/assets/js/260.623761f5.js"><link rel="prefetch" href="/assets/js/261.ed9847ee.js"><link rel="prefetch" href="/assets/js/262.4f2bceb8.js"><link rel="prefetch" href="/assets/js/263.12899d6e.js"><link rel="prefetch" href="/assets/js/264.41ff2ff6.js"><link rel="prefetch" href="/assets/js/265.2a7a5968.js"><link rel="prefetch" href="/assets/js/266.33929c8f.js"><link rel="prefetch" href="/assets/js/267.9b544040.js"><link rel="prefetch" href="/assets/js/268.8b0a675d.js"><link rel="prefetch" href="/assets/js/269.109b88d8.js"><link rel="prefetch" href="/assets/js/27.c4579098.js"><link rel="prefetch" href="/assets/js/270.fac8139a.js"><link rel="prefetch" href="/assets/js/271.87517fe6.js"><link rel="prefetch" href="/assets/js/272.929a75cd.js"><link rel="prefetch" href="/assets/js/273.866716ea.js"><link rel="prefetch" href="/assets/js/274.539e0a60.js"><link rel="prefetch" href="/assets/js/275.907a7b79.js"><link rel="prefetch" href="/assets/js/276.f9110f5c.js"><link rel="prefetch" href="/assets/js/277.1074dd31.js"><link rel="prefetch" href="/assets/js/278.cd661ad8.js"><link rel="prefetch" href="/assets/js/279.326834ff.js"><link rel="prefetch" href="/assets/js/28.8fec340e.js"><link rel="prefetch" href="/assets/js/280.90d31d44.js"><link rel="prefetch" href="/assets/js/281.b0cad2fd.js"><link rel="prefetch" href="/assets/js/282.b69ed6f5.js"><link rel="prefetch" href="/assets/js/283.82fc9d19.js"><link rel="prefetch" href="/assets/js/284.e4153d5a.js"><link rel="prefetch" href="/assets/js/285.4bee22bf.js"><link rel="prefetch" href="/assets/js/286.32368004.js"><link rel="prefetch" href="/assets/js/287.20431320.js"><link rel="prefetch" href="/assets/js/288.a28b59f4.js"><link rel="prefetch" href="/assets/js/289.4824183e.js"><link rel="prefetch" href="/assets/js/29.5b7c6405.js"><link rel="prefetch" href="/assets/js/290.42ffb30a.js"><link rel="prefetch" href="/assets/js/291.5ad073bd.js"><link rel="prefetch" href="/assets/js/292.6c14e58d.js"><link rel="prefetch" href="/assets/js/293.f8099bde.js"><link rel="prefetch" href="/assets/js/294.4b2f4f29.js"><link rel="prefetch" href="/assets/js/295.851cc9ea.js"><link rel="prefetch" href="/assets/js/296.5ea37551.js"><link rel="prefetch" href="/assets/js/297.5a8a080c.js"><link rel="prefetch" href="/assets/js/298.70484e6c.js"><link rel="prefetch" href="/assets/js/299.21865692.js"><link rel="prefetch" href="/assets/js/3.dcf84505.js"><link rel="prefetch" href="/assets/js/30.d0408706.js"><link rel="prefetch" href="/assets/js/300.f90dd77c.js"><link rel="prefetch" href="/assets/js/301.51276ab0.js"><link rel="prefetch" href="/assets/js/302.2de6360c.js"><link rel="prefetch" href="/assets/js/303.709c6dd1.js"><link rel="prefetch" href="/assets/js/304.5523586f.js"><link rel="prefetch" href="/assets/js/305.23b45952.js"><link rel="prefetch" href="/assets/js/306.3e7c23d8.js"><link rel="prefetch" href="/assets/js/307.d984b5b6.js"><link rel="prefetch" href="/assets/js/308.af57c70f.js"><link rel="prefetch" href="/assets/js/309.74e87741.js"><link rel="prefetch" href="/assets/js/31.4482053d.js"><link rel="prefetch" href="/assets/js/310.f1b6f8c8.js"><link rel="prefetch" href="/assets/js/311.85b91931.js"><link rel="prefetch" href="/assets/js/312.a45cf85d.js"><link rel="prefetch" href="/assets/js/313.f8f16fbf.js"><link rel="prefetch" href="/assets/js/314.8a3b42ef.js"><link rel="prefetch" href="/assets/js/315.929d58b0.js"><link rel="prefetch" href="/assets/js/316.6a17b1d6.js"><link rel="prefetch" href="/assets/js/317.bc100e54.js"><link rel="prefetch" href="/assets/js/318.29b3381f.js"><link rel="prefetch" href="/assets/js/319.5db67ba4.js"><link rel="prefetch" href="/assets/js/32.fd0dc55b.js"><link rel="prefetch" href="/assets/js/320.900de4bd.js"><link rel="prefetch" href="/assets/js/321.f03b75e4.js"><link rel="prefetch" href="/assets/js/322.1873897a.js"><link rel="prefetch" href="/assets/js/323.1701aa7a.js"><link rel="prefetch" href="/assets/js/324.a29aa3cf.js"><link rel="prefetch" href="/assets/js/325.f26694ca.js"><link rel="prefetch" href="/assets/js/326.2d35c091.js"><link rel="prefetch" href="/assets/js/327.3d9cda33.js"><link rel="prefetch" href="/assets/js/328.0d17a279.js"><link rel="prefetch" href="/assets/js/329.60a91e23.js"><link rel="prefetch" href="/assets/js/33.c5d56b18.js"><link rel="prefetch" href="/assets/js/330.834ac75e.js"><link rel="prefetch" href="/assets/js/331.db43d168.js"><link rel="prefetch" href="/assets/js/332.34ef83aa.js"><link rel="prefetch" href="/assets/js/333.3b9286e5.js"><link rel="prefetch" href="/assets/js/334.b3b61c9c.js"><link rel="prefetch" href="/assets/js/335.0a991579.js"><link rel="prefetch" href="/assets/js/336.89658ed8.js"><link rel="prefetch" href="/assets/js/337.4fb6af7e.js"><link rel="prefetch" href="/assets/js/338.d05af605.js"><link rel="prefetch" href="/assets/js/339.93e84ede.js"><link rel="prefetch" href="/assets/js/34.fc41c015.js"><link rel="prefetch" href="/assets/js/340.9d1da81b.js"><link rel="prefetch" href="/assets/js/341.4d7a99cc.js"><link rel="prefetch" href="/assets/js/342.76393522.js"><link rel="prefetch" href="/assets/js/343.06790698.js"><link rel="prefetch" href="/assets/js/344.f0411fd7.js"><link rel="prefetch" href="/assets/js/345.7bef6236.js"><link rel="prefetch" href="/assets/js/346.42a9de73.js"><link rel="prefetch" href="/assets/js/347.d8221b95.js"><link rel="prefetch" href="/assets/js/348.ffbaee74.js"><link rel="prefetch" href="/assets/js/349.3d69febd.js"><link rel="prefetch" href="/assets/js/35.8b711368.js"><link rel="prefetch" href="/assets/js/350.4f121130.js"><link rel="prefetch" href="/assets/js/351.6e877938.js"><link rel="prefetch" href="/assets/js/352.07f1f0e2.js"><link rel="prefetch" href="/assets/js/353.94cc4ddb.js"><link rel="prefetch" href="/assets/js/354.9c1660c9.js"><link rel="prefetch" href="/assets/js/355.065cfb3c.js"><link rel="prefetch" href="/assets/js/356.156fcda9.js"><link rel="prefetch" href="/assets/js/357.cf430155.js"><link rel="prefetch" href="/assets/js/358.85e687d5.js"><link rel="prefetch" href="/assets/js/359.b8b4cf18.js"><link rel="prefetch" href="/assets/js/36.6f3dbb4d.js"><link rel="prefetch" href="/assets/js/360.f9e5467c.js"><link rel="prefetch" href="/assets/js/361.c6eca99d.js"><link rel="prefetch" href="/assets/js/362.50f8a7ea.js"><link rel="prefetch" href="/assets/js/363.a708a0c6.js"><link rel="prefetch" href="/assets/js/364.13c60e42.js"><link rel="prefetch" href="/assets/js/365.118f0713.js"><link rel="prefetch" href="/assets/js/366.2b2d59e6.js"><link rel="prefetch" href="/assets/js/367.309bbe46.js"><link rel="prefetch" href="/assets/js/368.5eb7ab16.js"><link rel="prefetch" href="/assets/js/369.f7f6dc89.js"><link rel="prefetch" href="/assets/js/37.fde0ad27.js"><link rel="prefetch" href="/assets/js/370.34e69d2f.js"><link rel="prefetch" href="/assets/js/371.1eeaa425.js"><link rel="prefetch" href="/assets/js/372.0c5fe9e8.js"><link rel="prefetch" href="/assets/js/373.83d67199.js"><link rel="prefetch" href="/assets/js/374.1302d7d1.js"><link rel="prefetch" href="/assets/js/375.c9f2bbcd.js"><link rel="prefetch" href="/assets/js/376.2f845a6d.js"><link rel="prefetch" href="/assets/js/377.a61275c6.js"><link rel="prefetch" href="/assets/js/378.5aa3b35b.js"><link rel="prefetch" href="/assets/js/379.0f0c47a3.js"><link rel="prefetch" href="/assets/js/38.f2e30d45.js"><link rel="prefetch" href="/assets/js/380.91d6d08a.js"><link rel="prefetch" href="/assets/js/381.1d666059.js"><link rel="prefetch" href="/assets/js/382.91e41c2f.js"><link rel="prefetch" href="/assets/js/383.0b23f384.js"><link rel="prefetch" href="/assets/js/384.64d2dda3.js"><link rel="prefetch" href="/assets/js/385.b9f1932b.js"><link rel="prefetch" href="/assets/js/386.0b59fb94.js"><link rel="prefetch" href="/assets/js/387.669b83dc.js"><link rel="prefetch" href="/assets/js/388.27532a60.js"><link rel="prefetch" href="/assets/js/389.edc87724.js"><link rel="prefetch" href="/assets/js/39.a9095fe8.js"><link rel="prefetch" href="/assets/js/390.ff3af376.js"><link rel="prefetch" href="/assets/js/391.e3c971a1.js"><link rel="prefetch" href="/assets/js/392.bdeef45e.js"><link rel="prefetch" href="/assets/js/393.f286fad0.js"><link rel="prefetch" href="/assets/js/394.204878a1.js"><link rel="prefetch" href="/assets/js/395.b0cd40c9.js"><link rel="prefetch" href="/assets/js/396.6b692976.js"><link rel="prefetch" href="/assets/js/397.45148099.js"><link rel="prefetch" href="/assets/js/398.5d4956f6.js"><link rel="prefetch" href="/assets/js/399.094321a5.js"><link rel="prefetch" href="/assets/js/4.84c7e22e.js"><link rel="prefetch" href="/assets/js/40.ff6c5ea3.js"><link rel="prefetch" href="/assets/js/400.5f6c8c27.js"><link rel="prefetch" href="/assets/js/401.cd403324.js"><link rel="prefetch" href="/assets/js/402.0deb3aea.js"><link rel="prefetch" href="/assets/js/403.62d55ce6.js"><link rel="prefetch" href="/assets/js/404.0fc755f3.js"><link rel="prefetch" href="/assets/js/405.e89b66dc.js"><link rel="prefetch" href="/assets/js/406.2eb178df.js"><link rel="prefetch" href="/assets/js/407.4fe90b70.js"><link rel="prefetch" href="/assets/js/408.2fdd6ec5.js"><link rel="prefetch" href="/assets/js/409.b3bd033d.js"><link rel="prefetch" href="/assets/js/41.47bec4ee.js"><link rel="prefetch" href="/assets/js/410.278dedfb.js"><link rel="prefetch" href="/assets/js/411.f0244a1e.js"><link rel="prefetch" href="/assets/js/412.833ae40f.js"><link rel="prefetch" href="/assets/js/413.0467c992.js"><link rel="prefetch" href="/assets/js/414.b46727d2.js"><link rel="prefetch" href="/assets/js/415.14bf9567.js"><link rel="prefetch" href="/assets/js/416.ca07b2fc.js"><link rel="prefetch" href="/assets/js/417.67263a7f.js"><link rel="prefetch" href="/assets/js/418.12ce44d1.js"><link rel="prefetch" href="/assets/js/419.b6dd197c.js"><link rel="prefetch" href="/assets/js/42.ebe16e2c.js"><link rel="prefetch" href="/assets/js/420.e91c6e20.js"><link rel="prefetch" href="/assets/js/421.70fe463a.js"><link rel="prefetch" href="/assets/js/422.01516b93.js"><link rel="prefetch" href="/assets/js/423.4ae5dfae.js"><link rel="prefetch" href="/assets/js/424.054f47c4.js"><link rel="prefetch" href="/assets/js/425.b58f7785.js"><link rel="prefetch" href="/assets/js/426.e69c1dc4.js"><link rel="prefetch" href="/assets/js/427.ea80ba09.js"><link rel="prefetch" href="/assets/js/428.a748e536.js"><link rel="prefetch" href="/assets/js/429.d3fcbffb.js"><link rel="prefetch" href="/assets/js/43.0b0dce44.js"><link rel="prefetch" href="/assets/js/430.41bc30b0.js"><link rel="prefetch" href="/assets/js/431.9b2f1b09.js"><link rel="prefetch" href="/assets/js/432.9ac2d0a8.js"><link rel="prefetch" href="/assets/js/433.30ed04c9.js"><link rel="prefetch" href="/assets/js/434.b440320c.js"><link rel="prefetch" href="/assets/js/435.c02fc0f9.js"><link rel="prefetch" href="/assets/js/436.33f64229.js"><link rel="prefetch" href="/assets/js/437.a32d2cda.js"><link rel="prefetch" href="/assets/js/438.322cd7b7.js"><link rel="prefetch" href="/assets/js/439.1d89b304.js"><link rel="prefetch" href="/assets/js/44.c846b4a3.js"><link rel="prefetch" href="/assets/js/440.68cfc80f.js"><link rel="prefetch" href="/assets/js/441.bbed7442.js"><link rel="prefetch" href="/assets/js/442.6186ee7d.js"><link rel="prefetch" href="/assets/js/443.7f5e75c6.js"><link rel="prefetch" href="/assets/js/444.8289518f.js"><link rel="prefetch" href="/assets/js/445.4ef1e2bb.js"><link rel="prefetch" href="/assets/js/446.589d3c1b.js"><link rel="prefetch" href="/assets/js/447.b8ba835e.js"><link rel="prefetch" href="/assets/js/448.6bb34b86.js"><link rel="prefetch" href="/assets/js/449.2db80285.js"><link rel="prefetch" href="/assets/js/45.b354c95c.js"><link rel="prefetch" href="/assets/js/450.da5798f9.js"><link rel="prefetch" href="/assets/js/451.0e2fb1b5.js"><link rel="prefetch" href="/assets/js/452.48068501.js"><link rel="prefetch" href="/assets/js/453.38655943.js"><link rel="prefetch" href="/assets/js/454.f9b83381.js"><link rel="prefetch" href="/assets/js/455.b533a4b8.js"><link rel="prefetch" href="/assets/js/456.d7e83bc4.js"><link rel="prefetch" href="/assets/js/457.4347338c.js"><link rel="prefetch" href="/assets/js/458.e4df51d1.js"><link rel="prefetch" href="/assets/js/459.40e35cbb.js"><link rel="prefetch" href="/assets/js/46.c1a98c24.js"><link rel="prefetch" href="/assets/js/460.d8b7b8c5.js"><link rel="prefetch" href="/assets/js/461.f90e1ace.js"><link rel="prefetch" href="/assets/js/462.496a7582.js"><link rel="prefetch" href="/assets/js/463.89c273d9.js"><link rel="prefetch" href="/assets/js/464.5a01908d.js"><link rel="prefetch" href="/assets/js/465.4774b415.js"><link rel="prefetch" href="/assets/js/466.33642ff4.js"><link rel="prefetch" href="/assets/js/467.53400303.js"><link rel="prefetch" href="/assets/js/468.0cb60e82.js"><link rel="prefetch" href="/assets/js/469.7403f2a6.js"><link rel="prefetch" href="/assets/js/47.72f49fec.js"><link rel="prefetch" href="/assets/js/470.0930909e.js"><link rel="prefetch" href="/assets/js/471.80f79a7b.js"><link rel="prefetch" href="/assets/js/472.e70c33a1.js"><link rel="prefetch" href="/assets/js/473.a211f70d.js"><link rel="prefetch" href="/assets/js/474.e44b8791.js"><link rel="prefetch" href="/assets/js/475.c4714611.js"><link rel="prefetch" href="/assets/js/476.de306266.js"><link rel="prefetch" href="/assets/js/477.189be0eb.js"><link rel="prefetch" href="/assets/js/478.b9e19783.js"><link rel="prefetch" href="/assets/js/479.59cc3a5b.js"><link rel="prefetch" href="/assets/js/48.97b15f27.js"><link rel="prefetch" href="/assets/js/480.ab2c1ba7.js"><link rel="prefetch" href="/assets/js/481.cf8c0d17.js"><link rel="prefetch" href="/assets/js/482.e4be8c0a.js"><link rel="prefetch" href="/assets/js/483.e87987dd.js"><link rel="prefetch" href="/assets/js/484.e2c3ba00.js"><link rel="prefetch" href="/assets/js/485.e5a6ddd8.js"><link rel="prefetch" href="/assets/js/486.0534acd5.js"><link rel="prefetch" href="/assets/js/487.19cd421f.js"><link rel="prefetch" href="/assets/js/488.329707d7.js"><link rel="prefetch" href="/assets/js/489.669500d0.js"><link rel="prefetch" href="/assets/js/49.2d947248.js"><link rel="prefetch" href="/assets/js/490.423aaeec.js"><link rel="prefetch" href="/assets/js/491.67d3b747.js"><link rel="prefetch" href="/assets/js/492.605dc055.js"><link rel="prefetch" href="/assets/js/493.f3c30966.js"><link rel="prefetch" href="/assets/js/494.abc1e7db.js"><link rel="prefetch" href="/assets/js/495.4bbfa933.js"><link rel="prefetch" href="/assets/js/496.09bcea65.js"><link rel="prefetch" href="/assets/js/497.c20608e4.js"><link rel="prefetch" href="/assets/js/498.db55c5da.js"><link rel="prefetch" href="/assets/js/499.393535bd.js"><link rel="prefetch" href="/assets/js/5.92e410ee.js"><link rel="prefetch" href="/assets/js/51.3a3dee7c.js"><link rel="prefetch" href="/assets/js/52.ce5ac8a7.js"><link rel="prefetch" href="/assets/js/53.049d92c0.js"><link rel="prefetch" href="/assets/js/54.3064d10c.js"><link rel="prefetch" href="/assets/js/55.1a8d935e.js"><link rel="prefetch" href="/assets/js/56.2e8abb19.js"><link rel="prefetch" href="/assets/js/57.9651c9c5.js"><link rel="prefetch" href="/assets/js/58.694fc053.js"><link rel="prefetch" href="/assets/js/59.9cee6154.js"><link rel="prefetch" href="/assets/js/6.27ad90f1.js"><link rel="prefetch" href="/assets/js/60.39c8d65d.js"><link rel="prefetch" href="/assets/js/61.d9f6d8c5.js"><link rel="prefetch" href="/assets/js/62.026ae079.js"><link rel="prefetch" href="/assets/js/63.996d7884.js"><link rel="prefetch" href="/assets/js/64.02722493.js"><link rel="prefetch" href="/assets/js/65.40a511a7.js"><link rel="prefetch" href="/assets/js/66.50753c26.js"><link rel="prefetch" href="/assets/js/67.48caeb7f.js"><link rel="prefetch" href="/assets/js/68.907c4600.js"><link rel="prefetch" href="/assets/js/69.d9dc4865.js"><link rel="prefetch" href="/assets/js/7.25563a7a.js"><link rel="prefetch" href="/assets/js/70.a20901b1.js"><link rel="prefetch" href="/assets/js/71.480a7639.js"><link rel="prefetch" href="/assets/js/72.cb7face8.js"><link rel="prefetch" href="/assets/js/73.e37b53f7.js"><link rel="prefetch" href="/assets/js/74.d7eebeea.js"><link rel="prefetch" href="/assets/js/75.b1d9af30.js"><link rel="prefetch" href="/assets/js/76.46da0799.js"><link rel="prefetch" href="/assets/js/77.41a069e9.js"><link rel="prefetch" href="/assets/js/78.be3987ca.js"><link rel="prefetch" href="/assets/js/79.5805d4fb.js"><link rel="prefetch" href="/assets/js/80.4ac6fa1a.js"><link rel="prefetch" href="/assets/js/81.231637ef.js"><link rel="prefetch" href="/assets/js/82.42a1eb8e.js"><link rel="prefetch" href="/assets/js/83.5cd3a531.js"><link rel="prefetch" href="/assets/js/84.38cfa772.js"><link rel="prefetch" href="/assets/js/85.44024ac9.js"><link rel="prefetch" href="/assets/js/86.e20cb649.js"><link rel="prefetch" href="/assets/js/87.ed93a6e2.js"><link rel="prefetch" href="/assets/js/88.baccac3d.js"><link rel="prefetch" href="/assets/js/89.1416a7c3.js"><link rel="prefetch" href="/assets/js/90.44421b87.js"><link rel="prefetch" href="/assets/js/91.c06d07b1.js"><link rel="prefetch" href="/assets/js/92.321e852e.js"><link rel="prefetch" href="/assets/js/93.82dc2b63.js"><link rel="prefetch" href="/assets/js/94.eda8c9b5.js"><link rel="prefetch" href="/assets/js/95.8621956d.js"><link rel="prefetch" href="/assets/js/96.6dd1655f.js"><link rel="prefetch" href="/assets/js/97.2fa88cf6.js"><link rel="prefetch" href="/assets/js/98.84715f81.js"><link rel="prefetch" href="/assets/js/99.28eedf45.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5ecec0e5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0e6b2fb9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">web</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ajax/" class="nav-link">
  ajax
</a></li><li class="dropdown-item"><!----> <a href="/angular/" class="nav-link">
  angular
</a></li><li class="dropdown-item"><!----> <a href="/3d/" class="nav-link router-link-active">
  3d
</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">
  basic
</a></li><li class="dropdown-item"><!----> <a href="/canvas/" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/chart/" class="nav-link">
  chart
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/d3/" class="nav-link">
  d3
</a></li><li class="dropdown-item"><!----> <a href="/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/fast/" class="nav-link">
  fast
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/" class="nav-link">
  htmlcss
</a></li><li class="dropdown-item"><!----> <a href="/jsstore/" class="nav-link">
  jsstore
</a></li><li class="dropdown-item"><!----> <a href="/object/" class="nav-link">
  object
</a></li><li class="dropdown-item"><!----> <a href="/plugin/" class="nav-link">
  plugin
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/svg/" class="nav-link">
  svg
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  ssr
</a></li><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  test
</a></li><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/ui/" class="nav-link">
  ui
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/webdb/" class="nav-link">
  webdb
</a></li><li class="dropdown-item"><!----> <a href="/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/webrtc/" class="nav-link">
  webrtc
</a></li><li class="dropdown-item"><!----> <a href="/wx/" class="nav-link">
  wx
</a></li><li class="dropdown-item"><!----> <a href="/phone/" class="nav-link">
  phone
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/koa/" class="nav-link">
  koa
</a></li><li class="dropdown-item"><!----> <a href="/mongo/" class="nav-link">
  mongo
</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/http/" class="nav-link">
  http
</a></li><li class="dropdown-item"><!----> <a href="/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  other
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/mk/" class="nav-link">
  mk
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/reactnative/" class="nav-link">
  reactnative
</a></li><li class="dropdown-item"><!----> <a href="/s100/" class="nav-link">
  question
</a></li><li class="dropdown-item"><!----> <a href="/hmos/" class="nav-link">
  hmos
</a></li><li class="dropdown-item"><!----> <a href="/book/" class="nav-link">
  book
</a></li><li class="dropdown-item"><!----> <a href="/confusing/" class="nav-link">
  confusing
</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">
  tool
</a></li><li class="dropdown-item"><!----> <a href="/increase/" class="nav-link">
  increase
</a></li><li class="dropdown-item"><!----> <a href="/write/" class="nav-link">
  write
</a></li><li class="dropdown-item"><!----> <a href="/interview/" class="nav-link">
  interview
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ajax/" class="nav-link">
  ajax
</a></li><li class="dropdown-item"><!----> <a href="/angular/" class="nav-link">
  angular
</a></li><li class="dropdown-item"><!----> <a href="/3d/" class="nav-link router-link-active">
  3d
</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">
  basic
</a></li><li class="dropdown-item"><!----> <a href="/canvas/" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/chart/" class="nav-link">
  chart
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/d3/" class="nav-link">
  d3
</a></li><li class="dropdown-item"><!----> <a href="/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/fast/" class="nav-link">
  fast
</a></li><li class="dropdown-item"><!----> <a href="/htmlcss/" class="nav-link">
  htmlcss
</a></li><li class="dropdown-item"><!----> <a href="/jsstore/" class="nav-link">
  jsstore
</a></li><li class="dropdown-item"><!----> <a href="/object/" class="nav-link">
  object
</a></li><li class="dropdown-item"><!----> <a href="/plugin/" class="nav-link">
  plugin
</a></li><li class="dropdown-item"><!----> <a href="/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/svg/" class="nav-link">
  svg
</a></li><li class="dropdown-item"><!----> <a href="/ssr/" class="nav-link">
  ssr
</a></li><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  test
</a></li><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/ui/" class="nav-link">
  ui
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/webdb/" class="nav-link">
  webdb
</a></li><li class="dropdown-item"><!----> <a href="/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/webrtc/" class="nav-link">
  webrtc
</a></li><li class="dropdown-item"><!----> <a href="/wx/" class="nav-link">
  wx
</a></li><li class="dropdown-item"><!----> <a href="/phone/" class="nav-link">
  phone
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  node
</a></li><li class="dropdown-item"><!----> <a href="/koa/" class="nav-link">
  koa
</a></li><li class="dropdown-item"><!----> <a href="/mongo/" class="nav-link">
  mongo
</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/http/" class="nav-link">
  http
</a></li><li class="dropdown-item"><!----> <a href="/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  other
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  python
</a></li><li class="dropdown-item"><!----> <a href="/mk/" class="nav-link">
  mk
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/reactnative/" class="nav-link">
  reactnative
</a></li><li class="dropdown-item"><!----> <a href="/s100/" class="nav-link">
  question
</a></li><li class="dropdown-item"><!----> <a href="/hmos/" class="nav-link">
  hmos
</a></li><li class="dropdown-item"><!----> <a href="/book/" class="nav-link">
  book
</a></li><li class="dropdown-item"><!----> <a href="/confusing/" class="nav-link">
  confusing
</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">
  tool
</a></li><li class="dropdown-item"><!----> <a href="/increase/" class="nav-link">
  increase
</a></li><li class="dropdown-item"><!----> <a href="/write/" class="nav-link">
  write
</a></li><li class="dropdown-item"><!----> <a href="/interview/" class="nav-link">
  interview
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/weishell/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/3d/" aria-current="page" class="sidebar-link">3d图形</a></li><li><a href="/3d/01webgpu.html" class="sidebar-link">webgpu</a></li><li><a href="/3d/02threejs.html" class="sidebar-link">theejs项目问题合集</a></li><li><a href="/3d/03ht.html" class="sidebar-link">ht</a></li><li><a href="/3d/04cesium.html" class="sidebar-link">cesium1</a></li><li><a href="/3d/05cesium.html" aria-current="page" class="active sidebar-link">cesium2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#基于开源项目cesium进行梳理" class="sidebar-link">基于开源项目cesium进行梳理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-viewer类" class="sidebar-link">cesium Viewer类</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-viewer开发一些基本配置" class="sidebar-link">cesium Viewer开发一些基本配置</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-开启抗锯齿" class="sidebar-link">cesium 开启抗锯齿</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-zoomto" class="sidebar-link">cesium zoomTo</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-createworldterrainasync" class="sidebar-link">Cesium.createWorldTerrainAsync</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium天空盒skybox" class="sidebar-link">cesium天空盒SkyBox</a></li></ul></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium各类事件系统详解" class="sidebar-link">Cesium各类事件系统详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium事件相关" class="sidebar-link">cesium事件相关</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-实体事件" class="sidebar-link">cesium 实体事件</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-相机事件​" class="sidebar-link">cesium 相机事件​</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-键盘事件" class="sidebar-link">cesium 键盘事件</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium的四种点击拾取方法" class="sidebar-link">Cesium的四种点击拾取方法</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-defined" class="sidebar-link">Cesium.defined</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-screenspaceeventtype" class="sidebar-link">Cesium.ScreenSpaceEventType</a></li></ul></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#gis基础" class="sidebar-link">gis基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#gis坐标系​" class="sidebar-link">GIS坐标系​</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium位置计算转换" class="sidebar-link">cesium位置计算转换</a></li></ul></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-carmera方法" class="sidebar-link">cesium carmera方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-carmera-飞行模式" class="sidebar-link">cesium carmera 飞行模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium各种collection的作用和使用​" class="sidebar-link">cesium各种Collection的作用和使用​</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-entitycollection​" class="sidebar-link">cesium EntityCollection​</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-实体" class="sidebar-link">cesium 实体</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium中的geometryinstance的attributes​" class="sidebar-link">cesium中的GeometryInstance的attributes​</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-几何体外观材质类" class="sidebar-link">cesium 几何体外观材质类</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium常见的-appearance-类型​" class="sidebar-link">cesium常见的 Appearance 类型​</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium中自定义封装材质类" class="sidebar-link">cesium中自定义封装材质类</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium白模及自定义皮肤" class="sidebar-link">cesium白模及自定义皮肤</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-实体model" class="sidebar-link">cesium 实体model</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium中与图形学相关的变量和方法" class="sidebar-link">cesium中与图形学相关的变量和方法</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-广告牌" class="sidebar-link">cesium 广告牌</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-primitivecollection" class="sidebar-link">cesium PrimitiveCollection</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-boundingrectangle" class="sidebar-link">cesium BoundingRectangle</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-nearfarscalar" class="sidebar-link">Cesium.NearFarScalar</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-颜色控制" class="sidebar-link">cesium 颜色控制</a></li></ul></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-影像​图层和地形" class="sidebar-link">cesium 影像​图层和地形</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-影像图层类​" class="sidebar-link">cesium 影像图层类​</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium地形" class="sidebar-link">cesium地形</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium接入国产地图" class="sidebar-link">cesium接入国产地图</a></li></ul></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-获取数据" class="sidebar-link">cesium 获取数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium矢量数据" class="sidebar-link">cesium矢量数据</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium中使用shp" class="sidebar-link">cesium中使用shp</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium中加载3d模型" class="sidebar-link">cesium中加载3D模型</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-clock" class="sidebar-link">cesium clock</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-knockout" class="sidebar-link">Cesium.knockout</a></li><li class="sidebar-sub-header"><a href="/3d/05cesium.html#cesium-粒子系统" class="sidebar-link">cesium 粒子系统</a></li></ul></li></ul></li><li><a href="/3d/06cesium.html" class="sidebar-link">cesium3</a></li><li><a href="/3d/07cesiumAPI.html" class="sidebar-link">cesiumAPI</a></li><li><a href="/3d/08weggl.html" class="sidebar-link">webgl</a></li><li><a href="/3d/babylon1.html" class="sidebar-link">babylobjs基础</a></li><li><a href="/3d/babylon2API.html" class="sidebar-link">babylonjs API</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="基于开源项目cesium进行梳理"><a href="#基于开源项目cesium进行梳理" class="header-anchor">#</a> 基于开源项目cesium进行梳理</h2> <img src="/beifen/738.png"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 可以把这个文件直接放到我们的public，或者这样引用</span>
<span class="token keyword">import</span> <span class="token string">&quot;cesium/Build/Cesium/Widgets/widgets.css&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-viewer类"><a href="#cesium-viewer类" class="header-anchor">#</a> cesium Viewer类</h3> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> viewer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Viewer</span><span class="token punctuation">(</span><span class="token string">&quot;cesiumContainer&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">infoBox</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">timeline</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否显示时间线控件</span>
    <span class="token literal-property property">imageryProvider</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ArcGisMapServerImageryProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">terrainProvider</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CesiumTerrainProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;http://data.marsgis.cn/terrain&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// terrain: Cesium.Terrain.fromWorldTerrain({</span>
    <span class="token comment">//   requestVertexNormals: true, //Needed to visualize slope</span>
    <span class="token comment">// }),</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>infoBox :是否显示Cesium Viewer中的信息框（InfoBox）。信息框通常用于在鼠标悬停在某个实体（如地标、建筑物等）上时显示有关该实体的额外信息。将其设置为false意味着不会显示这些信息框。</li> <li>imageryProvider:用于指定地图的图像提供者
<ul><li>类 ArcGisMapServerImageryProvider (options)提供由ArcGIS MapServer托管的平铺图像。默认情况下，服务器的预缓存磁贴为使用（如果有）。</li> <li>类 UrlTemplateImageryProvider通过使用指定的URL模板请求图块来提供图像。</li></ul></li> <li>terrainProvider:用于指定地形数据的提供者</li></ul> <h3 id="cesium-viewer开发一些基本配置"><a href="#cesium-viewer开发一些基本配置" class="header-anchor">#</a> cesium Viewer开发一些基本配置</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不显示底图</span>
<span class="token comment">// viewer.imageryLayers.get(0).show = false;</span>
<span class="token comment">// 去除logo</span>
viewer<span class="token punctuation">.</span>cesiumWidget<span class="token punctuation">.</span>creditContainer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 显示帧率</span>
viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>debugShowFramesPerSecond <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>globe<span class="token punctuation">.</span>depthTestAgainstTerrain <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-开启抗锯齿"><a href="#cesium-开启抗锯齿" class="header-anchor">#</a> cesium 开启抗锯齿</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 开启抗锯齿
 */</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Cesium <span class="token keyword">from</span> <span class="token string">&quot;cesium&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">disableSawtooth</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">viewer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 是否支持图像渲染像素化处理</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Cesium<span class="token punctuation">.</span>FeatureDetection<span class="token punctuation">.</span><span class="token function">supportsImageRenderingPixelated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        viewer<span class="token punctuation">.</span>resolutionScale <span class="token operator">=</span> window<span class="token punctuation">.</span>devicePixelRatio<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 开启抗锯齿</span>
    viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>postProcessStages<span class="token punctuation">.</span>fxaa<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> disableSawtooth<span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-zoomto"><a href="#cesium-zoomto" class="header-anchor">#</a> cesium zoomTo</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 缩放视图到实体  </span>
viewer<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-createworldterrainasync"><a href="#cesium-createworldterrainasync" class="header-anchor">#</a> Cesium.createWorldTerrainAsync</h3> <p>用于异步地创建并返回一个全球地形提供者（CesiumTerrainProvider）的实例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> worldTerrainProvider <span class="token operator">=</span> <span class="token keyword">await</span> Cesium<span class="token punctuation">.</span><span class="token function">createWorldTerrainAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
viewer<span class="token punctuation">.</span>terrainProvider <span class="token operator">=</span> worldTerrainProvider<span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium天空盒skybox"><a href="#cesium天空盒skybox" class="header-anchor">#</a> cesium天空盒SkyBox</h3> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 外天空盒</span>
  viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>skyBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>SkyBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">sources</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">positiveX</span><span class="token operator">:</span> <span class="token string">&quot;/images/Standard-Cube-Map/px1.png&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">negativeX</span><span class="token operator">:</span> <span class="token string">&quot;/images/Standard-Cube-Map/nx1.png&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">positiveY</span><span class="token operator">:</span> <span class="token string">&quot;/images/Standard-Cube-Map/pz.png&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">negativeY</span><span class="token operator">:</span> <span class="token string">&quot;/images/Standard-Cube-Map/nz1.png&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">positiveZ</span><span class="token operator">:</span> <span class="token string">&quot;/images/Standard-Cube-Map/py.png&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">negativeZ</span><span class="token operator">:</span> <span class="token string">&quot;/images/Standard-Cube-Map/ny1.png&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="cesium各类事件系统详解"><a href="#cesium各类事件系统详解" class="header-anchor">#</a> Cesium各类事件系统详解</h2> <p>Cesium中监听鼠标事件主要是ScreenSpaceEventHandler类，该类主要就是处理用户输入的，而鼠标事件类型主要是ScreenSpaceEventType</p> <img src="/beifen/744.png">
​
<h3 id="cesium事件相关"><a href="#cesium事件相关" class="header-anchor">#</a> cesium事件相关</h3> <p>类ScreenSpaceEventHandler ( element )：处理用户输入事件。可以添加自定义功能以在以下位置执行当用户输入输入时。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 监听点击事件，拾取坐标</span>
<span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ScreenSpaceEventHandler</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> clickPosition <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">pickEllipsoid</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> randiansPos <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartographic<span class="token punctuation">.</span><span class="token function">fromCartesian</span><span class="token punctuation">(</span>clickPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token string">&quot;经度：&quot;</span> <span class="token operator">+</span>
    Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>randiansPos<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">&quot;, 纬度：&quot;</span> <span class="token operator">+</span>
    Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>randiansPos<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> Cesium<span class="token punctuation">.</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>viewer<span class="token punctuation">.</span>screenSpaceEventHandler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">click</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token comment">// 使用viewer.pick来检查点击位置下的实体  </span>
    <span class="token keyword">var</span> pickedObject <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">pick</span><span class="token punctuation">(</span>click<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Cesium<span class="token punctuation">.</span><span class="token function">defined</span><span class="token punctuation">(</span>pickedObject<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> pickedObject<span class="token punctuation">.</span>id <span class="token operator">===</span> polygon<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'多边形被点击'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token comment">// 在这里可以添加更多的处理逻辑  </span>
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> Cesium<span class="token punctuation">.</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div><h3 id="cesium-实体事件"><a href="#cesium-实体事件" class="header-anchor">#</a> cesium 实体事件</h3> <p>selectedEntityChanged​，这样的话，如果确定是监听Entity的点击事件，就不用那么麻烦了。​</p> <h3 id="cesium-相机事件​"><a href="#cesium-相机事件​" class="header-anchor">#</a> cesium 相机事件​</h3> <div class="language-js extra-class"><pre class="language-js"><code>handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;相机左键拖拽&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">,</span> CameraEventType<span class="token punctuation">.</span><span class="token constant">LEFT_DRAG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
</code></pre></div><h3 id="cesium-键盘事件"><a href="#cesium-键盘事件" class="header-anchor">#</a> cesium 键盘事件</h3> <p>在三维场景中，比较常用的键盘事件就是前进，后退，向左，向右等操作</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>监听鼠标单击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onRightDown<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>监听右键按下<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onMiddleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>监听滚轮键单击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onMouseMove<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>监听鼠标移动<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>removeMonitor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>解除鼠标事件监听<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">top</span><span class="token punctuation">:</span> 40px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onCameraDrag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>相机监听左键拖拽<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">top</span><span class="token punctuation">:</span> 80px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onKeyboard<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>开启键盘事件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> onUnmounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ScreenSpaceEventHandler<span class="token punctuation">,</span> ScreenSpaceEventType<span class="token punctuation">,</span> GeoJsonDataSource<span class="token punctuation">,</span> CameraEventType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;cesium&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> __viewer <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">;</span>

GeoJsonDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;/json/chuzhong.geojson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScreenSpaceEventHandler</span><span class="token punctuation">(</span>__viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;鼠标左键点击&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onRightDown</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;鼠标右键按下&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">RIGHT_DOWN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onMiddleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;滚轮键单击&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">MIDDLE_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onMouseMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;鼠标移动&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">MOUSE_MOVE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// Entity独有的实体选择事件</span>
__viewer<span class="token punctuation">.</span>selectedEntityChanged<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前点击实体&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cameraController <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>screenSpaceCameraController<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onCameraDrag</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;相机左键拖拽&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// cameraController.enableRotate = false;</span>
    <span class="token comment">// cameraController.enableTranslate = false; // 不允许拖拽</span>
    <span class="token comment">// cameraController.enableZoom = false; // 不允许缩放</span>
    <span class="token comment">// cameraController.enableLook = false;</span>
    <span class="token comment">// cameraController.enableTilt = false; // 禁用倾斜</span>
    cameraController<span class="token punctuation">.</span>enableInputs <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 禁用相机控制</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> CameraEventType<span class="token punctuation">.</span><span class="token constant">LEFT_DRAG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onKeyboard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 监听键盘事件</span>
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;keydown&quot;</span><span class="token punctuation">,</span> cameraMove<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">cameraMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置相机移动的步长</span>
  <span class="token keyword">var</span> moveAmount <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> camera <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>camera<span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;w&quot;</span><span class="token operator">:</span> <span class="token comment">// 前进</span>
      camera<span class="token punctuation">.</span><span class="token function">moveForward</span><span class="token punctuation">(</span>moveAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;s&quot;</span><span class="token operator">:</span> <span class="token comment">// 后退</span>
      camera<span class="token punctuation">.</span><span class="token function">moveBackward</span><span class="token punctuation">(</span>moveAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;a&quot;</span><span class="token operator">:</span> <span class="token comment">// 向左</span>
      camera<span class="token punctuation">.</span><span class="token function">moveLeft</span><span class="token punctuation">(</span>moveAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;d&quot;</span><span class="token operator">:</span> <span class="token comment">// 向右</span>
      camera<span class="token punctuation">.</span><span class="token function">moveRight</span><span class="token punctuation">(</span>moveAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;q&quot;</span><span class="token operator">:</span> <span class="token comment">// 向上</span>
      camera<span class="token punctuation">.</span><span class="token function">moveUp</span><span class="token punctuation">(</span>moveAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;e&quot;</span><span class="token operator">:</span> <span class="token comment">// 向下</span>
      camera<span class="token punctuation">.</span><span class="token function">moveDown</span><span class="token punctuation">(</span>moveAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">removeMonitor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">removeInputAction</span><span class="token punctuation">(</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  handler<span class="token punctuation">.</span><span class="token function">removeInputAction</span><span class="token punctuation">(</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">RIGHT_DOWN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  handler<span class="token punctuation">.</span><span class="token function">removeInputAction</span><span class="token punctuation">(</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">MIDDLE_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  handler<span class="token punctuation">.</span><span class="token function">removeInputAction</span><span class="token punctuation">(</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">MOUSE_MOVE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  handler<span class="token punctuation">.</span><span class="token function">removeInputAction</span><span class="token punctuation">(</span>CameraEventType<span class="token punctuation">.</span><span class="token constant">LEFT_DRAG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cameraController<span class="token punctuation">.</span>enableInputs <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;keydown&quot;</span><span class="token punctuation">,</span> cameraMove<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">removeMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>setInputAction (action, type, modifier ):设置要在输入事件上执行的功能。</li> <li>removeInputAction (type, modifier ):移除</li> <li>destroy ():删除此对象持有的侦听器</li></ul> <h3 id="cesium的四种点击拾取方法"><a href="#cesium的四种点击拾取方法" class="header-anchor">#</a> Cesium的四种点击拾取方法</h3> <ol><li><p>viewer.scene.pick():通过坐标位置，拾取实体（Entity），图元（Primitive）,3DTiles对象，返回的是scene中指定位置最上层的对象。例如点击获取Entity的pick对象，通过pick.id可以拾取当前的entity对象。拾取后，可以用于改变对象的属性参数，如颜色，图片等。</p></li> <li><p>viewer.scene.globe.pick():返回一个射线（ray）和地球表面的一个交点的Cartesian3坐标。此方法一般用于获取加载地形后的经纬度和高程，不包括模型、倾斜摄影等表面高度。</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ScreenSpaceEventHandler</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> ray <span class="token operator">=</span> viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">getPickRay</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">let</span> position <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>globe<span class="token punctuation">.</span><span class="token function">pick</span><span class="token punctuation">(</span>ray<span class="token punctuation">,</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> Cesium<span class="token punctuation">.</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>viewer.scene.camera.pickEllipsoid():返回相机视角下鼠标点击的对应椭球面位置。接收屏幕坐标，返回Cartesian3坐标。适用裸球表面的选取，是基于数学模型的椭圆球体。</li></ol> <blockquote><p>注意事项：在有地形的情况下误差较大，在使用时需要关闭深度测试。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ScreenSpaceEventHandler</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> position <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">pickEllipsoid</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>position<span class="token punctuation">,</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>globe<span class="token punctuation">.</span>ellipsoid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> Cesium<span class="token punctuation">.</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>viewer.scene.pickPosition()</li></ol> <p>拾取对应位置的Cartesian3，适用于模型表面位置的选取，拾取三维物体的坐标等。</p> <p>注意事项： 一定开启深度检测（viewer.scene.globe.depthTestAgainstTerrain = true），否则在没有没有3dTile模型的情况下，会出现空间坐标不准的问题。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ScreenSpaceEventHandler</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">let</span> position <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">pickPosition</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> Cesium<span class="token punctuation">.</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-defined"><a href="#cesium-defined" class="header-anchor">#</a> Cesium.defined</h3> <p>Cesium.defined 是一个工具函数，用于判断给定的值是否已定义且非空。这个函数在处理可能未定义（undefined）或为空（null）的变量时非常有用</p> <h3 id="cesium-screenspaceeventtype"><a href="#cesium-screenspaceeventtype" class="header-anchor">#</a> Cesium.ScreenSpaceEventType</h3> <p>LEFT_CLICK， 单击，Cesium.ScreenSpaceEventType 枚举中还有其他许多事件类型，如 RIGHT_CLICK（右键点击）、MOUSE_MOVE（鼠标移动）、WHEEL（鼠标滚轮滚动）</p> <h2 id="gis基础"><a href="#gis基础" class="header-anchor">#</a> gis基础</h2> <h3 id="gis坐标系​"><a href="#gis坐标系​" class="header-anchor">#</a> GIS坐标系​</h3> <ol><li>经纬度坐标（<strong>球面坐标</strong>）： 经纬度坐标通常被称为地理坐标或地球坐标，它是一种基于地球表面的坐标系统，用于确定地球上任何点的位置。这种坐标系统使用两个主要的数值来表示位置：经度和纬度。​</li></ol> <p>经纬度坐标也常常被称为：球面坐标/大地坐标/WGS84坐标</p> <img src="/beifen/726.png"> <ol start="2"><li><strong>地理坐标（弧度）</strong> ​:在地理信息系统（GIS）中，地理坐标通常指的是地球上某个点的位置，使用经纬度来表示。然而，由于地球是一个近似的椭球体，使用弧度而非角度来表示经纬度坐标可以避免在计算中引入的某些复杂性，尤其是在进行距离和面积的测量时。​</li></ol> <p>弧度是一种角度的度量单位，它基于圆的周长和半径之间的关系。一个完整的圆周被定义为 2π弧度。</p> <img src="/beifen/727.png"> <img src="/beifen/728.png"> <ol start="3"><li>屏幕坐标系（Screen Coordinate System）: 是一种二维坐标系统，它用于描述屏幕上的点或区域的位置。屏幕坐标系通常以屏幕的左上角为原点，水平向右为 x 轴正方向，垂直向下为 y 轴正方向。​</li></ol> <img src="/beifen/729.png"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>​
</code></pre></div><ol start="4"><li>空间直角坐标系​:在地理信息系统（GIS）中，空间直角坐标系（Spatial Cartesian Coordinate System）是一种三维坐标系统，用于在三维空间中精确地表示点、线、面的位置。这种坐标系通常由三个正交的坐标轴组成：X、Y 和 Z 轴。<code>​世界坐标通常指的是笛卡尔空间直角坐标系中的坐标，也被称为Cartesian3坐标。</code></li></ol> <img src="/beifen/730.png"> <h3 id="cesium位置计算转换"><a href="#cesium位置计算转换" class="header-anchor">#</a> cesium位置计算转换</h3> <ol><li>经纬度转空间直角</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cartesian3 <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>lng<span class="token punctuation">,</span> lat<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>经纬度转地理坐标（弧度）</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> radians <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span>degrees<span class="token punctuation">)</span> 
</code></pre></div><ol start="3"><li>地理坐标（弧度）转经纬度​</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> degrees <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>radians<span class="token punctuation">)</span> ​
</code></pre></div><ol start="4"><li>空间直角转经纬度</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 先将3D笛卡尔坐标转为地理坐标（弧度） ​</span>
<span class="token keyword">const</span> cartographic <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartographic<span class="token punctuation">.</span><span class="token function">fromCartesian</span><span class="token punctuation">(</span>cartesian3<span class="token punctuation">)</span><span class="token punctuation">;</span> ​
<span class="token comment">// 再将地理坐标（弧度）转为经纬度​</span>
<span class="token keyword">const</span> lat <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>cartographic<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token keyword">const</span> lng <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>cartographic<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span> ​
<span class="token keyword">const</span> height <span class="token operator">=</span> cartographic<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>屏幕坐标转经纬度​</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 监听点击事件，拾取坐标​</span>
<span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ScreenSpaceEventHandler</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>​
handler<span class="token punctuation">.</span><span class="token function">setInputAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
  <span class="token comment">// 点击点的位置</span>
  <span class="token keyword">const</span> clickPosition <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">pickEllipsoid</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>​
  <span class="token keyword">const</span> randiansPos <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartographic<span class="token punctuation">.</span><span class="token function">fromCartesian</span><span class="token punctuation">(</span>clickPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>​
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>​
    <span class="token string">&quot;经度：&quot;</span> <span class="token operator">+</span>​
      Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>randiansPos<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span> <span class="token operator">+</span>​
      <span class="token string">&quot;, 纬度：&quot;</span> <span class="token operator">+</span>​
      Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>randiansPos<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span>​
  <span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">,</span> Cesium<span class="token punctuation">.</span>ScreenSpaceEventType<span class="token punctuation">.</span><span class="token constant">LEFT_CLICK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="6"><li>屏幕坐标转空间直角坐标​
​</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> cartesian3 <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>globe<span class="token punctuation">.</span><span class="token function">pick</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">getPickRay</span><span class="token punctuation">(</span>windowPostion<span class="token punctuation">)</span><span class="token punctuation">,</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span> ​
​
</code></pre></div><ol start="7"><li>世界坐标转屏幕坐标​
​</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>windowPostion <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>SceneTransforms<span class="token punctuation">.</span><span class="token function">wgs84ToWindowCoordinates</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>scene<span class="token punctuation">,</span> cartesian3<span class="token punctuation">)</span><span class="token punctuation">;</span> ​
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 转换为笛卡尔坐标</span>
  <span class="token keyword">const</span> cartesian1 <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> cartesian2 <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 转为弧度制</span>
  <span class="token keyword">let</span> cartographic <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartographic<span class="token punctuation">.</span><span class="token function">fromCartesian</span><span class="token punctuation">(</span>cartesian1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 角度制</span>
  <span class="token keyword">let</span> lon <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>cartographic<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> lat <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toDegrees</span><span class="token punctuation">(</span>cartographic<span class="token punctuation">.</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;笛卡尔坐标：&quot;</span><span class="token punctuation">,</span>cartesian1<span class="token punctuation">,</span> cartesian2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;弧度制&quot;</span><span class="token punctuation">,</span>cartographic<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'经纬度'</span><span class="token punctuation">,</span>lon<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//   笛卡尔坐标： Je {x: -2050703.247253584, y: 5634260.865831492, z: 2167703.6282316237} </span>
<span class="token comment">//   Je {x: -2050706.4611916323, y: 5634269.696053707, z: 2167707.0484330566}</span>

<span class="token comment">//  弧度制 Fr {longitude: 1.9198621771937627, latitude: 0.34906585039886584, height: 19.999999999848896}</span>
  
<span class="token comment">//  经纬度 110.00000000000001 19.999999999999996</span>
</code></pre></div><h2 id="cesium-carmera方法"><a href="#cesium-carmera方法" class="header-anchor">#</a> cesium carmera方法</h2> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>camera <span class="token operator">===</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//true</span>
</code></pre></div><ul><li>viewer.scene.camera.pickEllipsoid(e.position):pickEllipsoid方法如果选择了椭球或地图，则返回椭球或地图表面上的点在世界坐标系中。如果未选择椭球或地图，则返回undefined。</li></ul> <h3 id="cesium-carmera-飞行模式"><a href="#cesium-carmera-飞行模式" class="header-anchor">#</a> cesium carmera 飞行模式</h3> <img src="/beifen/731.png"> <img src="/beifen/732.jpg"> <img src="/beifen/733.webp"> <img src="/beifen/734.webp"> <img src="/beifen/735.webp"> <ul><li>viewer.camera.flyTo</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token literal-property property">destination</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Rectangle<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>west<span class="token punctuation">,</span> south<span class="token punctuation">,</span> east<span class="token punctuation">,</span> north<span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 这个示例展示了如何飞行到一个由经纬度界定的矩形区域。Cesium会尝试找到一个视角，</span>
<span class="token comment">//以便整个矩形都能被相机看到，但通常不会保证是顶部向下的视角。要实现顶部向下的视角，您可能需要额外设置相机的方向。</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token literal-property property">destination</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.19</span><span class="token punctuation">,</span> <span class="token number">46.25</span><span class="token punctuation">,</span> <span class="token number">5000.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">orientation</span> <span class="token operator">:</span> <span class="token punctuation">{</span>  
        <span class="token literal-property property">direction</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.04231243104240401</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.20123236049443421</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.97862924300734</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token literal-property property">up</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.47934589305293746</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.8553216253114552</span><span class="token punctuation">,</span> <span class="token number">0.1966022179118339</span><span class="token punctuation">)</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这个示例中，相机被设置为飞行到一个特定的位置，并具有一个由单位向量指定的方向和向上的方向。</span>
<span class="token comment">//单位向量需要是标准化的（即它们的长度等于1），并且在这个上下文中，它们定义了相机在到达目标位置时应该看向哪里以及它的“上方”应该指向哪里。</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token literal-property property">destination</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.19</span><span class="token punctuation">,</span> <span class="token number">46.25</span><span class="token punctuation">,</span> <span class="token number">5000.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">orientation</span> <span class="token operator">:</span> <span class="token punctuation">{</span>  
        <span class="token literal-property property">heading</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span><span class="token number">175.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token literal-property property">pitch</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">35.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token literal-property property">roll</span> <span class="token operator">:</span> <span class="token number">0.0</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 相机被设置为飞行到一个特定的位置，并具有通过航向（heading）、俯仰（pitch）和翻滚（roll）角指定的方向。</span>
<span class="token comment">// 航向是围绕垂直轴（即Z轴）的旋转，俯仰是围绕水平轴（即Y轴）的旋转，而翻滚是围绕相机的视线方向（即X轴）的旋转。</span>
<span class="token comment">// 在这个例子中，相机将面向几乎正北方向（航向175度），向下倾斜35度，且没有翻滚。这种方式比使用单位向量更直观</span>
</code></pre></div><ul><li>flyTo 飞行至指定模型:当在场景里渲染了一个3D模型，但是找不到的时候，可以使用__viewer.flyTo（tileset）将相机自动定位到模型位置；​</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> tileset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cesium3DTileset</span><span class="token punctuation">(</span>tilesetJson<span class="token punctuation">)</span><span class="token punctuation">;</span>​
__viewer<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span>tileset<span class="token punctuation">)</span><span class="token punctuation">;</span>​
</code></pre></div><ul><li>setView: 方法用于设置相机的视图，包括目标位置、朝向、以及可能的缩放级别,<code>类似flyto只是没有过渡动画</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 从以度为单位的经度和纬度值返回笛卡尔3位置。</span>
  <span class="token literal-property property">destination</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">120.36</span><span class="token punctuation">,</span> <span class="token number">36.09</span><span class="token punctuation">,</span> <span class="token number">40000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>flyToBoundingSphere 指定边界​</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">flyBounding</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> boundingSphere <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BoundingSphere</span><span class="token punctuation">(</span>​
        Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">120.36</span><span class="token punctuation">,</span> <span class="token number">36.09</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
        <span class="token number">40000</span>​
    <span class="token punctuation">)</span><span class="token punctuation">;</span>​
    camera<span class="token punctuation">.</span><span class="token function">flyToBoundingSphere</span><span class="token punctuation">(</span>boundingSphere<span class="token punctuation">,</span> <span class="token punctuation">{</span>​
        <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>​
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>BoundingSphere：具有中心和半径的包围球，API接口，第一个参数是指定中心点，第二个参数是球体半径，单位m；​</p> <ul><li>zoomTo 相机追踪​:当你创建好entity实例之后，可以直接将视角定位到实例的可视区域；​</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> entity <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
  <span class="token literal-property property">position</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">billboard</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
    <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;../images/Cesium_Logo_overlay.png&quot;</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">sizeInMeters</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>​
  <span class="token punctuation">}</span><span class="token punctuation">,</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
__viewer<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>​
</code></pre></div><h2 id="cesium各种collection的作用和使用​"><a href="#cesium各种collection的作用和使用​" class="header-anchor">#</a> cesium各种Collection的作用和使用​</h2> <p>在Cesium中，Collection类用于管理和组织一组相关对象。这些集合提供了一种高效的方法来管理和操作多个对象，从而简化了对大规模数据的操作和渲染。​</p> <h3 id="cesium-entitycollection​"><a href="#cesium-entitycollection​" class="header-anchor">#</a> cesium EntityCollection​</h3> <p>EntityCollection 是用于存储和管理 Entity 对象的集合。它为管理和操作大量的实体提供了一种结构化的方法，并提供了事件机制，用于响应实体的添加、删除或修改。​</p> <p>应用场景:​</p> <ul><li>在动态场景中使用EntityCollection管理一组动态变化的实体，例如车辆、飞机等。</li> <li>使用 DataSource（例如 CzmlDataSource）加载复杂数据集时，EntityCollection被用来管理这些数据。​</li> <li>实现选择、过滤和批量操作实体。</li></ul> <p>与Entity的关系:​</p> <ul><li>每个Entity代表一个独立的对象，可以包含多种几何形状、图标、标签等。</li> <li>EntityCollection 提供了一个组织结构，将多个Entity对象组合在一起进行管理。​</li> <li>EntityCollection 提供了事件支持（如 collectionChanged），帮助开发者跟踪实体的变化。</li></ul> <blockquote><p>通常不直接实例化EntityCollection 类，而是通过__viewer.entities直接获取​</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> point <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;point_01&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">billboard</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/garden-icon.png&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> line <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;polyline_01&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">polyline</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">positions</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100.03883</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token literal-property property">material</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> polygon <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;polygon_01&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">polygon</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">hierarchy</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">109.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">95.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">95.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">109.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">material</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">withAlpha</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;entityCollection&quot;</span><span class="token punctuation">,</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;entityCollection的values&quot;</span><span class="token punctuation">,</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将点、线、面通过__viewer.entities.add都添加进集合entityCollection实例中，<code>而add就是entityCollection提供的方法</code></p> <h3 id="cesium-实体"><a href="#cesium-实体" class="header-anchor">#</a> cesium 实体</h3> <p>Entity是Cesium中封装好的一个非常强大的类，封装了复杂的底层操作，使开发者可以更简单地创建和管理各种对象，而不需要深入了解底层图形学细节。​
​
Entity能够支持渲染点、线、面、多边形、圆柱、圆锥、盒子、椭球等各种几何形状，还可以为这些形状指定颜色、材质、透明度等属性。​
​
在viewer对象中就包含一个entities对象.</p> <p>一种直接new Entity，然后添加到场景中。</p> <p>第二个用viewer.scene.add添加。</p> <p><a href="/3d/04cesium.html#cesium添加实体">链接</a></p> <p>以billboard为例</p> <p>创建</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> entities <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>__viewer<span class="token punctuation">;</span>​
entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;point_01&quot;</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">billboard</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
        <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/garden-icon.png&quot;</span><span class="token punctuation">,</span>​
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>修改:通过<code>entities.getById(id)</code>找到要修改的几何体，然后重新设置属性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">modifyBillboard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    entities<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;point_01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>billboard<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>​
    entities<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;point_01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>billboard<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>​
    entities<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;point_01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>billboard<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span><span class="token constant">BLUE</span><span class="token punctuation">.</span><span class="token function">withAlpha</span><span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>删除:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">removeBillboard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token comment">// 指定删除​</span>
    entities<span class="token punctuation">.</span><span class="token function">removeById</span><span class="token punctuation">(</span><span class="token string">&quot;point_01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
    <span class="token comment">// 删除所有，但注意：这里不仅仅删除的是billboard，而是所有用entity渲染的几何体​</span>
    <span class="token comment">// entities.removeAll();​</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>​
</code></pre></div><p>Polyline 用于在地图上绘制线条</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addPolyline</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'polyline_01'</span><span class="token punctuation">,</span>​
        <span class="token literal-property property">polyline</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token literal-property property">positions</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100.03883</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">material</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>fromDegreesArray</strong>：线段，至少由2个点位相连形成，所有positions需要是一个坐标数组：[经度、纬度、经度、纬度...]​</p> <p>Polygon 用于在地图上绘制多边形</p> <p>hierarchy：现在可以简单理解为绘制多边形的所需的坐标点位，我这里画了个矩形，所以需要4个经纬度坐标组成的数组；​</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addPolygon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;polygon_01&quot;</span><span class="token punctuation">,</span>​
        <span class="token literal-property property">polygon</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token literal-property property">hierarchy</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">109.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">95.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">95.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">109.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">material</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">withAlpha</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="cesium-primitivecollection​"><a href="#cesium-primitivecollection​" class="header-anchor">#</a> cesium PrimitiveCollection​</h4> <p>PrimitiveCollection 是 Cesium 中用于管理和渲染一组图元（Primitives）的集合。<strong>图元是 Cesium 中的低级别渲染对象，通常用于直接控制渲染管线。​</strong></p> <p>PrimitiveCollection 的作用​
​</p> <ul><li>管理低级别渲染对象：PrimitiveCollection 用于管理和组织一组图元（如 Billboards、Polylines、Points、Models 等）。这些图元直接与 WebGL 图形管线交互，可以提供高效的渲染性能。</li> <li>自定义渲染流程：提供了一种直接控制渲染顺序和方式的机制，允许更精细的图形控制和优化。​​</li></ul> <p>PrimitiveCollection 的优势​
​</p> <ul><li><strong>性能优化</strong>：由于直接操作图元，PrimitiveCollection 提供了比 EntityCollection 更高的性能。这在需要渲染<code>大量对象</code>时尤其明显​。绘制大量Primitive时，可以将其合并为单个<code>Geometry</code>以减轻<code>CPU</code>负担、更好的使用<code>GPU</code>。而且合并Primitive是由<code>web worker</code>线程执行，采取多线程极大的提升了前端渲染性能；​</li> <li>灵活性：允许开发者使用 Cesium API 直接操作图元的属性，如几何形状、材质、变换等，提供了更多的灵活性。​</li> <li>低级控制：适用于需要特定渲染效果或性能优化的场景，开发者可以直接管理图元的生命周期和渲染顺序。​</li></ul> <blockquote><p>EntityCollection：适用于大多数应用场景，特别是<strong>动态变化、与数据源绑定的场合</strong>。</p></blockquote> <h4 id="primitive组成​"><a href="#primitive组成​" class="header-anchor">#</a> Primitive组成​</h4> <ul><li>GeometryInstances：几何形状，例如点、线、面等；​</li> <li>Appearance：外观，可以编写着色器语言渲染几何体的样式；​</li></ul> <p>Cesium 中自定义了多种 PointPrimitive用于渲染点的基本单元。还包括PointPrimitiveCollection、BillboardCollection、LabelCollection、PolylineCollection等
​</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> billboardCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BillboardCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">addBillboardCollection</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>billboardCollection<span class="token punctuation">)</span><span class="token punctuation">;</span>
  billboardCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;point_02&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/garden-icon.png&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  billboardCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;point_03&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">97.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/mark-icon.png&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;billboardCollection&quot;</span><span class="token punctuation">,</span> billboardCollection<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;primitives&quot;</span><span class="token punctuation">,</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_20万点位渲染优化​"><a href="#_20万点位渲染优化​" class="header-anchor">#</a> 20万点位渲染优化​</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addLargePoint</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
  pointPrimitiveCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointPrimitiveCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">200000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span>​
      <span class="token literal-property property">position</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">116.39</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">39.9</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
      <span class="token literal-property property">color</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">GREEN</span><span class="token punctuation">,</span>​
      <span class="token literal-property property">pixelSize</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>​
    <span class="token punctuation">}</span>​
    pointPrimitiveCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span>​
  <span class="token punctuation">}</span>​
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pointPrimitiveCollection<span class="token punctuation">)</span>​
<span class="token punctuation">}</span>
</code></pre></div><p>这里需要注意一个影响性能的点，千万不要在循环中执行__viewer.scene.primitives.add(pointPrimitiveCollection)，因为这个操作会导致视图在循环过程中不断的渲染，正确的做法就是先把pointPrimitiveCollection处理好，最后一次性添加到视图中，这样视图也只会渲染一次即可。​</p> <h4 id="性能优化-合并单个geometry​"><a href="#性能优化-合并单个geometry​" class="header-anchor">#</a> 性能优化-合并单个Geometry​</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> polylinePrimitive​
<span class="token keyword">const</span> <span class="token function-variable function">addPolyline</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
  <span class="token comment">// 创建一个新的 PolylineGeometry 实例​</span>
  <span class="token keyword">const</span> polyline <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PolylineGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">positions</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>​
      <span class="token operator">-</span><span class="token number">75.10</span><span class="token punctuation">,</span> <span class="token number">39.57</span><span class="token punctuation">,</span>​
      <span class="token operator">-</span><span class="token number">105.02</span><span class="token punctuation">,</span> <span class="token number">38.53</span>​
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">5.0</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
  <span class="token comment">// 创建一个实例化几何的 Appearance​</span>
  <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> polyline<span class="token punctuation">,</span>​
    <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
      <span class="token literal-property property">color</span><span class="token operator">:</span> ColorGeometryInstanceAttribute<span class="token punctuation">.</span><span class="token function">fromColor</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">)</span>​
    <span class="token punctuation">}</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
  <span class="token comment">// 创建并添加 Primitive​</span>
  polylinePrimitive <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">geometryInstances</span><span class="token operator">:</span> instance<span class="token punctuation">,</span>​
    <span class="token literal-property property">appearance</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">PolylineMaterialAppearance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
      <span class="token literal-property property">material</span><span class="token operator">:</span> Material<span class="token punctuation">.</span><span class="token function">fromType</span><span class="token punctuation">(</span><span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>​
        <span class="token literal-property property">color</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">RED</span>​
      <span class="token punctuation">}</span><span class="token punctuation">)</span>​
    <span class="token punctuation">}</span><span class="token punctuation">)</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
  <span class="token comment">// 将 Primitive 添加到场景​</span>
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polylinePrimitive<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span>
</code></pre></div><ul><li>GeometryInstance：用于定义一个或多个几何实例，包括其形状、大小和位置。​</li> <li>Appearance：用于定义几何体的外观属性，如材质和着色器。</li> <li><strong>Primitive：在场景中实例化并渲染几何体</strong></li></ul> <p>当有多个个polylineGeometry的时候，合并Geometry为单个Primitive，减轻CPU负担、更好的使用GPU​</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> intances <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>​
intances<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>）​
<span class="token comment">// 把处理好的geometry实例合并成单个Primitive​</span>
polylinePrimitive <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">geometryInstances</span><span class="token operator">:</span> instances<span class="token punctuation">,</span>​
    <span class="token literal-property property">appearance</span><span class="token operator">:</span> <span class="token comment">//...​</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>primitive的删除最好不要直接执行viewer.scene.primitives.removeAll()去删除所有，不然大概率会受到一份大礼：​
​</p> <blockquote><p>This object was destroyed, i.e., destroy() was called.​
​
这是因为当你执行primitives.removeAll()之后，场景中的图元对象就都被删除了，当你再次添加图元的时候是需要基于图元对象添加的，所以会报出：This object was destroyed​</p></blockquote> <h4 id="primitives-remove-指定删除对象"><a href="#primitives-remove-指定删除对象" class="header-anchor">#</a> primitives.remove()指定删除对象</h4> <p>当primitives.add()添加的是一些上层对象，例如BillboardCollection，PolylineCollection的时候，可以利用primitives.remove()指定删除对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> pointPrimitiveCollection<span class="token punctuation">;</span>​
<span class="token keyword">const</span> <span class="token function-variable function">addPointPrimitive</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
  pointPrimitiveCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PointPrimitiveCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
  pointPrimitiveCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token comment">//...)​</span>
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pointPrimitiveCollection<span class="token punctuation">)</span>​
<span class="token punctuation">}</span>​
​
<span class="token keyword">const</span> <span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>pointPrimitiveCollection<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span>​
</code></pre></div><ul><li>再删除的时候指定删除某个collection，也就是clear方法里的操作；​</li> <li>每次重新新增primitive的时候，要重新实例化collection，因为你已经把之前的collection删除了；</li></ul> <h3 id="cesium中的geometryinstance的attributes​"><a href="#cesium中的geometryinstance的attributes​" class="header-anchor">#</a> cesium中的GeometryInstance的attributes​</h3> <p>通过GeometryInstance去构建几何体，attributes 是一个对象，用于定义每个几何实例的属性。每个属性都是一个 GeometryInstanceAttribute，并且可以用于控制几何体的外观、位置、颜色等。​</p> <h4 id="常用属性​"><a href="#常用属性​" class="header-anchor">#</a> 常用属性​</h4> <p>color​：定义几何体的颜色。通常使用 ColorGeometryInstanceAttribute。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> colorAttribute <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>ColorGeometryInstanceAttribute<span class="token punctuation">.</span><span class="token function">fromColor</span><span class="token punctuation">(</span>Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
  <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>RectangleGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">rectangle</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Rectangle<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">20.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">90.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">)</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
    <span class="token literal-property property">color</span><span class="token operator">:</span> colorAttribute​
  <span class="token punctuation">}</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>show​：控制几何体的显示或隐藏。使用 ShowGeometryInstanceAttribute。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> showAttribute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ShowGeometryInstanceAttribute</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
  <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CircleGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">center</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">100000.0</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
    <span class="token literal-property property">show</span><span class="token operator">:</span> showAttribute​
  <span class="token punctuation">}</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>distanceDisplayCondition​：设置几何体在不同距离下的可见性范围。使用 DistanceDisplayConditionGeometryInstanceAttribute。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> distanceDisplayConditionAttribute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>DistanceDisplayConditionGeometryInstanceAttribute</span><span class="token punctuation">(</span>​
  <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">500000.0</span>​
<span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
  <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>PolygonGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">polygonHierarchy</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>PolygonHierarchy</span><span class="token punctuation">(</span>​
      Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>​
        <span class="token operator">-</span><span class="token number">109.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">,</span>​
        <span class="token operator">-</span><span class="token number">95.0</span><span class="token punctuation">,</span> <span class="token number">30.0</span><span class="token punctuation">,</span>​
        <span class="token operator">-</span><span class="token number">95.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span>​
        <span class="token operator">-</span><span class="token number">109.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span>​
      <span class="token punctuation">]</span><span class="token punctuation">)</span>​
    <span class="token punctuation">)</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
    <span class="token literal-property property">distanceDisplayCondition</span><span class="token operator">:</span> distanceDisplayConditionAttribute​
  <span class="token punctuation">}</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>offset​：定义几何体的高度偏移。使用 GeometryInstanceAttribute。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> offsetAttribute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>GeometryInstanceAttribute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
  <span class="token literal-property property">componentDatatype</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>ComponentDatatype<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">componentsPerAttribute</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">10.0</span><span class="token punctuation">]</span>  <span class="token comment">// Height offset​</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
  <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CylinderGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">400000.0</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">topRadius</span><span class="token operator">:</span> <span class="token number">200000.0</span><span class="token punctuation">,</span>​
    <span class="token literal-property property">bottomRadius</span><span class="token operator">:</span> <span class="token number">200000.0</span>​
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">modelMatrix</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Transforms<span class="token punctuation">.</span><span class="token function">eastNorthUpToFixedFrame</span><span class="token punctuation">(</span>​
    Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">)</span>​
  <span class="token punctuation">)</span><span class="token punctuation">,</span>​
  <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
    <span class="token literal-property property">offset</span><span class="token operator">:</span> offsetAttribute​
  <span class="token punctuation">}</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-几何体外观材质类"><a href="#cesium-几何体外观材质类" class="header-anchor">#</a> cesium 几何体外观材质类</h3> <p>Appearance 类用于定义几何体的<code>外观和材质</code>属性。它决定了几何体如何渲染，包括其材质、着色器（Material）和其他视觉特性。Appearance 通常与 Primitive 结合使用，以控制几何体在场景中的呈现方式。​</p> <h3 id="cesium常见的-appearance-类型​"><a href="#cesium常见的-appearance-类型​" class="header-anchor">#</a> cesium常见的 Appearance 类型​</h3> <ul><li>MaterialAppearance​:用于将 Material 应用于几何体。这允许使用材质系统定义几何体的外观，包括颜色、纹理和透明度等。</li> <li>PerInstanceColorAppearance​:每个几何实例有不同的颜色。这种外观常用于需要为每个几何实例设置不同颜色的情况，例如当你渲染了多个polygon，每个polygon都有自己独有的颜色，那么外观材质就比较适合使用PerInstanceColorAppearance。</li> <li>PolylineMaterialAppearance​:专门用于多段线的外观。允许为多段线设置材质。</li> <li>EllipsoidSurfaceAppearance​:专为椭球表面设计的外观。通常用于地球表面几何体。</li></ul> <p>参数</p> <div class="language-bash extra-class"><pre class="language-bash"><code>translucent​:Boolean​<span class="token punctuation">;</span> <span class="token comment">#指定几何体是否是半透明的。默认值为 true。​</span>
closed​:Boolean​<span class="token punctuation">;</span> <span class="token comment">#指定几何体是否为闭合体。对于需要显示阴影或光照效果的几何体，通常设置为 true。​</span>
</code></pre></div><p>MaterialAppearance 特有参数​</p> <div class="language-bash extra-class"><pre class="language-bash"><code>material​ 类型：Material <span class="token comment">#描述：指定几何体的材质，包括颜色、纹理等。​</span>
faceForward​:Boolean <span class="token comment">#描述：指定是否正面渲染几何体，有控制光照的作用。默认值为 true。​</span>
flat​:Boolean <span class="token comment">#描述：指定是否使用平面着色，不考虑光线的作用。默认值为 false。​</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> __viewer <span class="token punctuation">}</span> <span class="token operator">=</span> window


<span class="token keyword">let</span> circlePrimitive <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">const</span> <span class="token function-variable function">addMaterailAppearance</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建一个圆实例</span>
  <span class="token keyword">const</span> circleInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CircleGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">center</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">1000000.0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建一个材质</span>
  <span class="token keyword">const</span> material <span class="token operator">=</span> Material<span class="token punctuation">.</span><span class="token function">fromType</span><span class="token punctuation">(</span><span class="token string">'Grid'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">GREEN</span><span class="token punctuation">,</span>
    <span class="token literal-property property">cellAlpha</span><span class="token operator">:</span> <span class="token number">0.5</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建一个 MaterialAppearance 外观</span>
  <span class="token keyword">const</span> materialAppearance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MaterialAppearance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">material</span><span class="token operator">:</span> material<span class="token punctuation">,</span>
    <span class="token literal-property property">translucent</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建一个 Primitive 并将 MaterialAppearance 应用于其上</span>
  circlePrimitive <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometryInstances</span><span class="token operator">:</span> circleInstance<span class="token punctuation">,</span>
    <span class="token literal-property property">appearance</span><span class="token operator">:</span> materialAppearance
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 将 Primitive 添加到场景</span>
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>circlePrimitive<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>PolylineMaterialAppearance 的主要参数​</p> <ul><li>material​ 类型：Material​ 描述：用于多段线的材质，可以是颜色、纹理或其他复杂效果。​</li> <li>translucent​ 类型：Boolean​ 描述：指定多段线是否为半透明。默认值为 true。​</li> <li>vertexFormat​ 类型：VertexFormat​ 描述：指定顶点属性格式，通常不需要手动设置。​</li></ul> <p>Material 中常用的Polyline类型​</p> <ul><li>PolylineGlow​ 用于创建带有发光效果的多段线。​
<ul><li>参数：glowPower（发光强度）、color（颜色）。​</li></ul></li> <li>PolylineOutline​ 用于创建带有轮廓线的多段线。​
<ul><li>参数：color（主体颜色）、outlineColor（轮廓颜色）、outlineWidth（轮廓宽度）。​</li></ul></li> <li>PolylineArrow​ 创建带箭头的多段线​</li> <li>PolylineDash​ 创建虚线样式的多线段​</li></ul> <h4 id="应用场景​"><a href="#应用场景​" class="header-anchor">#</a> 应用场景​</h4> <p>PolylineMaterialAppearance 适用于以下场景：​</p> <ul><li>高亮路线：用于表示导航路径或其他需要高亮显示的线条。​</li> <li>绘制电网、管道等：用来显示具有特定视觉效果的基础设施。​</li> <li>动态线条：需要通过材质实现复杂动态效果的多段线。​</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> polylinePrimitive <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">const</span> <span class="token function-variable function">addPolylineMaterial</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// 定义多段线的几何体</span>
  <span class="token keyword">const</span> polyline <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PolylineGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">positions</span><span class="token operator">:</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token operator">-</span><span class="token number">75.10</span><span class="token punctuation">,</span> <span class="token number">39.57</span><span class="token punctuation">,</span>
      <span class="token operator">-</span><span class="token number">77.02</span><span class="token punctuation">,</span> <span class="token number">38.53</span><span class="token punctuation">,</span>
      <span class="token operator">-</span><span class="token number">80.50</span><span class="token punctuation">,</span> <span class="token number">35.14</span><span class="token punctuation">,</span>
      <span class="token operator">-</span><span class="token number">93.01</span><span class="token punctuation">,</span> <span class="token number">29.67</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50.0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建几何体实例</span>
  <span class="token keyword">const</span> geometryInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> polyline
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建材质</span>
  <span class="token keyword">const</span> material <span class="token operator">=</span> Material<span class="token punctuation">.</span><span class="token function">fromType</span><span class="token punctuation">(</span><span class="token string">'PolylineGlow'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">glowPower</span><span class="token operator">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">ORANGE</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建 PolylineMaterialAppearance 外观</span>
  <span class="token keyword">const</span> appearance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PolylineMaterialAppearance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">material</span><span class="token operator">:</span> material
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建 Primitive 并将 PolylineMaterialAppearance 应用于其上</span>
  polylinePrimitive <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometryInstances</span><span class="token operator">:</span> geometryInstance<span class="token punctuation">,</span>
    <span class="token literal-property property">appearance</span><span class="token operator">:</span> appearance<span class="token punctuation">,</span>
    <span class="token literal-property property">asynchronous</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 将 Primitive 添加到场景</span>
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>polylinePrimitive<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>EllipsoidSurfaceAppearance:用于在球体（椭球体）表面应用着色。对 Cesium 的 Ellipsoid 几何体进行自定义外观处理，适用于地球表面、行星等场景的渲染。​</p> <ol><li>椭球体几何体创建：​EllipsoidGeometry 用于创建椭球面几何体，参数 radii 指定椭球体的半径（x、y、z）。</li> <li>几何体实例：​GeometryInstance 用于包装几何体，modelMatrix 用于指定椭球体在场景中的位置。</li> <li>使用 EllipsoidSurfaceAppearance：​EllipsoidSurfaceAppearance 的 material 属性定义了椭球体的材质，可以使用颜色、纹理等。</li> <li>添加到场景：​创建 Primitive 对象，将几何体实例和 EllipsoidSurfaceAppearance 结合，添加到 Cesium 的场景中进行渲染。</li></ol> <p>应用场景​</p> <ul><li>模拟天体表面：使用纹理或颜色模拟行星、卫星等天体表面。​</li> <li>地球表面着色：用于自定义地球表面的视觉效果，适用于需要覆盖整个地表的场景。​</li> <li>数据可视化：可以在椭球体上叠加不同的材质以展示不同的数据图层。​</li></ul> <h3 id="cesium中自定义封装材质类"><a href="#cesium中自定义封装材质类" class="header-anchor">#</a> cesium中自定义封装材质类</h3> <p>Material提供了灵活的方式来定义材质的纹理、颜色、透明度等特性，并允许用户通过 GLSL 着色器语言自定义复杂的视觉效果。Material 可以应用于多种外观（Appearance）。通过Material.fromType(type)可以直接使用Cesium提供的一些现成的材质效果。​
​</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addMaterail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 定义多段线的初始位置</span>
  <span class="token keyword">const</span> positions <span class="token operator">=</span> Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegreesArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token operator">-</span><span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">79.02</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建自定义材质，用于动态流动效果</span>
  Material<span class="token punctuation">.</span>PolylineTrailType <span class="token operator">=</span> <span class="token string">'PolylineTrail'</span><span class="token punctuation">;</span>
  Material<span class="token punctuation">.</span>PolylineTrailSource <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    uniform vec4 color;
    uniform float speed;
    czm_material czm_getMaterial(czm_materialInput materialInput)
    {
        czm_material material = czm_getDefaultMaterial(materialInput);
        vec2 st = materialInput.st;
        float t = czm_frameNumber * speed / 500.0;
        float alpha = sin((st.s + t) * 3.14159);
        material.diffuse = color.rgb;
        material.alpha = color.a * alpha;
        return material;
    }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  Material<span class="token punctuation">.</span>_materialCache<span class="token punctuation">.</span><span class="token function">addMaterial</span><span class="token punctuation">(</span>Material<span class="token punctuation">.</span>PolylineTrailType<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">fabric</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Material<span class="token punctuation">.</span>PolylineTrailType<span class="token punctuation">,</span>
      <span class="token literal-property property">uniforms</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">1.0</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> Material<span class="token punctuation">.</span>PolylineTrailSource
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建 PolylineMaterialAppearance 外观</span>
  <span class="token keyword">const</span> appearance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PolylineMaterialAppearance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">material</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Material</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">fabric</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Material<span class="token punctuation">.</span>PolylineTrailType<span class="token punctuation">,</span>
        <span class="token literal-property property">uniforms</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> Color<span class="token punctuation">.</span><span class="token constant">CYAN</span><span class="token punctuation">,</span>
          <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">10.0</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建多段线几何体实例</span>
  <span class="token keyword">const</span> polylineGeometryInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeometryInstance</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">PolylineGeometry</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">positions</span><span class="token operator">:</span> positions<span class="token punctuation">,</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10.0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 创建 Primitive 并将 PolylineMaterialAppearance 应用于其上</span>
  moveLinePrimitive <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Primitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">geometryInstances</span><span class="token operator">:</span> polylineGeometryInstance<span class="token punctuation">,</span>
    <span class="token literal-property property">appearance</span><span class="token operator">:</span> appearance<span class="token punctuation">,</span>
    <span class="token literal-property property">asynchronous</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 将 Primitive 添加到场景</span>
  __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>moveLinePrimitive<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="代码说明​"><a href="#代码说明​" class="header-anchor">#</a> 代码说明​</h4> <ol><li>定义多段线位置：​使用 Cesium.Cartesian3.fromDegreesArray 定义多段线的路径。​</li> <li>自定义材质：​在 Cesium.Material 中添加新的材质类型 PolylineTrail。​</li> <li>source 中定义了 GLSL 着色器代码，用于实现流动效果。​</li> <li>czm_frameNumber 是 Cesium 提供的内建变量，用于获取当前的帧编号，可以用于动画效果。​</li> <li>使用 PolylineMaterialAppearance：​使用 PolylineMaterialAppearance 结合自定义材质创建流动效果。​</li> <li>创建几何体实例：​使用 Cesium.PolylineGeometry 创建多段线的几何体实例。​</li> <li>创建和添加 Primitive：​创建 Primitive 对象，并将几何体实例和 PolylineMaterialAppearance 组合，然后将其添加到 Cesium 的场景中。​</li></ol> <blockquote><p>其中，Material.fromType（type， uniforms）是new Material({fabric : {type : type， uniforms: {}}})的另一种写法​</p></blockquote> <h4 id="glsl-代码分析​"><a href="#glsl-代码分析​" class="header-anchor">#</a> GLSL 代码分析​</h4> <ol><li>Uniforms(定义变量)​</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>float t <span class="token operator">=</span> czm_frameNumber <span class="token operator">*</span> speed <span class="token operator">/</span> <span class="token number">1000.0</span><span class="token punctuation">;</span>​

</code></pre></div><p>czm_frameNumber 是 Cesium 提供的内置变量，表示当前帧的编号。​
t 计算基于帧编号和速度的时间变量，产生动画的时间轴。​
速度被缩放（除以 1000.0）以控制其影响范围和动画流畅度。​
​
2. 动画效果​
​</p> <div class="language-js extra-class"><pre class="language-js"><code>float alpha <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span>st<span class="token punctuation">.</span>s <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3.14159</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​

</code></pre></div><p>alpha 计算每个片段的透明度，使用 sin 函数实现动态的透明度变化。​</p> <p>(st.s + t) 使得透明度在时间和空间上变化，产生流动效果。​</p> <p>3.14159 近似 π，用于将 sin 函数的周期设定为适合的范围。​
​
3. 材质属性设置​
​</p> <div class="language-js extra-class"><pre class="language-js"><code>material<span class="token punctuation">.</span>diffuse <span class="token operator">=</span> color<span class="token punctuation">.</span>rgb<span class="token punctuation">;</span>​

</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>material.diffuse 设置材质的漫反射颜色，即物体在受到光照时表现出的颜色。​

color.rgb 提供了基础的 RGB 颜色值，来自传入的 uniform。​

material.alpha = color.a * alpha;​

material.alpha 设置材质的透明度。​
color.a 是传入的基础透明度，alpha 是动态变化的透明度因子，两者相乘控制最终透明度。​
通过 alpha 的变化实现线条的动态流动效果。​
​
return material;​

返回计算后的 czm_material 对象，Cesium 使用它来渲染当前片段的外观。​
</code></pre></div><h3 id="cesium白模及自定义皮肤"><a href="#cesium白模及自定义皮肤" class="header-anchor">#</a> cesium白模及自定义皮肤</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addBuildings<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>加载白模<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modifyColor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>修改白模颜色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>perColor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>分层设色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>smartBuild<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>泛光特效<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clear<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>清空<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Cesium <span class="token keyword">from</span> <span class="token string">&quot;cesium&quot;</span>

<span class="token keyword">let</span> build3Dtileset <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">const</span> <span class="token function-variable function">addBuildings</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&quot;/models/qd_buildings/tileset.json&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> tilesetUrl <span class="token operator">=</span> <span class="token keyword">await</span> Cesium<span class="token punctuation">.</span>Cesium3DTileset<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  build3Dtileset <span class="token operator">=</span> window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tilesetUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// window.__viewer.scene.globe.depthTestAgainstTerrain = true;</span>
  <span class="token comment">// window.__viewer.extend(Cesium.viewerCesium3DTilesInspectorMixin);</span>

  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>build3Dtileset<span class="token punctuation">,</span>window<span class="token punctuation">.</span>__viewer<span class="token punctuation">)</span>

  window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span>build3Dtileset<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">modifyColor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>build3Dtileset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    build3Dtileset<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cesium3DTileStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">conditions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'true'</span><span class="token punctuation">,</span> <span class="token string">&quot;color('rgb(51, 153, 255)',1)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">perColor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>build3Dtileset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    build3Dtileset<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cesium3DTileStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">conditions</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">[</span><span class="token string">'${Elevation} &gt;= 100'</span><span class="token punctuation">,</span> <span class="token string">&quot;color('rgb(255, 0, 0)',1)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token string">'${Elevation} &gt;= 50'</span><span class="token punctuation">,</span> <span class="token string">&quot;color('rgb(255, 255, 0)',1)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">[</span><span class="token string">'true'</span><span class="token punctuation">,</span> <span class="token string">&quot;color('rgb(0, 0, 255)',1)&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">smartBuild</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>build3Dtileset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  build3Dtileset<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cesium3DTileStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">conditions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'true'</span><span class="token punctuation">,</span> <span class="token string">&quot;color('rgb(51, 153, 255)',1)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> customShader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CustomShader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//不考虑光照模型</span>
    <span class="token literal-property property">lightingModel</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>LightingModel<span class="token punctuation">.</span><span class="token constant">UNLIT</span><span class="token punctuation">,</span>
    <span class="token comment">// fract 用于提取其参数的小数部分</span>
    <span class="token comment">// czm_frameNumber 是一个内置的全局变量，它代表了当前渲染帧的编号。帧计数器，每次渲染时自增1，可用于实现动画效果。</span>
    <span class="token comment">//这个变量是由CesiumJS的渲染引擎自动管理的，用于各种与帧相关的计算，比如动画、时间流逝效果等。</span>
    <span class="token literal-property property">fragmentShaderText</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
              float _baseHeight = 180.0; // 物体的基础高度，需要修改成一个合适的建筑基础高度
              float _heightRange = 100.0; // 高亮的范围
              float _glowRange = 400.0; // 光环的移动范围(高度)
              float vtxf_height = fsInput.attributes.positionMC.z-_baseHeight;
              float vtxf_a11 = fract(czm_frameNumber / 360.0) * 20.14159265 * 2.0;
              float vtxf_a12 = vtxf_height / _heightRange + sin(vtxf_a11) * 0.1;
              material.diffuse*= vec3(vtxf_a12, vtxf_a12, vtxf_a12);
              float vtxf_a13 = fract(czm_frameNumber / 360.0);
              float vtxf_h = clamp(vtxf_height / _glowRange, 0.0, 1.0);
              vtxf_a13 = abs(vtxf_a13 - 0.5) * 2.0;
              float vtxf_diff = step(0.31, abs(vtxf_h - vtxf_a13));
              material.diffuse += material.diffuse * (1.0 - vtxf_diff);
            }     
            </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//将定义好的着色器作用域建筑tilesets</span>
  build3Dtileset<span class="token punctuation">.</span>customShader <span class="token operator">=</span> customShader<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>build3Dtileset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>build3Dtileset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    build3Dtileset <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="cesium-实体model"><a href="#cesium-实体model" class="header-anchor">#</a> cesium 实体model</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> entity <span class="token operator">=</span> viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MyModelName'</span><span class="token punctuation">,</span> <span class="token comment">// 使用一个描述性的名称  </span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> position<span class="token punctuation">,</span>  
    <span class="token literal-property property">orientation</span><span class="token operator">:</span> orientation<span class="token punctuation">,</span>  
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
        <span class="token literal-property property">uri</span><span class="token operator">:</span> url<span class="token punctuation">,</span> <span class="token comment">// 假设 url 变量包含模型的 URI  </span>
        <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>  
        <span class="token literal-property property">maximumScale</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>  
        <span class="token comment">// 模型轮廓（或边缘）的颜色</span>
        <span class="token literal-property property">silhouetteColor</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token function">fromCssColorString</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">.</span>silhouetteColor<span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token comment">// 轮廓线的粗细 </span>
        <span class="token literal-property property">silhouetteSize</span><span class="token operator">:</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">.</span>silhouetteSize<span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// 如果需要动态更改颜色，请考虑使用其他方法，如后期处理或修改模型文件</span>
</code></pre></div><h3 id="cesium中与图形学相关的变量和方法"><a href="#cesium中与图形学相关的变量和方法" class="header-anchor">#</a> cesium中与图形学相关的变量和方法</h3> <p>一、常用的变量</p> <p>1、czm_model：模型变换矩阵，将对象从模型空间变换到世界空间。</p> <p>2、czm_view：视图变换矩阵，将世界空间中的对象变换到摄像机空间。</p> <p>3、czm_projection：投影变换矩阵，将摄像机空间中的对象进行透视或正交投影，得到剪辑空间坐标。</p> <p>4、czm_modelView：模型视图变换矩阵，即 czm_view * czm_model。</p> <p>5、czm_modelViewProjection：模型视图投影变换矩阵，即 czm_projection * czm_view * czm_model，将对象从模型空间变换到剪辑空间。</p> <p>6、czm_inverseModel：模型变换矩阵的逆矩阵，用于将世界空间中的坐标变换到模型空间中。</p> <p>7、czm_inverseView：视图变换矩阵的逆矩阵，用于将摄像机空间中的坐标变换到世界空间中。</p> <p>8、czm_inverseProjection：投影变换矩阵的逆矩阵，用于将剪辑空间中的坐标变换到摄像机空间中。</p> <p>9、czm_normal：变换后的法线向量，用于进行光照计算。</p> <p>10、czm_ellipsoid：椭球体参数，用于进行地球表面坐标系和笛卡尔坐标系之间的转换。</p> <p>11、czm_frameNumber：帧计数器，每次渲染时自增1，可用于实现动画效果。</p> <p>12、czm_pixelRatio：设备像素比，用于实现高分辨率屏幕上的渲染。</p> <p>二、常用的函数</p> <p>1、czm_unpackDepth：它用于将从深度纹理中读取到的深度值进行解压缩，以便在着色器中进行深度测试和深度值比较等操作。深度纹理通常用于实现阴影效果、深度检测等功能。在Cesium中，深度值通常被存储在一个16位的纹理单元中，这个值被压缩成0到1之间的浮点数，以便节省显存空间。</p> <p>2、czm_inverseTranspose：返回一个矩阵的逆转置矩阵，通常用于变换法线向量。</p> <p>3、czm_saturation：返回一个颜色的饱和度，通常用于实现色彩调整。</p> <p>4、czm_sceneMode：返回当前场景的模式，例如二维地图、三维场景等。</p> <p>5、czm_ellipsoidContainsPoint：判断一个点是否在当前椭球体内，通常用于进行鼠标拾取等操作。</p> <p>6、czm_eastNorthUpToFixedFrame：返回从东-北-天坐标系到固定坐标系的变换矩阵，通常用于实现坐标系转换。</p> <p>7、czm_geodeticSurfaceNormal：返回一个点在椭球体表面上的法线向量，通常用于进行光照计算。</p> <p>8、czm_transformColor：将一个颜色从一种颜色空间转换为另一种颜色空间，通常用于进行色彩调整。</p> <p>9、czm_decompressTextureCoordinates：解压缩纹理坐标，通常用于将纹理坐标从一个压缩格式转换为普通的二维坐标。</p> <p>10、czm_eyeOffset：返回一个向量，表示摄像机视点在局部坐标系中的偏移量。</p> <p>11、czm_fractionAndIntervalToIndex：根据插值系数和区间范围计算索引，通常用于实现纹理合并。</p> <h3 id="cesium-广告牌"><a href="#cesium-广告牌" class="header-anchor">#</a> cesium 广告牌</h3> <ol><li>广告牌集合</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 先把广告牌实例化，然后再添加到场景中</span>
<span class="token keyword">const</span> billboardsCollection <span class="token operator">=</span> viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
  <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>BillboardCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

billboardsCollection<span class="token punctuation">.</span>_id <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mark</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token comment">// add的是Billboard，将一个个Billboard添加到集合当中</span>
billboardsCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/mark-icon.png&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
  <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
  position<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>单独一个广告牌</li></ol> <img src="/beifen/725.png"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> billboard <span class="token operator">=</span> viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span>Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">billboard</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;./static/a.jpg&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code> viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">billboard</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;../images/Cesium_Logo_overlay.png&quot;</span><span class="token punctuation">,</span> <span class="token comment">// default: undefined</span>
      <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// default 显示隐藏</span>
      <span class="token literal-property property">pixelOffset</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// default: (0, 0) 图像相对于其锚点的像素偏移量。这里设置为(0, -50)，意味着图像会向下偏移50像素。</span>
      <span class="token literal-property property">eyeOffset</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// default 相对于观察者的偏移量，以米为单位</span>
      <span class="token literal-property property">horizontalOrigin</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>HorizontalOrigin<span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">,</span> <span class="token comment">// default  控制billboard水平方向的锚点。这里设置为Cesium.HorizontalOrigin.CENTER，表示图像的中心将与其位置对齐。</span>
      <span class="token literal-property property">verticalOrigin</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>VerticalOrigin<span class="token punctuation">.</span><span class="token constant">BOTTOM</span><span class="token punctuation">,</span> <span class="token comment">// default: CENTER 控制billboard垂直方向的锚点。</span>
      <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token comment">// default: 1.0 放大背书</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">LIME</span><span class="token punctuation">,</span> <span class="token comment">// default: WHITE 颜色设置</span>
      <span class="token literal-property property">rotation</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token constant">PI_OVER_FOUR</span><span class="token punctuation">,</span> <span class="token comment">// default: 0.0 旋转角度</span>
      <span class="token literal-property property">alignedAxis</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">,</span> <span class="token comment">// default  控制billboard对齐的轴</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// default: undefined</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token comment">// default: undefined</span>
      <span class="token literal-property property">sizeInMeters</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 启用以米为单位的大小</span>
      <span class="token literal-property property">scaleByDistance</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>NearFarScalar</span><span class="token punctuation">(</span><span class="token number">1.5e2</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">1.5e7</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//scaleByDistance属性来根据距离调整billboard的大小。</span>
      <span class="token comment">// 当距离小于或等于150米（1.5e2）时，billboard的缩放比例为2.0（即原始大小的2倍）。</span>
      <span class="token comment">// 当距离大于或等于15,000,000米（1.5e7）时，billboard的缩放比例为0.5（即原始大小的一半）。</span>

      <span class="token comment">// 控制透明度</span>
       <span class="token literal-property property">translucencyByDistance</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>NearFarScalar</span><span class="token punctuation">(</span>  
            <span class="token number">150.0</span><span class="token punctuation">,</span> <span class="token comment">// 近点距离（米），当距离小于或等于这个值时，使用近点透明度  </span>
            <span class="token number">0.0</span><span class="token punctuation">,</span>   <span class="token comment">// 近点透明度（0表示完全透明，1表示完全不透明）  </span>
            <span class="token number">15000000.0</span><span class="token punctuation">,</span> <span class="token comment">// 远点距离（米），当距离大于或等于这个值时，使用远点透明度  </span>
            <span class="token number">0.5</span>    <span class="token comment">// 远点透明度（半透明）  </span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>  
      <span class="token comment">// 类似精灵图</span>
       <span class="token literal-property property">imageSubRegion</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>BoundingRectangle</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-primitivecollection"><a href="#cesium-primitivecollection" class="header-anchor">#</a> cesium PrimitiveCollection</h3> <p>用于创建一个新的 PrimitiveCollection 实例。PrimitiveCollection 是 Cesium 中用于管理渲染原语（primitives）的容器。渲染原语是低层次的图形对象，如点、线、多边形等，它们用于在三维空间中渲染可视元素。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建一个新的 PrimitiveCollection 实例  </span>
<span class="token keyword">var</span> primitives <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>PrimitiveCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// 创建一个点原语  </span>
<span class="token keyword">var</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>PointPrimitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token literal-property property">position</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.59777</span><span class="token punctuation">,</span> <span class="token number">40.03883</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">color</span> <span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">pixelSize</span> <span class="token operator">:</span> <span class="token number">10.0</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// 将点原语添加到 PrimitiveCollection 中  </span>
primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// 将整个 PrimitiveCollection 添加到 Cesium 场景的 primitives 集合中  </span>
viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>primitives<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-boundingrectangle"><a href="#cesium-boundingrectangle" class="header-anchor">#</a> cesium BoundingRectangle</h3> <p>由角、宽度和高度给出的边界矩形。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BoundingRectangle</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>x<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">,</span> y<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">,</span> width<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">,</span> height<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="cesium-nearfarscalar"><a href="#cesium-nearfarscalar" class="header-anchor">#</a> Cesium.NearFarScalar</h3> <p>一个用于定义基于距离变化的标量值（如透明度、缩放比例等）的类。它允许你指定两个距离点（近点和远点）以及在这些距离点上标量值的大小。然后，CesiumJS会根据实体与相机的距离，在这两个点之间线性插值来计算标量值。</p> <h3 id="cesium-颜色控制"><a href="#cesium-颜色控制" class="header-anchor">#</a> cesium 颜色控制</h3> <div class="language-js extra-class"><pre class="language-js"><code> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">LIME</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">withAlpha</span><span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">)</span><span class="token comment">//可设置透明度</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> anotherSemiTransparentRed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 假设 viewModel.silhouetteColor 是从某处获取的 CSS 颜色字符串，比如 &quot;#FF0000&quot;  </span>
<span class="token comment">// 它允许从 CSS 颜色字符串（如 #RRGGBB、#RRGGBBAA、rgb()、rgba()、hsla() 等）中创建一个 Cesium.Color 实例</span>
<span class="token keyword">var</span> silhouetteColor <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token function">fromCssColorString</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">.</span>silhouetteColor<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h2 id="cesium-影像​图层和地形"><a href="#cesium-影像​图层和地形" class="header-anchor">#</a> cesium 影像​图层和地形</h2> <p>Cesium中的影像图层类主要用于在地球表面上加载和显示各种类型的影像数据。这些影像数据可以是地图、卫星图像或其他类型的地理空间数据。影像图层类ImageryLayer提供了将这些数据整合到三维地球中的功能，使用户能够以直观和动态的方式查看和分析地理信息。​</p> <img src="/beifen/736.png"> <p>Cesium中的影像图层类及其功能和可加载的影像类型包括以下内容:</p> <h3 id="cesium-影像图层类​"><a href="#cesium-影像图层类​" class="header-anchor">#</a> cesium 影像图层类​</h3> <p>1.1 ImageryLayer​:ImageryLayer是Cesium中影像图层的基本类。它代表一个影像图层，可以叠加在地球表面，可以控制影像的透明度、亮度、对比度、伽马值（色调）等。​
​
API接口，它接受2个参数​</p> <ul><li>第一个参数：ImageryProvider​</li> <li>第二个参数：设置图层样式​</li></ul> <p>Viewer的options配置​:</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>注意：新版本初始化时使用baseLayer加载图层​</p></div> <p>1.2 添加地址</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>__viewer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Viewer</span><span class="token punctuation">(</span><span class="token string">&quot;cesiumContainer&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>​
    <span class="token comment">// 地形影像​</span>
    <span class="token literal-property property">terrain</span><span class="token operator">:</span> Terrain<span class="token punctuation">.</span><span class="token function">fromWorldTerrain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
    <span class="token comment">// 注意：想用baseLayer，baseLayerPicker必须=false​</span>
    <span class="token literal-property property">baseLayerPicker</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>​
    <span class="token comment">// 自定义加载影像图层，这里先用OSM影像距离，下边具体细说其他图层类​</span>
    <span class="token literal-property property">baseLayer</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ImageryLayer</span><span class="token punctuation">(</span>​
        <span class="token keyword">new</span> <span class="token class-name">OpenStreetMapImageryProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
            <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;https://tile.openstreetmap.org/&quot;</span><span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">)</span>​
    <span class="token punctuation">)</span><span class="token punctuation">,</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
</code></pre></div><p>1.3 动态添加图层​</p> <p>利用<code>__viewer.imageryLayers.add()</code>方法动态添加图层，其中ImageryLayerCollection是__viewer.imageryLayers的实例​</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> imageryLayers <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>__viewer<span class="token punctuation">;</span>​
​
<span class="token keyword">const</span> tms <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageryLayer</span><span class="token punctuation">(</span>​
        <span class="token keyword">new</span> <span class="token class-name">UrlTemplateImageryProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
            <span class="token literal-property property">url</span><span class="token operator">:</span>​
                <span class="token function">buildModuleUrl</span><span class="token punctuation">(</span><span class="token string">&quot;Assets/Textures/NaturalEarthII&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span>​
                <span class="token string">&quot;/{z}/{x}/{reverseY}.jpg&quot;</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">tilingScheme</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">GeographicTilingScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">maximumLevel</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">)</span>​
    <span class="token punctuation">)</span><span class="token punctuation">;</span>​
 imageryLayers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tms<span class="token punctuation">)</span><span class="token punctuation">;</span>​
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addMapbox</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> mapbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageryLayer</span><span class="token punctuation">(</span>​
        <span class="token keyword">new</span> <span class="token class-name">MapboxImageryProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>​
            <span class="token literal-property property">mapId</span><span class="token operator">:</span> <span class="token string">&quot;mapbox.mapbox-terrain-v2&quot;</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">accessToken</span><span class="token operator">:</span> <span class="token string">&quot;自己的mapbox Token&quot;</span><span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">)</span>​
    <span class="token punctuation">)</span><span class="token punctuation">;</span>​
    imageryLayers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mapbox<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**​
 * 添加arcgis图层​
 */</span>​
<span class="token keyword">const</span> <span class="token function-variable function">addArcgis</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> arcgis <span class="token operator">=</span> ImageryLayer<span class="token punctuation">.</span><span class="token function">fromProviderAsync</span><span class="token punctuation">(</span>​
        ArcGisMapServerImageryProvider<span class="token punctuation">.</span><span class="token function">fromBasemapType</span><span class="token punctuation">(</span>​
            ArcGisBaseMapType<span class="token punctuation">.</span><span class="token constant">SATELLITE</span>​
        <span class="token punctuation">)</span>​
    <span class="token punctuation">)</span><span class="token punctuation">;</span>​
    imageryLayers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>arcgis<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium地形"><a href="#cesium地形" class="header-anchor">#</a> cesium地形</h3> <p>为了模拟逼真的三维场景，不仅需要地图影像，还需要有地形，加载一些山地丘陵湖泊等元素，加载地形才能执行一些与高程相关的空间分析和计算。​</p> <p>Cesium提供了TerrainProvider地形基类，但是一般不直接实例化这个类，Cesium基于它衍生出了其他可以实例化的地形大类​,不同于上边的影像图层类可以无限叠加，在一个三维场景中只能加载一个地形类​</p> <img src="/beifen/737.png"> <ol start="2"><li>加载方式​</li></ol> <ul><li>Viewer的options配置​</li></ul> <p>在Viewer中的terrainProvider参数指定，默认值：new EllipsoidTerrainProvider()​</p> <p>option配置</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>__viewer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Viewer</span><span class="token punctuation">(</span><span class="token string">&quot;cesiumContainer&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>​
<span class="token comment">// 地形影像​</span>
    <span class="token literal-property property">terrainProvider</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">EllipsoidTerrainProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>动态配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> terrain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EllipsoidTerrainProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span>terrainProvider <span class="token operator">=</span> terrain<span class="token punctuation">;</span>​
</code></pre></div><h4 id="地形种类​"><a href="#地形种类​" class="header-anchor">#</a> 地形种类​</h4> <ul><li><p>EllipsoidTerrainProvider​：Cesium初始化的默认地形，不支持水面，也没有法向量，所以即使开启光照，也是没有环境效果的。默认的地形全球高度都是0，<code>对于局域网或者无法连接互联网</code>来说是一个不错的选择。​</p></li> <li><p>CesiumTerrainProvider 是 Cesium 中的基本地形提供者类，可以从 Cesium ion 平台直接加载，数据量比较小，支持水面和法向。​</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> terrain <span class="token operator">=</span> <span class="token keyword">await</span> CesiumTerrainProvider<span class="token punctuation">.</span><span class="token function">fromIonAssetId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span>terrainProvider <span class="token operator">=</span> terrain<span class="token punctuation">;</span>
</code></pre></div><ul><li>GoogleEarthEnterpriseTerrainProvider​：用于从 Google Earth Enterprise (GEE) 服务器加载地形数据。GEE 服务器允许用户在私有云或内部网络中托管和访问 Google 地图和地球数据，有相关地形服务的可以尝试下。​</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> geeMetadata <span class="token operator">=</span> <span class="token keyword">await</span> GoogleEarthEnterpriseMetadata<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token keyword">const</span> gee <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>GoogleEarthEnterpriseTerrainProvider<span class="token punctuation">.</span><span class="token function">fromMetadata</span><span class="token punctuation">(</span>geeMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium接入国产地图"><a href="#cesium接入国产地图" class="header-anchor">#</a> cesium接入国产地图</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @cesium-china/cesium-map​
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//高德</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AMapImageryProvider<span class="token punctuation">,</span> BaiduImageryProvider<span class="token punctuation">,</span> TencentImageryProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@cesium-china/cesium-map&quot;</span><span class="token punctuation">;</span>​
<span class="token keyword">const</span> <span class="token function-variable function">addAMap</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>​
        <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;dark&quot;</span><span class="token punctuation">,</span> <span class="token comment">// style: img、elec、cva、dark​</span>
        <span class="token literal-property property">crs</span><span class="token operator">:</span> <span class="token string">&quot;WGS84&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 使用84坐标系，默认为：GCJ02​</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>​
    __viewer<span class="token punctuation">.</span>imageryLayers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ImageryLayer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AMapImageryProvider</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 腾讯</span>
<span class="token keyword">const</span> <span class="token function-variable function">addTencent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>​
        <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//style: img、1：经典​</span>
        <span class="token literal-property property">crs</span><span class="token operator">:</span> <span class="token string">&quot;WGS84&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 使用84坐标系，默认为：GCJ02,​</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>​
    __viewer<span class="token punctuation">.</span>imageryLayers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ImageryLayer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TencentImageryProvider</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// Baidu</span>
<span class="token keyword">const</span> <span class="token function-variable function">addBaidu</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>​
        <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;dark&quot;</span><span class="token punctuation">,</span> <span class="token comment">// style: img、vec、normal、dark​</span>
        <span class="token literal-property property">crs</span><span class="token operator">:</span> <span class="token string">&quot;WGS84&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 使用84坐标系，默认为：GCJ02​</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>​
    __viewer<span class="token punctuation">.</span>imageryLayers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ImageryLayer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BaiduImageryProvider</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>​
</code></pre></div><h2 id="cesium-获取数据"><a href="#cesium-获取数据" class="header-anchor">#</a> cesium 获取数据</h2> <div class="language-js extra-class"><pre class="language-js"><code> Cesium<span class="token punctuation">.</span>Resource<span class="token punctuation">.</span><span class="token function">fetchImage</span><span class="token punctuation">(</span><span class="token string">&quot;../images/Cesium_Logo_overlay.png&quot;</span><span class="token punctuation">)</span> <span class="token comment">//promise</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建一个新的实体并将其添加到Cesium Viewer的实体集合中  </span>
<span class="token keyword">const</span> entity <span class="token operator">=</span> viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token comment">// 设置实体的名称  </span>
    <span class="token comment">// 这里使用url作为名称可能不是最佳选择，因为名称通常用于识别，而URL可能很长且不易读  </span>
    <span class="token comment">// 建议使用更具描述性的名称  </span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> url<span class="token punctuation">,</span>  
      
    <span class="token comment">// 设置实体的位置  </span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> position<span class="token punctuation">,</span>  
      
    <span class="token comment">// 设置实体的方向  </span>
    <span class="token literal-property property">orientation</span><span class="token operator">:</span> orientation<span class="token punctuation">,</span>  
      
    <span class="token comment">// 设置实体的模型属性  </span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
        <span class="token comment">// uri是模型的URI（统一资源标识符），即模型文件的网络地址或本地路径  </span>
        <span class="token comment">// 这里再次使用了url作为模型URI，如果url确实指向一个有效的3D模型文件，则这是可以的  </span>
        <span class="token comment">// 但如果name和model.uri使用了相同的url，则建议为它们分配不同的变量名以增加代码的可读性  </span>
        <span class="token literal-property property">uri</span><span class="token operator">:</span> url<span class="token punctuation">,</span>  
          
        <span class="token comment">// minimumPixelSize定义了模型在屏幕上的最小像素尺寸  </span>
        <span class="token comment">// 这有助于防止在远离时模型变得太小而无法看到  </span>
        <span class="token comment">// 此值设置为128是一个常见的起点，但可以根据需要进行调整  </span>
        <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>  
          
        <span class="token comment">// maximumScale定义了模型可以缩放到的最大比例  </span>
        <span class="token comment">// 这有助于防止在非常接近时模型变得过大  </span>
        <span class="token comment">// 20000可能是一个相对较大的值，具体取决于模型的原始尺寸和所需的缩放效果  </span>
        <span class="token literal-property property">maximumScale</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// 将viewer的trackedEntity属性设置为刚刚创建的实体  </span>
<span class="token comment">// 这将使得当视图（相机）移动时，该实体将被自动跟踪并保持在视图的中心  </span>
<span class="token comment">// 注意，如果实体在地球上移动（例如，通过动态更新其位置），可能需要额外的逻辑来确保相机能够持续跟踪  </span>
viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> entity<span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium矢量数据"><a href="#cesium矢量数据" class="header-anchor">#</a> cesium矢量数据</h3> <p>矢量数据（Vector Data）是用X、Y、Z坐标表示地图图形或地理实体位置的数据，一般是通过记录坐标的方式来将地理实体的空间位置表现的准确无误。​
​
矢量数据类型非常丰富，用于表示点、线、面和其他几何形状。它们可以用于绘制标记、路线、区域等。</p> <h4 id="geojson​"><a href="#geojson​" class="header-anchor">#</a> GeoJSON​</h4> <p>一种基于 JSON 格式的矢量数据格式，支持点、线、多边形等几何类型，并包含属性信息，Cesium中GeoJsonDataSource支持直接加载；​</p> <p>数据示例</p> <div class="language-json extra-class"><pre class="language-json"><code> <span class="token punctuation">{</span>​
     <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;FeatureCollection&quot;</span><span class="token punctuation">,</span>​
     <span class="token property">&quot;features&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>​
        <span class="token punctuation">{</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Feature&quot;</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;geometry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Point&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;coordinates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">-66.0</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">}</span>​
        <span class="token punctuation">}</span><span class="token punctuation">,</span>​
        <span class="token punctuation">{</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Feature&quot;</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;geometry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LineString&quot;</span><span class="token punctuation">,</span>​
            <span class="token property">&quot;coordinates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>​
              <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">33.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">104.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">105.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span>​
              <span class="token punctuation">]</span>​
            <span class="token punctuation">}</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span>​
            <span class="token punctuation">}</span>​
        <span class="token punctuation">}</span><span class="token punctuation">,</span>​
        <span class="token punctuation">{</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Feature&quot;</span><span class="token punctuation">,</span>​
           <span class="token property">&quot;geometry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
             <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Polygon&quot;</span><span class="token punctuation">,</span>​
             <span class="token property">&quot;coordinates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>​
               <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">101.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">101.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>​
                 <span class="token punctuation">[</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>​
               <span class="token punctuation">]</span>​
           <span class="token punctuation">}</span><span class="token punctuation">,</span>​
           <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
             <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span>​
             <span class="token punctuation">}</span>​
         <span class="token punctuation">}</span>​
     <span class="token punctuation">]</span>​
 <span class="token punctuation">}</span>
</code></pre></div><ul><li>FeatureCollection：表示特征集合；​</li> <li>Feature：表示特征；</li> <li>geometry：表示几何体，它有一些子属性：​
<ul><li>type：表示几何体的类型，包含：Point、MultiPoint、LineString、MultiLineString、Polygon、MultiPolygon、GeometryCollection、Feature、FeatureCollection</li> <li>coordinates：描述生成几何体所需要的坐标点位；​</li> <li>properties：几何体一些其它的属性，例如ID，NAME等；</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>GeoJsonDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;/json/chuzhong.geojson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>​
    window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>GeoJsonDataSource 大类可以直接加载和显示 GeoJSON 格式的矢量数据，值得一提的是它还能处理Topojson格式的数据；​</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>GeoJsonDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;/json/chuzhong.geojson&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token comment">// 利用__viewer下的dataSources（是DataSourceCollection的实例）集合去添加解析到的dataSource</span>
    window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>​
​   <span class="token comment">// 根据需求做样式调整</span>
    dataSource<span class="token punctuation">.</span>entities<span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entity</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
        entity<span class="token punctuation">.</span>billboard <span class="token operator">=</span> <span class="token punctuation">{</span>​
            <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/garden-icon.png&quot;</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>​
            <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">;</span>​
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
​
    window<span class="token punctuation">.</span>__viewer<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="kml-keyhole-markup-language-​"><a href="#kml-keyhole-markup-language-​" class="header-anchor">#</a> KML（Keyhole Markup Language）​</h4> <p>一种基于 XML 的格式，用于表示地理数据，广泛用于 Google Earth 等应用，支持复杂的样式和注释。​</p> <p>KML文件有两个文件扩展名：.KML 和.KMZ（一个或几个 KML 文件的压缩集，采用 zip 格式压缩），Cesium中支持KmlDataSource直接加载；</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>​
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kml</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.opengis.net/kml/2.2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>This is a simple point<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Point</span><span class="token punctuation">&gt;</span></span>​
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coordinates</span><span class="token punctuation">&gt;</span></span>-75.59777,40.03883,0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coordinates</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Point</span><span class="token punctuation">&gt;</span></span>​
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Placemark</span><span class="token punctuation">&gt;</span></span>​
    ​
    <span class="token comment">&lt;!-- Line --&gt;</span>​
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Placemark</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>Simple Line<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>This is a simple line<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LineString</span><span class="token punctuation">&gt;</span></span>​
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coordinates</span><span class="token punctuation">&gt;</span></span>​
          -75.10,39.57,0​
          -80.12,25.46,0​
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coordinates</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LineString</span><span class="token punctuation">&gt;</span></span>​
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Placemark</span><span class="token punctuation">&gt;</span></span>​
    ​
    <span class="token comment">&lt;!-- Polygon --&gt;</span>​
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Placemark</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>Simple Polygon<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>This is a simple polygon<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Polygon</span><span class="token punctuation">&gt;</span></span>​
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>outerBoundaryIs</span><span class="token punctuation">&gt;</span></span>​
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearRing</span><span class="token punctuation">&gt;</span></span>​
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>coordinates</span><span class="token punctuation">&gt;</span></span>​
              -109.0,30.0,0​
              -95.0,30.0,0​
              -95.0,40.0,0​
              -109.0,40.0,0​
              -109.0,30.0,0​
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>coordinates</span><span class="token punctuation">&gt;</span></span>​
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearRing</span><span class="token punctuation">&gt;</span></span>​
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>outerBoundaryIs</span><span class="token punctuation">&gt;</span></span>​
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Polygon</span><span class="token punctuation">&gt;</span></span>​
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Placemark</span><span class="token punctuation">&gt;</span></span>​
    ​
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Document</span><span class="token punctuation">&gt;</span></span>​
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kml</span><span class="token punctuation">&gt;</span></span>​
</code></pre></div><ul><li>Document：KML 文件的根元素，用于包含多个地理要素。​</li> <li>Placemark：表示一个地理要素，可以是点、线或多边形。</li> <li>Point：定义一个点，使用 coordinates 元素指定其经度、纬度和高度。​</li> <li>LineString：定义一条线，使用 coordinates 元素指定其路径。</li> <li>Polygon：定义一个多边形，使用 outerBoundaryIs 和 LinearRing 元素指定其边界。​</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addKML</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    __viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">flyHome</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
    __viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>​
        KmlDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;/kml/facilities/facilities.kml&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>​
            <span class="token literal-property property">camera</span><span class="token operator">:</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>camera<span class="token punctuation">,</span>​
            <span class="token literal-property property">canvas</span><span class="token operator">:</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">,</span>​
        <span class="token punctuation">}</span><span class="token punctuation">)</span>​
    <span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>CZML​:CZML 是 Cesium 的专用格式，也是json格式类型，但支持复杂的时间动态数据，可以通过它去渲染与时间有关的动画等。Cesium支持CzmlDataSource类去直接加载；​</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>​
  <span class="token punctuation">{</span>​
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;document&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Dynamic CZML Example&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0&quot;</span>​
  <span class="token punctuation">}</span><span class="token punctuation">,</span>​
  <span class="token punctuation">{</span>​
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dynamicPath&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Dynamic Path&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;availability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-07-01T00:00:00Z/2024-07-02T00:00:00Z&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
      <span class="token property">&quot;material&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
        <span class="token property">&quot;solidColor&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
          <span class="token property">&quot;color&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token property">&quot;rgba&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span>​
          <span class="token punctuation">}</span>​
        <span class="token punctuation">}</span>​
      <span class="token punctuation">}</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;leadTime&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;trailTime&quot;</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;resolution&quot;</span><span class="token operator">:</span> <span class="token number">5</span>​
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
      <span class="token property">&quot;epoch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-07-01T00:00:00Z&quot;</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;cartographicDegrees&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>​
        <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">-75.10</span><span class="token punctuation">,</span> <span class="token number">39.57</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>​
        <span class="token number">3600</span><span class="token punctuation">,</span> <span class="token number">-75.12</span><span class="token punctuation">,</span> <span class="token number">39.58</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>​
        <span class="token number">7200</span><span class="token punctuation">,</span> <span class="token number">-75.14</span><span class="token punctuation">,</span> <span class="token number">39.59</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>​
        <span class="token number">10800</span><span class="token punctuation">,</span> <span class="token number">-75.16</span><span class="token punctuation">,</span> <span class="token number">39.60</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>​
        <span class="token number">14400</span><span class="token punctuation">,</span> <span class="token number">-75.18</span><span class="token punctuation">,</span> <span class="token number">39.61</span><span class="token punctuation">,</span> <span class="token number">0</span>​
      <span class="token punctuation">]</span>​
    <span class="token punctuation">}</span>​
  <span class="token punctuation">}</span>​
<span class="token punctuation">]</span>​
</code></pre></div><h3 id="cesium中使用shp"><a href="#cesium中使用shp" class="header-anchor">#</a> cesium中使用shp</h3> <p>SHP（Shapefile）是一种由ESRI（Environmental Systems Research Institute）开发的地理信息系统（GIS）矢量数据格式，主要用于存储地理空间数据。SHP文件格式广泛应用于各种GIS软件和应用程序中，用来表示和分析地理数据。Shapefile格式由一组文件组成，其中每个文件负责存储不同的信息。通常一个Shapefile包含以下几个主要文件。</p> <p>.shp 文件：这是主文件，包含几何数据，例如点、线和多边形。它存储了空间实体的形状和位置。​
​
.shx 文件：这是索引文件，包含几何数据的索引信息，以便快速访问和查找。它帮助软件快速定位和读取主文件中的几何数据。</p> <p>.dbf 文件：这是属性文件，使用dBASE格式存储每个空间实体的属性数据。例如，如果SHP文件表示一个国家边界，每个国家的名称、人口等信息会存储在这个文件中。​</p> <h3 id="cesium中加载3d模型"><a href="#cesium中加载3d模型" class="header-anchor">#</a> cesium中加载3D模型</h3> <h4 id="gltf模型​"><a href="#gltf模型​" class="header-anchor">#</a> glTF模型​</h4> <p>glTF（GL Transmission Format）是由Khronos Group开发的一种开放标准文件格式，用于高效传输和加载3D模型。它被广泛应用于包括Cesium在内的各种3D应用和平台。glTF旨在提供一种简洁且高效的方式来传输和展示3D模型。​glTF作为一种高效、轻量的3D模型传输格式，具有快速加载、高质量表现和广泛兼容性的优势，非常适合在Cesium中使用。​</p> <p>glTF 格式有两种：​</p> <p>*.glb：基于二进制的二进制文件，通常用于传输和加载，不支持编辑；</p> <p>*.gltf： 基于JSON的文本文件，可使用文本编辑器轻松编辑，通常会引用外部文件，例如纹理贴图、二进制网格数据等；</p> <p>如果使用VS Code编辑器，建议安装 glTF Tools 扩展工具，能够非常方便的查看glTF的数据结构、glTF和glb互转等。​</p> <img src="/beifen/739.png"> <ul><li>scene： glTF格式的场景结构描述条目。它通过引用node来定义场景图；​</li> <li>node： 场景图层次中的一个节点。它可以包含一个变换(比如旋转或平移)，并且可以引用其他（子）节点 。此外，它可以引用网格和相机，以及描述网格变换的蒙皮；</li> <li>camera： 定义了用于渲染场景的视锥体配置；​</li> <li>mesh： 描述了出现在场景中几何对象实际的几何数据。它是指accessor用于访问实际几何数据material的对象，并且是指在渲染对象时定义其外观的 ；</li> <li>skin： 定义了用于蒙皮的参数，参数的值通过一个accessor对象获得。​</li> <li>animation： 描述了一些结点如何随时间进行变换的动画(比如旋转或平移)；</li> <li>accessor： 一个访问任意数据的抽象数据源。被mesh、skin和animation元素使用来提供几何数据、蒙皮参数和基于时间的动画值。它通过引用一个bufferView对象，来引用实际的二进制数据；​</li> <li>material： 包含了定义3D对象外观的参数。它通常引用了用于3D对象渲染的texture对象；</li> <li>texture： 定义了一个sampler对象和一个image对象。sampler对象定义了image对象在3D对象上的张贴方式。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addGltf</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&quot;/models/31.gltf&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> entity <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> url<span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> position<span class="token punctuation">,</span>
    <span class="token literal-property property">orientation</span><span class="token operator">:</span> orientation<span class="token punctuation">,</span> <span class="token comment">// 获取或设置相对于地球固定地球中心 （ECEF） 的方向。默认为实体位置的东北偏东。</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">uri</span><span class="token operator">:</span> url<span class="token punctuation">,</span>
      <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      <span class="token literal-property property">maximumScale</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><img src="/beifen/740.png"> <h4 id="_3d-tiles​"><a href="#_3d-tiles​" class="header-anchor">#</a> 3D Tiles​</h4> <p>Cesium中的3D Tiles是一种用于高效传输和渲染大规模3D地理数据的开源标准。它主要用于在Web浏览器中展示包含数百万或数十亿几何体的复杂三维场景，如城市模型、建筑物、点云数据、地形数据等。3D Tiles的设计目标是通过空间分割和层级细化技术，实现对大规模数据的流畅浏览和交互。​</p> <p>3D Tiles的主要概念和组件:</p> <ol><li>Tileset：​一个Tileset是由许多瓦片（Tile）组成的树状结构，用于管理和组织3D Tiles数据。每个Tileset的根节点定义了整个数据集的边界和元数据。</li> <li>Tile：​每个Tile包含了一部分3D数据，并且可以引用其子Tile。Tile可以包含几种不同类型的数据，如Batched 3D Model（b3dm）、Instanced 3D Model（i3dm）、点云（pnts）、地形（terrain）、矢量数据（vector data）等。</li> <li>LOD（Level of Detail）：​通过层级细化（Level of Detail, LOD）技术，不同层级的Tile包含不同分辨率的数据。视图靠近时会加载更高分辨率的Tile，视图远离时则加载低分辨率的Tile，以减少数据传输量和渲染负担。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">add3DTiles</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&quot;/models/changsha/tileset.json&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> tilesetUrl <span class="token operator">=</span> <span class="token keyword">await</span> Cesium3DTileset<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Cesium3DTileset from cesium</span>
  tileset <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tilesetUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span><span class="token function">flyTo</span><span class="token punctuation">(</span>tileset<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><img src="/beifen/741.png"> <h4 id="czml矢量数据​"><a href="#czml矢量数据​" class="header-anchor">#</a> CZML矢量数据​</h4> <p>CZML（Cesium Language）也是一种基于JSON的格式，用于描述时间动态场景中的3D数据。CZML可以表示不同类型的几何图形、模型、路径、标签和其他图形元素，特别适用于需要时间动态更新的场景，例如卫星轨道、飞机航迹等。​</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>​
  <span class="token punctuation">{</span>​
    <span class="token property">&quot;clock&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
      <span class="token property">&quot;interval&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-07-29T00:00:00Z/2024-07-29T24:00:00Z&quot;</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;currentTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-07-29T00:00:00Z&quot;</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;multiplier&quot;</span><span class="token operator">:</span> <span class="token number">60</span>​
    <span class="token punctuation">}</span>​
  <span class="token punctuation">}</span><span class="token punctuation">,</span>​
  <span class="token punctuation">{</span>​
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;availability&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-07-29T00:00:00Z/2024-07-29T24:00:00Z&quot;</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
      <span class="token property">&quot;material&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
        <span class="token property">&quot;polylineOutline&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
          <span class="token property">&quot;color&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token property">&quot;rgba&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span>​
          <span class="token punctuation">}</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;outlineColor&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
            <span class="token property">&quot;rgba&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span>​
          <span class="token punctuation">}</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;outlineWidth&quot;</span><span class="token operator">:</span> <span class="token number">2</span>​
        <span class="token punctuation">}</span>​
      <span class="token punctuation">}</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;leadTime&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;trailTime&quot;</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;resolution&quot;</span><span class="token operator">:</span> <span class="token number">5</span>​
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;position&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>​
      <span class="token property">&quot;epoch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-07-29T00:00:00Z&quot;</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;cartographicDegrees&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>​
        <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">,</span>​
        <span class="token number">3600</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">,</span>​
        <span class="token number">7200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">,</span>​
        <span class="token number">10800</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">1000000</span>​
      <span class="token punctuation">]</span>​
    <span class="token punctuation">}</span>​
  <span class="token punctuation">}</span>​
<span class="token punctuation">]</span>
</code></pre></div><p>这段JSON代码定义了一个CZML（Cesium Language）文档，用于在Cesium中显示一个时间动态的路径​</p> <ul><li><p>id: &quot;document&quot;​ ,标识符，表示这是一个文档级别的对象。</p></li> <li><p>version: &quot;1.0&quot;​ ,CZML版本，当前为1.0。</p></li> <li><p>clock: ​</p> <ul><li>interval: &quot;2024-07-29T00:00:00Z/2024-07-29T24:00:00Z&quot; 表示时间范围，从2024年7月29日的00:00:00到24:00:00。​</li> <li>currentTime: &quot;2024-07-29T00:00:00Z&quot;​ 初始时间设置为2024年7月29日的00:00:00。​</li> <li>multiplier: 60​ 时间的流速，时间会以真实时间的60倍速流逝。</li></ul></li> <li><p>id: &quot;path&quot;​ ,标识符，表示这是一个路径对象。</p></li> <li><p>availability: &quot;2024-07-29T00:00:00Z/2024-07-29T24:00:00Z&quot;​ ,路径的有效时间范围，从2024年7月29日的00:00:00到24:00:00。</p></li> <li><p>【path对象】​</p> <ul><li>material:​
<ol><li>polylineOutline:
<ol><li>color:​rgba: [255, 0, 0, 255] 路径的颜色，红色，不透明（RGBA: 红色，绿色，蓝色，透明度）。​</li> <li>outlineColor:​ rgba: [0, 0, 0, 255] 路径轮廓的颜色，黑色，不透明。​</li> <li>outlineWidth: 2​路径轮廓的宽度为2个像素。</li></ol></li> <li>width: 5​ 路径的宽度为5个像素。</li> <li>leadTime: 0​ 路径前导时间，为0秒。</li> <li>trailTime: 60​ 路径拖尾时间，为60秒。</li> <li>resolution: 5​ 路径的分辨率，为5秒。</li></ol></li></ul></li> <li><p>【position对象】​</p> <ul><li>epoch: &quot;2024-07-29T00:00:00Z&quot;​ 位置数据的基准时间为2024年7月29日的00:00:00。</li> <li>cartographicDegrees:​位置数据，以经度、纬度、高度的顺序排列，单位为度和米。时间间隔（以秒为单位）与位置数据配对。
<ol><li>数据解释：​ 第1组：时间0秒，位置为(0°经度, 0°纬度, 1000000米高度)。</li> <li>第2组：时间3600秒（1小时），位置为(10°经度, 10°纬度, 1000000米高度)。​</li> <li>第3组：时间7200秒（2小时），位置为(20°经度, 20°纬度, 1000000米高度)。</li> <li>第4组：时间10800秒（3小时），位置为(30°经度, 30°纬度, 1000000米高度)。​</li></ol></li></ul></li></ul> <p>这段CZML定义了一个文档，其中包括一个在2024年7月29日全天有效的路径。该路径以红色显示，带有黑色轮廓，并且会根据时间动态更新位置。路径的宽度为5像素，拖尾时间为60秒，分辨率为5秒。路径的起点在0°经度、0°纬度，高度为1000000米，并且每小时更新一次位置，最终到达30°经度、30°纬度。​</p> <blockquote><p>注意：czml加载的模型格式通常是glb格式​</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addCZML</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> czml <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;document&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;CZML Model&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&quot;1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;aircraft model&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Cesium Air&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">cartographicDegrees</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">gltf</span><span class="token operator">:</span> <span class="token string">&quot;/models/Cesium_Air.glb&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">2.0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">/**
   * __viewer.clock 是与视图器（viewer）相关联的一个时钟对象，它负责控制时间流的模拟。
   * Cesium是一个用于创建3D地球、2D地图和地球仪的开源JavaScript库，
   * 它支持多种时间动态的数据可视化，比如卫星轨道、飞行路径、气象数据等。
   */</span>
  __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>dataSources
    <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>CzmlDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>czml<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// CzmlDataSource from cesium</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取或设置相机当前正在跟踪的 Entity 实例。</span>
      __viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> dataSource<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;aircraft model&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><img src="/beifen/742.png"> <h4 id="czml实际应用"><a href="#czml实际应用" class="header-anchor">#</a> czml实际应用</h4> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>​
  <span class="token punctuation">{</span>​
      <span class="token property">&quot;minimumPixelSize&quot;</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 模型最小值​</span>
      <span class="token property">&quot;maximumScale&quot;</span><span class="token operator">:</span><span class="token number">50</span> <span class="token comment">// 最大缩放值​</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;orientation&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 定义对象的旋转状态​</span>
      <span class="token property">&quot;velocityReference&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#position&quot;</span> <span class="token comment">// 用于指定对象的朝向是基于其速度向量（velocity vector）的。这里的 &quot;#position&quot; 表示这个 CZML 对象的速度是根据其 position 属性的变化来计算的。​</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;viewFrom&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 定义观察者相对于对象的位置。通常用于设置默认视角位置​</span>
      <span class="token property">&quot;cartesian&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">-2080</span><span class="token punctuation">,</span> <span class="token number">-1715</span><span class="token punctuation">,</span> <span class="token number">779</span> <span class="token punctuation">]</span>​
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 定义对象的自定义属性。这些属性可以是动态的，可以随时间变化，并且可以包含复杂的时间序列数据。​</span>
        <span class="token property">&quot;fuel_remaining&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 自定义汽车的油量属性，表示某一时刻的剩余燃料量​</span>
            <span class="token property">&quot;epoch&quot;</span><span class="token operator">:</span><span class="token string">&quot;2012-08-04T16:00:00Z&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 时间基准点，表示数据开始的时间。这是所有后续时间点的参考。​</span>
            <span class="token property">&quot;number&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 一个数组，定义了时间序列数据。​</span>
                <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">22.5</span><span class="token punctuation">,</span> <span class="token comment">// 表示在 epoch 时刻（2012-08-04T16:00:00Z），也就是0秒刚开始的时候，燃料为 22.5 单位​</span>
                <span class="token number">1500</span><span class="token punctuation">,</span> <span class="token number">21.2</span> <span class="token comment">// 表示在 epoch 之后的 1500 秒，燃料降至 21.2 单位​</span>
            <span class="token punctuation">]</span>​
        <span class="token punctuation">}</span>​
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token comment">// 模型移动轨迹​</span>
      <span class="token property">&quot;material&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>​
          <span class="token property">&quot;solidColor&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>​
            <span class="token property">&quot;color&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>​
                <span class="token property">&quot;interval&quot;</span><span class="token operator">:</span><span class="token string">&quot;2012-08-04T16:00:00Z/2012-08-04T16:25:00Z&quot;</span><span class="token punctuation">,</span>​
                <span class="token property">&quot;rgba&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>​
                  <span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span>​
                <span class="token punctuation">]</span>​
              <span class="token punctuation">}</span>​
            <span class="token punctuation">}</span>​
      <span class="token punctuation">}</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;width&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span> <span class="token comment">// 轨迹线的宽度​</span>
        <span class="token punctuation">{</span>​
          <span class="token property">&quot;interval&quot;</span><span class="token operator">:</span><span class="token string">&quot;2012-08-04T16:00:00Z/2012-08-04T16:25:00Z&quot;</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;number&quot;</span><span class="token operator">:</span><span class="token number">5.0</span>​
        <span class="token punctuation">}</span>​
      <span class="token punctuation">]</span><span class="token punctuation">,</span>​
      <span class="token property">&quot;show&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>​
        <span class="token punctuation">{</span>​
          <span class="token property">&quot;interval&quot;</span><span class="token operator">:</span><span class="token string">&quot;2012-08-04T16:00:00Z/2012-08-04T16:25:00Z&quot;</span><span class="token punctuation">,</span>​
          <span class="token property">&quot;boolean&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>​
        <span class="token punctuation">}</span>​
      <span class="token punctuation">]</span>​
    <span class="token punctuation">}</span><span class="token punctuation">,</span>​
    <span class="token property">&quot;position&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token comment">// 运动轨迹的坐标位置​</span>
      <span class="token property">&quot;interpolationAlgorithm&quot;</span><span class="token operator">:</span><span class="token string">&quot;LAGRANGE&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定用于插值位置数据的算法​</span>
      <span class="token property">&quot;interpolationDegree&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 指定插值算法的多项式阶数，决定了用于插值的多项式的复杂程度​</span>
      <span class="token property">&quot;epoch&quot;</span><span class="token operator">:</span><span class="token string">&quot;2012-08-04T16:00:00Z&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 时间基准点​</span>
      <span class="token property">&quot;cartesian&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span> <span class="token comment">// 坐标数据，每排第一个数是时间，以秒为单位，后边3个数是坐标xyz​</span>
        <span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">-2379754.6637012</span><span class="token punctuation">,</span><span class="token number">-4665332.88013588</span><span class="token punctuation">,</span><span class="token number">3628133.68924173</span><span class="token punctuation">,</span>​
        <span class="token number">10.0</span><span class="token punctuation">,</span><span class="token number">-2379510.08905552</span><span class="token punctuation">,</span><span class="token number">-4665419.64840452</span><span class="token punctuation">,</span><span class="token number">3628182.20006795</span><span class="token punctuation">,</span>​
        <span class="token number">20.0</span><span class="token punctuation">,</span><span class="token number">-2379568.4769522</span><span class="token punctuation">,</span><span class="token number">-4665555.3441867</span><span class="token punctuation">,</span><span class="token number">3627970.83323261</span><span class="token punctuation">,</span>​
        <span class="token number">30.0</span><span class="token punctuation">,</span><span class="token number">-2379638.93786855</span><span class="token punctuation">,</span><span class="token number">-4665691.63561896</span><span class="token punctuation">,</span><span class="token number">3627750.82085873</span><span class="token punctuation">,</span>​
        <span class="token number">40.0</span><span class="token punctuation">,</span><span class="token number">-2379709.29834665</span><span class="token punctuation">,</span><span class="token number">-4665827.9679646</span><span class="token punctuation">,</span><span class="token number">3627530.80187124</span><span class="token punctuation">,</span>​
        <span class="token number">50.0</span><span class="token punctuation">,</span><span class="token number">-2379837.28064915</span><span class="token punctuation">,</span><span class="token number">-4665847.7494347</span><span class="token punctuation">,</span><span class="token number">3627422.12874017</span><span class="token punctuation">,</span>​
        <span class="token number">60.0</span><span class="token punctuation">,</span><span class="token number">-2379624.98289073</span><span class="token punctuation">,</span><span class="token number">-4665907.50853722</span><span class="token punctuation">,</span><span class="token number">3627484.1191848</span><span class="token punctuation">,</span>​
        <span class="token number">70.0</span><span class="token punctuation">,</span><span class="token number">-2379386.12743523</span><span class="token punctuation">,</span><span class="token number">-4666029.54174431</span><span class="token punctuation">,</span><span class="token number">3627483.83297459</span><span class="token punctuation">,</span>​
        <span class="token number">80.0</span><span class="token punctuation">,</span><span class="token number">-2379147.26777171</span><span class="token punctuation">,</span><span class="token number">-4666151.56669944</span><span class="token punctuation">,</span><span class="token number">3627483.5403492</span><span class="token punctuation">,</span>​
        <span class="token number">90.0</span><span class="token punctuation">,</span><span class="token number">-2378908.40390057</span><span class="token punctuation">,</span><span class="token number">-4666273.58340244</span><span class="token punctuation">,</span><span class="token number">3627483.24130864</span><span class="token punctuation">,</span>​
        <span class="token number">1e2</span><span class="token punctuation">,</span><span class="token number">-2378663.69301645</span><span class="token punctuation">,</span><span class="token number">-4666379.62408751</span><span class="token punctuation">,</span><span class="token number">3627507.14485116</span><span class="token punctuation">,</span>​
        <span class="token number">110.0</span><span class="token punctuation">,</span><span class="token number">-2378416.29648478</span><span class="token punctuation">,</span><span class="token number">-4666444.93145547</span><span class="token punctuation">,</span><span class="token number">3627584.82610021</span><span class="token punctuation">,</span>​
        <span class="token number">120.0</span><span class="token punctuation">,</span><span class="token number">-2378184.75115833</span><span class="token punctuation">,</span><span class="token number">-4666458.05260387</span><span class="token punctuation">,</span><span class="token number">3627718.84628509</span><span class="token punctuation">,</span>​
<span class="token punctuation">]</span>​

</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onStart<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>开始移动<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onClock<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>实时获取汽车油量<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onStop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>暂停动画<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onResume<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>恢复动画<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isShowText<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">top</span><span class="token punctuation">:</span> 40px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> #009900<span class="token punctuation">;</span> <span class="token property">font-size</span><span class="token punctuation">:</span> 20px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>汽车油量剩余：{{ fuel }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> onUnmounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CzmlDataSource <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;cesium&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> __viewer <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">;</span>
<span class="token keyword">let</span> carEntity<span class="token punctuation">;</span>
<span class="token keyword">const</span> fuel <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">22.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isShowText <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">onStart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>dataSources
    <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>CzmlDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;/czml/MultipartVehicle_part1.czml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取或设置相机当前正在跟踪的 Entity 实例。</span>
      carEntity <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> dataSource<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;Vehicle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onClock</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isShowText<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>onTick<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">clock</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>carEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> _fuel <span class="token operator">=</span> carEntity<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>fuel_remaining<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>clock<span class="token punctuation">.</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      fuel<span class="token punctuation">.</span>value <span class="token operator">=</span> _fuel<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onStop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onResume</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="kml​"><a href="#kml​" class="header-anchor">#</a> KML​</h4> <p>KML（Keyhole Markup Language）是一种用于描述地理数据的XML格式，最初由Keyhole公司开发，并在2008年被Google标准化为OGC（开放地理空间联盟）标准。​</p> <p>通过Cesium.KmlDataSource加载全球的所有国家的三维区域模型</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addKML</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  __viewer<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">flyHome</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    KmlDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;/kml/gdpPerCapita2008.kmz&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">camera</span><span class="token operator">:</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>camera<span class="token punctuation">,</span>
      <span class="token literal-property property">canvas</span><span class="token operator">:</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>canvas<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><img src="/beifen/743.png"> <h3 id="cesium-clock"><a href="#cesium-clock" class="header-anchor">#</a> cesium clock</h3> <p>Clock 是一个用于模拟和控制时间流动的对象。它为场景中的时间管理提供了统一的接口，并用于协调动态对象（如卫星、飞机等）在虚拟时间轴上的行为。Clock 对象可以模拟不同的时间速率和方向，以及启动和暂停时间流动。​</p> <p>Clock 的作用​
​</p> <ol><li>时间模拟：Clock 提供了一种机制来模拟现实时间的流逝，可以设置时间的速率、方向和起始时间。​</li> <li>协调场景内的动态实体：许多动态实体（例如，CZML 描述的对象）依赖 Clock 来更新它们的位置和状态。Clock 允许开发者同步这些对象在场景中的变化。​</li> <li>控制动画：通过 Clock，可以实现暂停、快进、慢放等效果，使得用户可以更好地观察动态过程。​</li></ol> <p>Clock 的主要属性​
​</p> <ol><li>startTime：模拟时间的起始点。表示场景模拟的开始时间。​</li> <li>stopTime：模拟时间的结束点。通常用于限制时间范围。​</li> <li>currentTime：场景当前的模拟时间。它会随着时间推进而改变。​</li> <li>multiplier：控制时间的流速。例如，multiplier 为 2 时，时间流逝速度是实际时间的两倍。​</li> <li>clockStep：定义 Clock 如何推进时间，包括 TICK_DEPENDENT、SYSTEM_CLOCK 和 SYSTEM_CLOCK_MULTIPLIER 三种方式。​</li></ol> <ul><li>TICK_DEPENDENT: 每次渲染帧时时间推进一个固定的步长。​</li> <li>SYSTEM_CLOCK: 使用系统时钟。​</li> <li>SYSTEM_CLOCK_MULTIPLIER: 使用系统时钟并乘以 multiplier。​</li></ul> <ol start="6"><li>clockRange：定义 Clock 如何处理时间范围的结束，包括 UNBOUNDED、CLAMPED 和 LOOP_STOP。​</li></ol> <ul><li>UNBOUNDED: 时间无界，继续推进。​</li> <li>CLAMPED: 到达 stopTime 后停止。​</li> <li>LOOP_STOP: 到达 stopTime 后回到 startTime。​</li></ul> <p>主要方法​: 推进时间，通常在每一帧中调用，更新 currentTime。​</p> <p>应用场景​
​</p> <ol><li>动态对象模拟：例如，模拟卫星在轨道上运行的过程，通过调整时间流速可以快速查看卫星在不同时间点的位置。​</li> <li>历史数据回放：使用 Clock 可以重现和分析历史事件的数据，观察事件如何随时间变化。​</li> <li>实时监控：通过同步 Clock 和实际时间，可以实现对实时数据的可视化，如跟踪飞行中的航班。​</li> <li>教学和演示：在教育场景中，通过调整时间速率，可以更好地展示和解释复杂的时间相关过程。​</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 直接通过viewer.clock获取Clock类的实例，然后通过onTick事件监听时间推进​</span>
carEntity <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> dataSource<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;Vehicle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
__viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>onTick<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">clock</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>​
    <span class="token keyword">const</span> _fuel <span class="token operator">=</span> carEntity<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>fuel_remaining<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>clock<span class="token punctuation">.</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>​
    fuel<span class="token punctuation">.</span>value <span class="token operator">=</span> _fuel<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>​
</code></pre></div><h3 id="cesium-knockout"><a href="#cesium-knockout" class="header-anchor">#</a> Cesium.knockout</h3> <p>绑定页面上的元素后，监控数据的变化更新视图</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//将viewModel成员转换为Knockout可观察对象（Observables）</span>
Cesium<span class="token punctuation">.</span>knockout<span class="token punctuation">.</span><span class="token function">track</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//页面元素toolbar</span>
<span class="token keyword">const</span> toolbar <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;toolbar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Cesium<span class="token punctuation">.</span>knockout<span class="token punctuation">.</span><span class="token function">applyBindings</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">,</span> toolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>
Cesium<span class="token punctuation">.</span>knockout
  <span class="token punctuation">.</span><span class="token function">getObservable</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">,</span> <span class="token string">&quot;color&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    entity<span class="token punctuation">.</span>model<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token function">getColor</span><span class="token punctuation">(</span>newValue<span class="token punctuation">,</span> viewModel<span class="token punctuation">.</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cesium-粒子系统"><a href="#cesium-粒子系统" class="header-anchor">#</a> cesium 粒子系统</h3> <p>粒子系统是一种图形技术，用于模拟复杂的基于物理的效果。粒子系统是小图像的集合，当它们密集的密布在一个空间里时聚集在一起看的时候，会形成一个更复杂的“模糊”对象，例如火焰、烟雾、雨雪雾或烟花。通过设定初始位置、速度和生命周期等属性指定单个粒子的行为来实现这些复杂的效果。可以说粒子系统控制着每个粒子对象随着时间的显示和变化​
​
Cesium中提供了<strong>ParticleSystem类</strong> ，用来支持构建常见的粒子效果。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>baseParticle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>基础粒子<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>boxEmitter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>盒子发射器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>coneEmitter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>锥体发射器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sphereEmitter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>球体发射器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>onBursts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>粒子爆裂<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>updateCallback<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>粒子更新<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>openWater<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>喷水效果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clear<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>清空<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">top</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>openWater<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>喷水效果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OperateBox</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">top</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>toolbar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>Gravity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-20.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">step</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value: gravity, valueUpdate: 'input'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value: gravity<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>OperateBox</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Cesium <span class="token keyword">from</span> <span class="token string">&quot;cesium&quot;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> __viewer <span class="token punctuation">}</span> <span class="token operator">=</span> window
__viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> smokeParticle <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> adjustedModelMatrix <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> carEntity <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">const</span> <span class="token function-variable function">baseParticle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">uri</span><span class="token operator">:</span> <span class="token string">&quot;/czml/CesiumMilkTruck.glb&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">94.6</span><span class="token punctuation">,</span> <span class="token number">41.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> carEntity<span class="token punctuation">;</span>
  <span class="token comment">// 计算汽车当前时间的模型矩阵</span>
  <span class="token keyword">let</span> modelMatrix <span class="token operator">=</span> carEntity<span class="token punctuation">.</span><span class="token function">computeModelMatrix</span><span class="token punctuation">(</span>
    __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>startTime<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 定义平移向量</span>
  <span class="token keyword">let</span> translation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// </span>

  <span class="token comment">// 对模型矩阵进行平移</span>
  adjustedModelMatrix <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Matrix4<span class="token punctuation">.</span><span class="token function">multiplyByTranslation</span><span class="token punctuation">(</span>
    modelMatrix<span class="token punctuation">,</span>
    translation<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  smokeParticle <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ParticleSystem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/smoke.png&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">imageSize</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">startScale</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">endScale</span><span class="token operator">:</span> <span class="token number">4.0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">particleLife</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">emitter</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CircleEmitter</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">emissionRate</span><span class="token operator">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">modelMatrix</span><span class="token operator">:</span> adjustedModelMatrix<span class="token punctuation">,</span>
      <span class="token literal-property property">lifetime</span><span class="token operator">:</span> <span class="token number">16.0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 不同的发射器</span>
<span class="token keyword">const</span> <span class="token function-variable function">boxEmitter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span>
  smokeParticle<span class="token punctuation">.</span>emissionRate <span class="token operator">=</span> <span class="token number">20</span>
  smokeParticle<span class="token punctuation">.</span>emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>BoxEmitter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">coneEmitter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span>
  smokeParticle<span class="token punctuation">.</span>emissionRate <span class="token operator">=</span> <span class="token number">20</span>
  smokeParticle<span class="token punctuation">.</span>emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ConeEmitter</span><span class="token punctuation">(</span>Cesium<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">toRadians</span><span class="token punctuation">(</span><span class="token number">30.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 30度转弧度渲染</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">sphereEmitter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span>
  smokeParticle<span class="token punctuation">.</span>emissionRate <span class="token operator">=</span> <span class="token number">20</span>
  smokeParticle<span class="token punctuation">.</span>emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>SphereEmitter</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span> <span class="token comment">// 半径5</span>
<span class="token punctuation">}</span>
<span class="token comment">// ParticleSystem里有个bursts属性，以在指定时间发射粒子突发，模拟粒子爆炸。​</span>
<span class="token keyword">const</span> <span class="token function-variable function">onBursts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span>
  smokeParticle<span class="token punctuation">.</span>emissionRate <span class="token operator">=</span> <span class="token number">0</span>
  smokeParticle<span class="token punctuation">.</span>bursts <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ParticleBurst</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token comment">// 粒子系统生命周期开始后发生爆发的时间（以秒为单位）。</span>
      <span class="token literal-property property">minimum</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token comment">// 最小粒子数</span>
      <span class="token literal-property property">maximum</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token comment">// 最大粒子数</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ParticleBurst</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token literal-property property">minimum</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token literal-property property">maximum</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ParticleBurst</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token number">15.0</span><span class="token punctuation">,</span> <span class="token literal-property property">minimum</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token literal-property property">maximum</span><span class="token operator">:</span> <span class="token number">300</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> viewModel <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">gravity</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Cesium<span class="token punctuation">.</span>knockout<span class="token punctuation">.</span><span class="token function">track</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Cesium<span class="token punctuation">.</span>knockout<span class="token punctuation">.</span><span class="token function">applyBindings</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;toolbar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> gravityScratch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">updateCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">true</span>
  smokeParticle<span class="token punctuation">.</span><span class="token function-variable function">updateCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">particle<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> position <span class="token operator">=</span> particle<span class="token punctuation">.</span>position<span class="token punctuation">;</span>
    <span class="token comment">// 归一化处理</span>
    Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> gravityScratch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 计算重力影响：根据 viewModel.gravity 和时间增量 dt，计算重力向粒子速度的影响，并存储在 gravityScratch 中</span>
    Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">multiplyByScalar</span><span class="token punctuation">(</span>
      gravityScratch<span class="token punctuation">,</span>
      viewModel<span class="token punctuation">.</span>gravity <span class="token operator">*</span> dt<span class="token punctuation">,</span>
      gravityScratch
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 更新粒子速度，将计算后的重力向量加到粒子的速度向量上，更新粒子的运动状态。</span>
    particle<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
      particle<span class="token punctuation">.</span>velocity<span class="token punctuation">,</span>
      gravityScratch<span class="token punctuation">,</span>
      particle<span class="token punctuation">.</span>velocity
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">openWater</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  carEntity <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">uri</span><span class="token operator">:</span> <span class="token string">&quot;/czml/CesiumMilkTruck.glb&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">94.6</span><span class="token punctuation">,</span> <span class="token number">41.8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  __viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> carEntity<span class="token punctuation">;</span>
  <span class="token comment">// 计算汽车当前时间的模型矩阵</span>
  <span class="token keyword">let</span> modelMatrix <span class="token operator">=</span> carEntity<span class="token punctuation">.</span><span class="token function">computeModelMatrix</span><span class="token punctuation">(</span>
    __viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>startTime<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 定义平移向量</span>
  <span class="token keyword">let</span> translation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 根据右手坐标系，x轴粒子应该往左移动若干举例，暂定-2.5</span>

  <span class="token comment">// 对模型矩阵进行平移 使用Cesium.Matrix4.multiplyByTranslation，将变换矩阵modelMatrix乘以由笛卡尔 3 定义的隐式平移矩阵​</span>
  adjustedModelMatrix <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Matrix4<span class="token punctuation">.</span><span class="token function">multiplyByTranslation</span><span class="token punctuation">(</span>
    modelMatrix<span class="token punctuation">,</span>
    translation<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Matrix4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  smokeParticle <span class="token operator">=</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>ParticleSystem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">&quot;/images/smoke.png&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定粒子的图像纹理，这里是烟雾效果的图片。​</span>
      <span class="token literal-property property">imageSize</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Cartesian2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//粒子的初始大小，以像素为单位。Cartesian2对象表示二维向量，这里设置粒子图像的宽度和高度为20像素。​</span>
      <span class="token literal-property property">startScale</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span><span class="token comment">//粒子开始时的缩放比例。1.0表示粒子将按原始大小开始。​</span>
      <span class="token literal-property property">endScale</span><span class="token operator">:</span> <span class="token number">4.0</span><span class="token punctuation">,</span><span class="token comment">//粒子消失前的缩放比例。4.0表示粒子在消亡前会逐渐扩大到原始大小的4倍。​</span>
      <span class="token literal-property property">particleLife</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span><span class="token comment">//每个粒子的寿命，以秒为单位。1.0表示粒子将在1秒后消亡。</span>
      <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span><span class="token comment">//粒子的发射速度，以米每秒为单位。5.0表示粒子将以5米每秒的速度从发射器发射出来。​</span>
      <span class="token literal-property property">emitter</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CircleEmitter</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//粒子的发射器类型，这里是一个圆形发射器，半径为0.5米。粒子将从这个圆形区域内随机发射。​</span>
      <span class="token literal-property property">emissionRate</span><span class="token operator">:</span> <span class="token number">20.0</span><span class="token punctuation">,</span><span class="token comment">//粒子的发射率，即每秒发射的粒子数量。20.0表示每秒发射20个粒子。​</span>
      <span class="token literal-property property">modelMatrix</span><span class="token operator">:</span> adjustedModelMatrix<span class="token punctuation">,</span><span class="token comment">//粒子系统的位置和方向由modelMatrix确定。</span>
      <span class="token literal-property property">lifetime</span><span class="token operator">:</span> <span class="token number">16.0</span><span class="token punctuation">,</span><span class="token comment">//整个粒子系统的寿命，以秒为单位。16.0表示这个粒子系统将在16秒后被销毁。​</span>
      <span class="token function-variable function">updateCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">particle<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> position <span class="token operator">=</span> particle<span class="token punctuation">.</span>position<span class="token punctuation">;</span>
        Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> gravityScratch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromElements</span><span class="token punctuation">(</span>
          <span class="token operator">-</span><span class="token number">10</span> <span class="token operator">*</span> dt<span class="token punctuation">,</span>
          gravityScratch<span class="token punctuation">.</span>y <span class="token operator">*</span> dt<span class="token punctuation">,</span>
          <span class="token operator">-</span><span class="token number">20</span> <span class="token operator">*</span> dt<span class="token punctuation">,</span>
          gravityScratch
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        particle<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
          particle<span class="token punctuation">.</span>velocity<span class="token punctuation">,</span>
          gravityScratch<span class="token punctuation">,</span>
          particle<span class="token punctuation">.</span>velocity
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  smokeParticle <span class="token operator">&amp;&amp;</span> __viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>smokeParticle<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><!----> <p>https://blog.csdn.net/qq_34447899/article/details/123224443</p> <p>https://www.cnblogs.com/s313139232/p/14317366.html</p> <p>https://juejin.cn/post/7316968265057583114</p> <p>https://blog.csdn.net/qq_41400354/article/details/132160648</p> <p>https://blog.csdn.net/weixin_45782925/article/details/123269490</p> <p>https://www.jianshu.com/p/678cb44fbbc2</p> <p>https://blog.csdn.net/fywindmoon/article/details/134308314</p> <p>https://zhuanlan.zhihu.com/p/157070339</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">11/2/2024, 10:36:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/3d/04cesium.html" class="prev">
        cesium1
      </a></span> <span class="next"><a href="/3d/06cesium.html">
        cesium3
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.50fceeca.js" defer></script><script src="/assets/js/2.f1eac84e.js" defer></script><script src="/assets/js/1.51fb246a.js" defer></script><script src="/assets/js/50.869f41c3.js" defer></script><script src="/assets/js/24.8b250b82.js" defer></script>
  </body>
</html>
